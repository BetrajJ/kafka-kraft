[2025-02-25 16:00:36,013] INFO [SnapshotGenerator id=1] Creating new KRaft snapshot file snapshot 00000000000000365853-0000004471 because we have waited at least 60 minute(s). (org.apache.kafka.image.publisher.SnapshotGenerator)
[2025-02-25 16:00:37,517] INFO [SnapshotEmitter id=1] Successfully wrote snapshot 00000000000000365853-0000004471 (org.apache.kafka.image.publisher.SnapshotEmitter)
[2025-02-25 16:03:49,941] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Incremented log start offset to 285488 due to snapshot generated (kafka.log.UnifiedLog)
[2025-02-25 16:03:50,041] INFO [MetadataLog partition=__cluster_metadata-0, nodeId=1] Marking snapshot OffsetAndEpoch(offset=278436, epoch=4031) for deletion because its timestamp (1739874815117) is now (1740479629924) older than the
retention (604800000) (kafka.raft.KafkaMetadataLog)
[2025-02-25 16:04:50,073] INFO Deleted snapshot files for snapshot OffsetAndEpoch(offset=278436, epoch=4031). (org.apache.kafka.snapshot.Snapshots)
[2025-02-25 16:34:22,369] INFO [RaftManager id=1] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 16:34:23,067] INFO [RaftManager id=1] Disconnecting from node 2 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-02-25 16:34:23,879] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4472, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@72f679f6, 2=org.apache.kafka.raft.CandidateState$VoterState@8ec7257, 3=org.apache.kafka.raft.CandidateState$VoterState@6020280f}, highWatermark=Optional[LogOffsetMetadata(offset=369886, metadata=Optional.empty)], electionTimeoutMs=1886) from FollowerState(fetchTimeoutMs=2000, epoch=4471, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=369886, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 16:34:23,885] INFO [RaftManager id=1] Cancelled in-flight FETCH request with correlation id 75229 due to node 2 being disconnected (elapsed time since creation: 2003ms, elapsed time since send: 2002ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-02-25 16:34:24,964] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4472, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@72f679f6, 2=org.apache.kafka.raft.CandidateState$VoterState@8ec7257, 3=org.apache.kafka.raft.CandidateState$VoterState@6020280f}, highWatermark=Optional[LogOffsetMetadata(offset=369886, metadata=Optional.empty)], electionTimeoutMs=1886) from FollowerState(fetchTimeoutMs=2000, epoch=4471, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=369886, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 16:34:25,002] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4472, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4471, lastOffset=369887)])]) with epoch 4472 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 16:34:25,060] INFO [RaftManager id=1] Insufficient remaining votes to become leader (rejected by [2, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 16:34:25,123] INFO [RaftManager id=1] Attempting durable transition to Unattached(epoch=4473, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=615, highWatermark=Optional[LogOffsetMetadata(offset=369886, metadata=Optional.empty)]) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4472, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@72f679f6, 2=org.apache.kafka.raft.CandidateState$VoterState@8ec7257, 3=org.apache.kafka.raft.CandidateState$VoterState@6020280f}, highWatermark=Optional[LogOffsetMetadata(offset=369886, metadata=Optional.empty)], electionTimeoutMs=1886) (org.apache.kafka.raft.QuorumState)
[2025-02-25 16:34:25,171] INFO [RaftManager id=1] Completed transition to Unattached(epoch=4473, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=615, highWatermark=Optional[LogOffsetMetadata(offset=369886, metadata=Optional.empty)]) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4472, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@72f679f6, 2=org.apache.kafka.raft.CandidateState$VoterState@8ec7257, 3=org.apache.kafka.raft.CandidateState$VoterState@6020280f}, highWatermark=Optional[LogOffsetMetadata(offset=369886, metadata=Optional.empty)], electionTimeoutMs=1886) (org.apache.kafka.raft.QuorumState)
[2025-02-25 16:34:25,196] INFO [RaftManager id=1] Attempting durable transition to Unattached(epoch=4473, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1216, highWatermark=Optional[LogOffsetMetadata(offset=369886, metadata=Optional.empty)]) from Unattached(epoch=4473, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=615, highWatermark=Optional[LogOffsetMetadata(offset=369886, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 16:34:25,236] INFO [RaftManager id=1] Completed transition to Unattached(epoch=4473, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1216, highWatermark=Optional[LogOffsetMetadata(offset=369886, metadata=Optional.empty)]) from Unattached(epoch=4473, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=615, highWatermark=Optional[LogOffsetMetadata(offset=369886, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 16:34:25,236] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4473, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4471, lastOffset=369887)])]) with epoch 4473 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 16:34:25,265] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 16:34:25,420] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=4473, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=369886, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=4473, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1216, highWatermark=Optional[LogOffsetMetadata(offset=369886, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 16:34:25,478] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=4473, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=369886, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=4473, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1216, highWatermark=Optional[LogOffsetMetadata(offset=369886, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 16:34:25,576] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 16:44:25,078] INFO [RaftManager id=1] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
