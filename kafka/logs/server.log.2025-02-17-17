[2025-02-17 18:04:40,774] INFO [RaftManager id=1] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-17 18:04:40,934] INFO [RaftManager id=1] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-02-17 18:04:41,371] INFO [RaftManager id=1] Cancelled in-flight FETCH request with correlation id 59542 due to node 3 being disconnected (elapsed time since creation: 2004ms, elapsed time since send: 2004ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-02-17 18:04:41,376] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3930, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@449fe01f, 2=org.apache.kafka.raft.CandidateState$VoterState@342fdb51, 3=org.apache.kafka.raft.CandidateState$VoterState@75a2d964}, highWatermark=Optional[LogOffsetMetadata(offset=252711, metadata=Optional.empty)], electionTimeoutMs=1947) from FollowerState(fetchTimeoutMs=2000, epoch=3929, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=252711, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-17 18:04:41,448] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3930, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@449fe01f, 2=org.apache.kafka.raft.CandidateState$VoterState@342fdb51, 3=org.apache.kafka.raft.CandidateState$VoterState@75a2d964}, highWatermark=Optional[LogOffsetMetadata(offset=252711, metadata=Optional.empty)], electionTimeoutMs=1947) from FollowerState(fetchTimeoutMs=2000, epoch=3929, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=252711, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-17 18:04:42,548] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3930, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3929, lastOffset=252712)])]) with epoch 3930 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-17 18:04:42,977] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-17 18:04:42,985] INFO [RaftManager id=1] Insufficient remaining votes to become leader (rejected by [2, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-17 18:04:42,990] INFO [RaftManager id=1] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-17 18:04:42,991] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3931, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@478b6113, 2=org.apache.kafka.raft.CandidateState$VoterState@7c2feee5, 3=org.apache.kafka.raft.CandidateState$VoterState@36904762}, highWatermark=Optional[LogOffsetMetadata(offset=252711, metadata=Optional.empty)], electionTimeoutMs=1378) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3930, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@449fe01f, 2=org.apache.kafka.raft.CandidateState$VoterState@342fdb51, 3=org.apache.kafka.raft.CandidateState$VoterState@75a2d964}, highWatermark=Optional[LogOffsetMetadata(offset=252711, metadata=Optional.empty)], electionTimeoutMs=1947) (org.apache.kafka.raft.QuorumState)
[2025-02-17 18:04:43,038] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3931, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@478b6113, 2=org.apache.kafka.raft.CandidateState$VoterState@7c2feee5, 3=org.apache.kafka.raft.CandidateState$VoterState@36904762}, highWatermark=Optional[LogOffsetMetadata(offset=252711, metadata=Optional.empty)], electionTimeoutMs=1378) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3930, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@449fe01f, 2=org.apache.kafka.raft.CandidateState$VoterState@342fdb51, 3=org.apache.kafka.raft.CandidateState$VoterState@75a2d964}, highWatermark=Optional[LogOffsetMetadata(offset=252711, metadata=Optional.empty)], electionTimeoutMs=1947) (org.apache.kafka.raft.QuorumState)
[2025-02-17 18:04:43,039] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3931, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3929, lastOffset=252712)])]) with epoch 3931 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-17 18:04:43,045] INFO [RaftManager id=1] Insufficient remaining votes to become leader (rejected by [2, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-17 18:04:43,255] INFO [RaftManager id=1] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-17 18:04:43,255] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3932, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@551ad12d, 2=org.apache.kafka.raft.CandidateState$VoterState@4985b164, 3=org.apache.kafka.raft.CandidateState$VoterState@4ade3677}, highWatermark=Optional[LogOffsetMetadata(offset=252711, metadata=Optional.empty)], electionTimeoutMs=1178) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3931, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@478b6113, 2=org.apache.kafka.raft.CandidateState$VoterState@7c2feee5, 3=org.apache.kafka.raft.CandidateState$VoterState@36904762}, highWatermark=Optional[LogOffsetMetadata(offset=252711, metadata=Optional.empty)], electionTimeoutMs=1378) (org.apache.kafka.raft.QuorumState)
[2025-02-17 18:04:43,288] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3932, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@551ad12d, 2=org.apache.kafka.raft.CandidateState$VoterState@4985b164, 3=org.apache.kafka.raft.CandidateState$VoterState@4ade3677}, highWatermark=Optional[LogOffsetMetadata(offset=252711, metadata=Optional.empty)], electionTimeoutMs=1178) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3931, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@478b6113, 2=org.apache.kafka.raft.CandidateState$VoterState@7c2feee5, 3=org.apache.kafka.raft.CandidateState$VoterState@36904762}, highWatermark=Optional[LogOffsetMetadata(offset=252711, metadata=Optional.empty)], electionTimeoutMs=1378) (org.apache.kafka.raft.QuorumState)
[2025-02-17 18:04:43,407] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), epoch=3932, epochStartOffset=252712, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3932, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@551ad12d, 2=org.apache.kafka.raft.CandidateState$VoterState@4985b164, 3=org.apache.kafka.raft.CandidateState$VoterState@4ade3677}, highWatermark=Optional[LogOffsetMetadata(offset=252711, metadata=Optional.empty)], electionTimeoutMs=1178) (org.apache.kafka.raft.QuorumState)
[2025-02-17 18:04:43,468] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), epoch=3932, epochStartOffset=252712, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3932, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@551ad12d, 2=org.apache.kafka.raft.CandidateState$VoterState@4985b164, 3=org.apache.kafka.raft.CandidateState$VoterState@4ade3677}, highWatermark=Optional[LogOffsetMetadata(offset=252711, metadata=Optional.empty)], electionTimeoutMs=1178) (org.apache.kafka.raft.QuorumState)
[2025-02-17 18:04:43,505] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-17 18:04:43,537] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-17 18:04:43,544] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-17 18:04:43,610] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-17 18:04:43,611] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-17 18:04:43,612] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-17 18:04:43,663] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-17 18:04:43,670] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-17 18:04:43,670] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-17 18:04:43,685] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=252713, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=6819128)]) for the first time for epoch 3932 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=252713, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=6819128)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=252713, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=6819128)])], lastFetchTimestamp=1739795683684, lastCaughtUpTimestamp=1739795683684, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-17 18:04:43,720] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-17 18:07:21,041] INFO [RaftManager id=1] Attempting durable transition to Unattached(epoch=3933, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1406, highWatermark=Optional[LogOffsetMetadata(offset=253020, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=6841171)])]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), epoch=3932, epochStartOffset=252712, highWatermark=Optional[LogOffsetMetadata(offset=253020, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=6841171)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=253026, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=6841359)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=253020, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=6841171)])], lastFetchTimestamp=1739795838394, lastCaughtUpTimestamp=1739795837946, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=253020, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=6841171)])], lastFetchTimestamp=1739795838394, lastCaughtUpTimestamp=1739795837953, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-17 18:07:21,084] INFO [RaftManager id=1] Completed transition to Unattached(epoch=3933, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1406, highWatermark=Optional[LogOffsetMetadata(offset=253020, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=6841171)])]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), epoch=3932, epochStartOffset=252712, highWatermark=Optional[LogOffsetMetadata(offset=253020, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=6841171)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=253026, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=6841359)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=253020, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=6841171)])], lastFetchTimestamp=1739795838394, lastCaughtUpTimestamp=1739795837946, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=253020, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=6841171)])], lastFetchTimestamp=1739795838394, lastCaughtUpTimestamp=1739795837953, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-17 18:07:21,084] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3933, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3932, lastOffset=253021)])]) with epoch 3933 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-17 18:07:21,094] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(1973064083). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-17 18:07:21,094] INFO [QuorumController id=1] failAll(NotControllerException): failing processBrokerHeartbeat(1726819662). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-17 18:07:21,096] INFO [QuorumController id=1] failAll(NotControllerException): failing processBrokerHeartbeat(1774368216). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-17 18:07:21,096] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3933, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3932, lastOffset=253021)])]) with epoch 3933 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-17 18:07:21,098] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(1093462328). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-17 18:07:21,098] INFO [QuorumController id=1] failAll(NotControllerException): failing processBrokerHeartbeat(1620835975). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-17 18:07:21,098] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(1871919239). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-17 18:07:21,098] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(318975192). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-17 18:07:21,098] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(893416105). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-17 18:07:21,099] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(168873280). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-17 18:07:21,101] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-17 18:07:21,124] INFO [RaftManager id=1] Attempting durable transition to Unattached(epoch=3934, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1323, highWatermark=Optional[LogOffsetMetadata(offset=253020, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=6841171)])]) from Unattached(epoch=3933, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1406, highWatermark=Optional[LogOffsetMetadata(offset=253020, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=6841171)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-17 18:07:21,152] INFO [RaftManager id=1] Completed transition to Unattached(epoch=3934, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1323, highWatermark=Optional[LogOffsetMetadata(offset=253020, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=6841171)])]) from Unattached(epoch=3933, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1406, highWatermark=Optional[LogOffsetMetadata(offset=253020, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=6841171)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-17 18:07:21,153] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3934, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3932, lastOffset=253021)])]) with epoch 3934 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-17 18:07:21,237] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=3934, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=253020, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=6841171)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=3934, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1323, highWatermark=Optional[LogOffsetMetadata(offset=253020, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=6841171)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-17 18:07:21,265] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=3934, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=253020, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=6841171)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=3934, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1323, highWatermark=Optional[LogOffsetMetadata(offset=253020, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=6841171)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-17 18:07:21,321] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-17 18:07:21,322] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-17 18:07:21,322] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-17 18:07:21,373] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-17 18:07:21,375] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-17 18:07:21,375] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-17 18:07:21,424] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Truncating to offset 253021 (kafka.log.UnifiedLog)
[2025-02-17 18:07:21,425] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-17 18:07:21,629] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Loading producer state till offset 253021 with message format version 2 (kafka.log.UnifiedLog$)
[2025-02-17 18:07:21,645] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Reloading from producer snapshot and rebuilding producer state from offset 253021 (kafka.log.UnifiedLog$)
[2025-02-17 18:07:21,650] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=250320, file=/tmp/kafka-logs/__cluster_metadata-0/00000000000000250320.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-17 18:07:21,720] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 253021 with 0 producer ids in 11 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-17 18:07:21,720] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Producer state recovery took 43ms for snapshot load and 32ms for segment recovery from offset 253021 (kafka.log.UnifiedLog$)
[2025-02-17 18:07:21,721] INFO [RaftManager id=1] Truncated to offset 253021 from Fetch response from leader 3 (org.apache.kafka.raft.KafkaRaftClient)
