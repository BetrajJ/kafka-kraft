[2025-02-27 10:45:13,436] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 10:45:13,439] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=6187, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@136dc640, 2=org.apache.kafka.raft.CandidateState$VoterState@154b0a30, 3=org.apache.kafka.raft.CandidateState$VoterState@9baa667}, highWatermark=Optional[LogOffsetMetadata(offset=463743, metadata=Optional.empty)], electionTimeoutMs=1852) from FollowerState(fetchTimeoutMs=2000, epoch=6186, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=463743, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-27 10:45:13,477] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=6187, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@136dc640, 2=org.apache.kafka.raft.CandidateState$VoterState@154b0a30, 3=org.apache.kafka.raft.CandidateState$VoterState@9baa667}, highWatermark=Optional[LogOffsetMetadata(offset=463743, metadata=Optional.empty)], electionTimeoutMs=1852) from FollowerState(fetchTimeoutMs=2000, epoch=6186, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=463743, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-27 10:45:13,587] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6187, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6186, lastOffset=463744)])]) with epoch 6187 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 10:45:13,614] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=6187, epochStartOffset=463744, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=6187, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@136dc640, 2=org.apache.kafka.raft.CandidateState$VoterState@154b0a30, 3=org.apache.kafka.raft.CandidateState$VoterState@9baa667}, highWatermark=Optional[LogOffsetMetadata(offset=463743, metadata=Optional.empty)], electionTimeoutMs=1852) (org.apache.kafka.raft.QuorumState)
[2025-02-27 10:45:13,643] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=6187, epochStartOffset=463744, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=6187, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@136dc640, 2=org.apache.kafka.raft.CandidateState$VoterState@154b0a30, 3=org.apache.kafka.raft.CandidateState$VoterState@9baa667}, highWatermark=Optional[LogOffsetMetadata(offset=463743, metadata=Optional.empty)], electionTimeoutMs=1852) (org.apache.kafka.raft.QuorumState)
[2025-02-27 10:45:13,766] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=6188, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1996, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=6187, epochStartOffset=463744, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=463745, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12125671)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-02-27 10:45:13,868] INFO [RaftManager id=2] Completed transition to Unattached(epoch=6188, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1996, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=6187, epochStartOffset=463744, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=463745, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12125671)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-02-27 10:45:13,869] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6188, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6186, lastOffset=463744)])]) with epoch 6188 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 10:45:14,115] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=6188, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=6188, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1996, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-27 10:45:14,187] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=6188, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=6188, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1996, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-27 10:45:14,196] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Truncating to offset 463744 (kafka.log.UnifiedLog)
[2025-02-27 10:45:14,202] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Loading producer state till offset 463744 with message format version 2 (kafka.log.UnifiedLog$)
[2025-02-27 10:45:14,203] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Reloading from producer snapshot and rebuilding producer state from offset 463744 (kafka.log.UnifiedLog$)
[2025-02-27 10:45:14,203] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=462770, file=/tmp/kafka-logs-node2/__cluster_metadata-0/00000000000000462770.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-27 10:45:14,243] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 463744 with 0 producer ids in 39 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-27 10:45:14,244] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Producer state recovery took 0ms for snapshot load and 41ms for segment recovery from offset 463744 (kafka.log.UnifiedLog$)
[2025-02-27 10:45:14,244] INFO [RaftManager id=2] Truncated to offset 463744 from Fetch response from leader 1 (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 10:45:14,927] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=463745, metadata=Optional.empty)] for the first time for epoch 6188 (org.apache.kafka.raft.FollowerState)
[2025-02-27 10:45:15,287] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-27 10:45:15,288] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-27 10:50:06,421] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=6189, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1426, highWatermark=Optional[LogOffsetMetadata(offset=464324, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=6188, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=464324, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-27 10:50:06,601] INFO [RaftManager id=2] Completed transition to Unattached(epoch=6189, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1426, highWatermark=Optional[LogOffsetMetadata(offset=464324, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=6188, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=464324, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-27 10:50:06,608] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6189, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6188, lastOffset=464322)])]) with epoch 6189 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 10:50:06,948] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=6190, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=899, highWatermark=Optional[LogOffsetMetadata(offset=464324, metadata=Optional.empty)]) from Unattached(epoch=6189, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1426, highWatermark=Optional[LogOffsetMetadata(offset=464324, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 10:50:07,294] INFO [RaftManager id=2] Completed transition to Unattached(epoch=6190, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=899, highWatermark=Optional[LogOffsetMetadata(offset=464324, metadata=Optional.empty)]) from Unattached(epoch=6189, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1426, highWatermark=Optional[LogOffsetMetadata(offset=464324, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 10:50:07,296] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6190, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6188, lastOffset=464322)])]) with epoch 6190 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 10:50:07,747] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=6191, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=100, highWatermark=Optional[LogOffsetMetadata(offset=464324, metadata=Optional.empty)]) from Unattached(epoch=6190, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=899, highWatermark=Optional[LogOffsetMetadata(offset=464324, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 10:50:07,771] INFO [RaftManager id=2] Completed transition to Unattached(epoch=6191, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=100, highWatermark=Optional[LogOffsetMetadata(offset=464324, metadata=Optional.empty)]) from Unattached(epoch=6190, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=899, highWatermark=Optional[LogOffsetMetadata(offset=464324, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 10:50:07,771] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6191, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6188, lastOffset=464322)])]) with epoch 6191 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 10:50:07,772] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=6191, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1167, highWatermark=Optional[LogOffsetMetadata(offset=464324, metadata=Optional.empty)]) from Unattached(epoch=6191, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=100, highWatermark=Optional[LogOffsetMetadata(offset=464324, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 10:50:07,786] INFO [RaftManager id=2] Completed transition to Unattached(epoch=6191, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1167, highWatermark=Optional[LogOffsetMetadata(offset=464324, metadata=Optional.empty)]) from Unattached(epoch=6191, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=100, highWatermark=Optional[LogOffsetMetadata(offset=464324, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 10:50:07,786] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6191, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6188, lastOffset=464326)])]) with epoch 6191 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 10:50:07,827] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=6191, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=464324, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=6191, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1167, highWatermark=Optional[LogOffsetMetadata(offset=464324, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 10:50:07,863] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=6191, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=464324, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=6191, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1167, highWatermark=Optional[LogOffsetMetadata(offset=464324, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
