[2025-02-12 13:04:47,139] INFO [RaftManager id=3] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-02-12 13:51:23,726] INFO [SnapshotGenerator id=3] Creating new KRaft snapshot file snapshot 00000000000000134852-0000003222 because we have waited at least 60 minute(s). (org.apache.kafka.image.publisher.SnapshotGenerator)
[2025-02-12 13:51:23,958] INFO [SnapshotEmitter id=3] Successfully wrote snapshot 00000000000000134852-0000003222 (org.apache.kafka.image.publisher.SnapshotEmitter)
[2025-02-12 13:57:46,995] INFO [RaftManager id=3] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-12 13:57:47,034] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3223, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@300aca11, 2=org.apache.kafka.raft.CandidateState$VoterState@1136b4d8, 3=org.apache.kafka.raft.CandidateState$VoterState@16986805}, highWatermark=Optional[LogOffsetMetadata(offset=135608, metadata=Optional.empty)], electionTimeoutMs=1772) from FollowerState(fetchTimeoutMs=2000, epoch=3222, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=135608, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-12 13:57:47,086] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3223, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@300aca11, 2=org.apache.kafka.raft.CandidateState$VoterState@1136b4d8, 3=org.apache.kafka.raft.CandidateState$VoterState@16986805}, highWatermark=Optional[LogOffsetMetadata(offset=135608, metadata=Optional.empty)], electionTimeoutMs=1772) from FollowerState(fetchTimeoutMs=2000, epoch=3222, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=135608, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-12 13:57:47,153] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3223, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3222, lastOffset=135609)])]) with epoch 3223 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-12 13:57:47,173] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-12 13:57:47,176] INFO [RaftManager id=3] Insufficient remaining votes to become leader (rejected by [1, 2]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-12 13:57:47,177] INFO [RaftManager id=3] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-12 13:57:47,178] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3224, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@4b9a0f04, 2=org.apache.kafka.raft.CandidateState$VoterState@2d261e24, 3=org.apache.kafka.raft.CandidateState$VoterState@912ef2c}, highWatermark=Optional[LogOffsetMetadata(offset=135608, metadata=Optional.empty)], electionTimeoutMs=1304) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3223, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@300aca11, 2=org.apache.kafka.raft.CandidateState$VoterState@1136b4d8, 3=org.apache.kafka.raft.CandidateState$VoterState@16986805}, highWatermark=Optional[LogOffsetMetadata(offset=135608, metadata=Optional.empty)], electionTimeoutMs=1772) (org.apache.kafka.raft.QuorumState)
[2025-02-12 13:57:47,206] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3224, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@4b9a0f04, 2=org.apache.kafka.raft.CandidateState$VoterState@2d261e24, 3=org.apache.kafka.raft.CandidateState$VoterState@912ef2c}, highWatermark=Optional[LogOffsetMetadata(offset=135608, metadata=Optional.empty)], electionTimeoutMs=1304) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3223, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@300aca11, 2=org.apache.kafka.raft.CandidateState$VoterState@1136b4d8, 3=org.apache.kafka.raft.CandidateState$VoterState@16986805}, highWatermark=Optional[LogOffsetMetadata(offset=135608, metadata=Optional.empty)], electionTimeoutMs=1772) (org.apache.kafka.raft.QuorumState)
[2025-02-12 13:57:47,322] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=3224, epochStartOffset=135609, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3224, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@4b9a0f04, 2=org.apache.kafka.raft.CandidateState$VoterState@2d261e24, 3=org.apache.kafka.raft.CandidateState$VoterState@912ef2c}, highWatermark=Optional[LogOffsetMetadata(offset=135608, metadata=Optional.empty)], electionTimeoutMs=1304) (org.apache.kafka.raft.QuorumState)
[2025-02-12 13:57:47,361] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=3224, epochStartOffset=135609, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3224, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@4b9a0f04, 2=org.apache.kafka.raft.CandidateState$VoterState@2d261e24, 3=org.apache.kafka.raft.CandidateState$VoterState@912ef2c}, highWatermark=Optional[LogOffsetMetadata(offset=135608, metadata=Optional.empty)], electionTimeoutMs=1304) (org.apache.kafka.raft.QuorumState)
[2025-02-12 13:57:47,375] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-12 13:57:47,455] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-12 13:57:47,456] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-12 13:57:47,544] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-12 13:57:47,560] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-12 13:57:47,564] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-12 13:57:47,616] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-12 13:57:47,698] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=135610, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9656615)]) for the first time for epoch 3224 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=135610, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9656615)])], lastFetchTimestamp=1739348867697, lastCaughtUpTimestamp=1739348867697, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=135610, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9656615)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
