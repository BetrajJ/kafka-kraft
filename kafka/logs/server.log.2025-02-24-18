[2025-02-25 10:39:34,952] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:39:36,702] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4426, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5268e104, 2=org.apache.kafka.raft.CandidateState$VoterState@6d880fb8, 3=org.apache.kafka.raft.CandidateState$VoterState@d025587}, highWatermark=Optional[LogOffsetMetadata(offset=334793, metadata=Optional.empty)], electionTimeoutMs=1953) from FollowerState(fetchTimeoutMs=2000, epoch=4425, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=334793, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:39:36,738] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4426, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5268e104, 2=org.apache.kafka.raft.CandidateState$VoterState@6d880fb8, 3=org.apache.kafka.raft.CandidateState$VoterState@d025587}, highWatermark=Optional[LogOffsetMetadata(offset=334793, metadata=Optional.empty)], electionTimeoutMs=1953) from FollowerState(fetchTimeoutMs=2000, epoch=4425, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=334793, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:39:36,777] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4426, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4425, lastOffset=334794)])]) with epoch 4426 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:39:36,911] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=4426, epochStartOffset=334794, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4426, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5268e104, 2=org.apache.kafka.raft.CandidateState$VoterState@6d880fb8, 3=org.apache.kafka.raft.CandidateState$VoterState@d025587}, highWatermark=Optional[LogOffsetMetadata(offset=334793, metadata=Optional.empty)], electionTimeoutMs=1953) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:39:36,945] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=4426, epochStartOffset=334794, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4426, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5268e104, 2=org.apache.kafka.raft.CandidateState$VoterState@6d880fb8, 3=org.apache.kafka.raft.CandidateState$VoterState@d025587}, highWatermark=Optional[LogOffsetMetadata(offset=334793, metadata=Optional.empty)], electionTimeoutMs=1953) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:39:37,057] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=4427, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1017, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=4426, epochStartOffset=334794, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=334795, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=2895645)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:39:37,108] INFO [RaftManager id=2] Completed transition to Unattached(epoch=4427, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1017, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=4426, epochStartOffset=334794, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=334795, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=2895645)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:39:37,108] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4427, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4425, lastOffset=334794)])]) with epoch 4427 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:39:37,404] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=4427, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=4427, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1017, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:39:37,446] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=4427, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=4427, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1017, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:39:37,458] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Truncating to offset 334794 (kafka.log.UnifiedLog)
[2025-02-25 10:39:37,483] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Loading producer state till offset 334794 with message format version 2 (kafka.log.UnifiedLog$)
[2025-02-25 10:39:37,483] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Reloading from producer snapshot and rebuilding producer state from offset 334794 (kafka.log.UnifiedLog$)
[2025-02-25 10:39:37,483] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=334550, file=/tmp/kafka-logs-node2/__cluster_metadata-0/00000000000000334550.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-25 10:39:37,557] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 334794 with 0 producer ids in 71 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-25 10:39:37,560] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Producer state recovery took 2ms for snapshot load and 75ms for segment recovery from offset 334794 (kafka.log.UnifiedLog$)
[2025-02-25 10:39:37,560] INFO [RaftManager id=2] Truncated to offset 334794 from Fetch response from leader 1 (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:39:37,887] WARN [BrokerLifecycleManager id=2] Broker 2 sent a heartbeat request but received error REQUEST_TIMED_OUT. (kafka.server.BrokerLifecycleManager)
[2025-02-25 10:39:38,320] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=334795, metadata=Optional.empty)] for the first time for epoch 4427 (org.apache.kafka.raft.FollowerState)
[2025-02-25 10:39:42,217] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:39:42,226] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4428, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@28277602, 2=org.apache.kafka.raft.CandidateState$VoterState@7d3c2acb, 3=org.apache.kafka.raft.CandidateState$VoterState@44b76c54}, highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)], electionTimeoutMs=1742) from FollowerState(fetchTimeoutMs=2000, epoch=4427, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:39:42,299] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4428, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@28277602, 2=org.apache.kafka.raft.CandidateState$VoterState@7d3c2acb, 3=org.apache.kafka.raft.CandidateState$VoterState@44b76c54}, highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)], electionTimeoutMs=1742) from FollowerState(fetchTimeoutMs=2000, epoch=4427, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:39:42,465] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:39:42,465] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:39:42,466] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4429, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@6c59e9e5, 2=org.apache.kafka.raft.CandidateState$VoterState@7fdd050a, 3=org.apache.kafka.raft.CandidateState$VoterState@63ab0248}, highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)], electionTimeoutMs=1939) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4428, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@28277602, 2=org.apache.kafka.raft.CandidateState$VoterState@7d3c2acb, 3=org.apache.kafka.raft.CandidateState$VoterState@44b76c54}, highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)], electionTimeoutMs=1742) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:39:43,355] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4429, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@6c59e9e5, 2=org.apache.kafka.raft.CandidateState$VoterState@7fdd050a, 3=org.apache.kafka.raft.CandidateState$VoterState@63ab0248}, highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)], electionTimeoutMs=1939) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4428, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@28277602, 2=org.apache.kafka.raft.CandidateState$VoterState@7d3c2acb, 3=org.apache.kafka.raft.CandidateState$VoterState@44b76c54}, highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)], electionTimeoutMs=1742) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:39:43,469] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:39:43,712] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:39:43,713] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4430, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1c0107a5, 2=org.apache.kafka.raft.CandidateState$VoterState@3f34c301, 3=org.apache.kafka.raft.CandidateState$VoterState@28d674b8}, highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)], electionTimeoutMs=1923) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4429, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@6c59e9e5, 2=org.apache.kafka.raft.CandidateState$VoterState@7fdd050a, 3=org.apache.kafka.raft.CandidateState$VoterState@63ab0248}, highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)], electionTimeoutMs=1939) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:39:43,756] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4430, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1c0107a5, 2=org.apache.kafka.raft.CandidateState$VoterState@3f34c301, 3=org.apache.kafka.raft.CandidateState$VoterState@28d674b8}, highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)], electionTimeoutMs=1923) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4429, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@6c59e9e5, 2=org.apache.kafka.raft.CandidateState$VoterState@7fdd050a, 3=org.apache.kafka.raft.CandidateState$VoterState@63ab0248}, highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)], electionTimeoutMs=1939) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:39:43,994] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:39:44,036] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=4431, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1600, highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)]) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4430, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1c0107a5, 2=org.apache.kafka.raft.CandidateState$VoterState@3f34c301, 3=org.apache.kafka.raft.CandidateState$VoterState@28d674b8}, highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)], electionTimeoutMs=1923) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:39:44,084] INFO [RaftManager id=2] Completed transition to Unattached(epoch=4431, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1600, highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)]) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4430, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1c0107a5, 2=org.apache.kafka.raft.CandidateState$VoterState@3f34c301, 3=org.apache.kafka.raft.CandidateState$VoterState@28d674b8}, highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)], electionTimeoutMs=1923) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:39:44,085] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=4431, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1991, highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)]) from Unattached(epoch=4431, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1600, highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:39:44,127] INFO [RaftManager id=2] Completed transition to Unattached(epoch=4431, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1991, highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)]) from Unattached(epoch=4431, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1600, highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:39:44,127] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4431, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4427, lastOffset=334800)])]) with epoch 4431 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:39:44,194] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 10:39:44,220] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=4431, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=4431, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1991, highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:39:44,297] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=4431, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=4431, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1991, highWatermark=Optional[LogOffsetMetadata(offset=334797, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:39:44,398] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:41:32,417] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 10:41:32,427] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:41:32,462] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=4432, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1266, highWatermark=Optional[LogOffsetMetadata(offset=335009, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=4431, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=335009, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:41:32,484] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:41:32,486] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 10:41:32,486] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:41:32,624] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:41:32,624] INFO [RaftManager id=2] Completed transition to Unattached(epoch=4432, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1266, highWatermark=Optional[LogOffsetMetadata(offset=335009, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=4431, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=335009, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:41:32,628] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=4432, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1940, highWatermark=Optional[LogOffsetMetadata(offset=335009, metadata=Optional.empty)]) from Unattached(epoch=4432, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1266, highWatermark=Optional[LogOffsetMetadata(offset=335009, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:41:32,684] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 10:41:32,786] INFO [RaftManager id=2] Completed transition to Unattached(epoch=4432, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1940, highWatermark=Optional[LogOffsetMetadata(offset=335009, metadata=Optional.empty)]) from Unattached(epoch=4432, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1266, highWatermark=Optional[LogOffsetMetadata(offset=335009, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:41:32,787] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4432, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4431, lastOffset=335010)])]) with epoch 4432 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:41:32,862] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=4433, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1706, highWatermark=Optional[LogOffsetMetadata(offset=335009, metadata=Optional.empty)]) from Unattached(epoch=4432, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1940, highWatermark=Optional[LogOffsetMetadata(offset=335009, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:41:32,957] INFO [RaftManager id=2] Completed transition to Unattached(epoch=4433, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1706, highWatermark=Optional[LogOffsetMetadata(offset=335009, metadata=Optional.empty)]) from Unattached(epoch=4432, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1940, highWatermark=Optional[LogOffsetMetadata(offset=335009, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:41:32,958] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=4433, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1031, highWatermark=Optional[LogOffsetMetadata(offset=335009, metadata=Optional.empty)]) from Unattached(epoch=4433, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1706, highWatermark=Optional[LogOffsetMetadata(offset=335009, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:41:32,982] INFO [RaftManager id=2] Completed transition to Unattached(epoch=4433, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1031, highWatermark=Optional[LogOffsetMetadata(offset=335009, metadata=Optional.empty)]) from Unattached(epoch=4433, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1706, highWatermark=Optional[LogOffsetMetadata(offset=335009, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:41:32,982] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4433, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4431, lastOffset=335010)])]) with epoch 4433 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:41:33,062] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=4433, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=335009, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=4433, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1031, highWatermark=Optional[LogOffsetMetadata(offset=335009, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:41:33,098] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=4433, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=335009, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=4433, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1031, highWatermark=Optional[LogOffsetMetadata(offset=335009, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:41:33,221] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:45:38,962] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:45:39,034] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4434, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@16abec1c, 2=org.apache.kafka.raft.CandidateState$VoterState@1834d60f, 3=org.apache.kafka.raft.CandidateState$VoterState@8bc682c}, highWatermark=Optional[LogOffsetMetadata(offset=335493, metadata=Optional.empty)], electionTimeoutMs=1163) from FollowerState(fetchTimeoutMs=2000, epoch=4433, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=335493, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:45:39,342] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4434, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@16abec1c, 2=org.apache.kafka.raft.CandidateState$VoterState@1834d60f, 3=org.apache.kafka.raft.CandidateState$VoterState@8bc682c}, highWatermark=Optional[LogOffsetMetadata(offset=335493, metadata=Optional.empty)], electionTimeoutMs=1163) from FollowerState(fetchTimeoutMs=2000, epoch=4433, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=335493, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:45:39,553] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4434, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4433, lastOffset=335494)])]) with epoch 4434 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:45:40,241] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 10:45:40,245] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:45:40,263] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:45:40,265] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4435, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@27c14465, 2=org.apache.kafka.raft.CandidateState$VoterState@6e43978d, 3=org.apache.kafka.raft.CandidateState$VoterState@5079a0e4}, highWatermark=Optional[LogOffsetMetadata(offset=335493, metadata=Optional.empty)], electionTimeoutMs=1996) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4434, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@16abec1c, 2=org.apache.kafka.raft.CandidateState$VoterState@1834d60f, 3=org.apache.kafka.raft.CandidateState$VoterState@8bc682c}, highWatermark=Optional[LogOffsetMetadata(offset=335493, metadata=Optional.empty)], electionTimeoutMs=1163) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:45:40,360] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4435, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@27c14465, 2=org.apache.kafka.raft.CandidateState$VoterState@6e43978d, 3=org.apache.kafka.raft.CandidateState$VoterState@5079a0e4}, highWatermark=Optional[LogOffsetMetadata(offset=335493, metadata=Optional.empty)], electionTimeoutMs=1996) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4434, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@16abec1c, 2=org.apache.kafka.raft.CandidateState$VoterState@1834d60f, 3=org.apache.kafka.raft.CandidateState$VoterState@8bc682c}, highWatermark=Optional[LogOffsetMetadata(offset=335493, metadata=Optional.empty)], electionTimeoutMs=1163) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:45:40,362] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4435, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4433, lastOffset=335494)])]) with epoch 4435 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:45:40,371] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:45:40,571] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:45:40,572] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4436, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3bef5fcf, 2=org.apache.kafka.raft.CandidateState$VoterState@16a0d6bb, 3=org.apache.kafka.raft.CandidateState$VoterState@64adc41d}, highWatermark=Optional[LogOffsetMetadata(offset=335493, metadata=Optional.empty)], electionTimeoutMs=1740) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4435, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@27c14465, 2=org.apache.kafka.raft.CandidateState$VoterState@6e43978d, 3=org.apache.kafka.raft.CandidateState$VoterState@5079a0e4}, highWatermark=Optional[LogOffsetMetadata(offset=335493, metadata=Optional.empty)], electionTimeoutMs=1996) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:45:40,661] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4436, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3bef5fcf, 2=org.apache.kafka.raft.CandidateState$VoterState@16a0d6bb, 3=org.apache.kafka.raft.CandidateState$VoterState@64adc41d}, highWatermark=Optional[LogOffsetMetadata(offset=335493, metadata=Optional.empty)], electionTimeoutMs=1740) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4435, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@27c14465, 2=org.apache.kafka.raft.CandidateState$VoterState@6e43978d, 3=org.apache.kafka.raft.CandidateState$VoterState@5079a0e4}, highWatermark=Optional[LogOffsetMetadata(offset=335493, metadata=Optional.empty)], electionTimeoutMs=1996) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:45:40,911] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=4436, epochStartOffset=335494, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4436, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3bef5fcf, 2=org.apache.kafka.raft.CandidateState$VoterState@16a0d6bb, 3=org.apache.kafka.raft.CandidateState$VoterState@64adc41d}, highWatermark=Optional[LogOffsetMetadata(offset=335493, metadata=Optional.empty)], electionTimeoutMs=1740) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:45:41,001] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=4436, epochStartOffset=335494, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4436, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3bef5fcf, 2=org.apache.kafka.raft.CandidateState$VoterState@16a0d6bb, 3=org.apache.kafka.raft.CandidateState$VoterState@64adc41d}, highWatermark=Optional[LogOffsetMetadata(offset=335493, metadata=Optional.empty)], electionTimeoutMs=1740) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:45:41,075] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:45:41,211] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 10:45:41,214] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:45:41,264] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:45:41,289] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 10:45:41,290] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:45:41,342] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:45:41,375] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 10:45:41,397] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:45:41,425] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=335495, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=2945903)]) for the first time for epoch 4436 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=335495, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=2945903)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=335495, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=2945903)])], lastFetchTimestamp=1740460541388, lastCaughtUpTimestamp=1740460541388, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-25 10:45:41,448] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:46:10,843] INFO [RaftManager id=2] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are java.util.stream.ReferencePipeline$3@39862c87 (org.apache.kafka.raft.LeaderState)
[2025-02-25 10:46:10,846] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=4436, voters=[1, 2, 3], electionTimeoutMs=1317, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=3, directoryId=Optional.empty)]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=4436, epochStartOffset=335494, highWatermark=Optional[LogOffsetMetadata(offset=335546, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=2949575)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=335546, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=2949575)])], lastFetchTimestamp=1740460567837, lastCaughtUpTimestamp=1740460567397, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=335551, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=2949813)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=335546, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=2949575)])], lastFetchTimestamp=1740460567836, lastCaughtUpTimestamp=1740460567385, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:46:10,855] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=4437, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1404, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=4436, voters=[1, 2, 3], electionTimeoutMs=1317, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=3, directoryId=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:46:10,913] INFO [RaftManager id=2] Completed transition to Unattached(epoch=4437, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1404, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=4436, voters=[1, 2, 3], electionTimeoutMs=1317, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=3, directoryId=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:46:10,913] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4437, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4436, lastOffset=335547)])]) with epoch 4437 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:46:10,914] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(867836858). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 10:46:10,914] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1613896476). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 10:46:10,914] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(838009005). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 10:46:10,914] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(721472959). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 10:46:10,914] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(1237683350). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 10:46:10,915] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4437, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4436, lastOffset=335547)])]) with epoch 4437 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:46:10,921] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(962561097). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 10:46:10,922] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(276827559). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 10:46:10,922] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1027622717). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 10:46:10,922] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 10:46:10,972] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=4438, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1288, highWatermark=Optional.empty) from Unattached(epoch=4437, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1404, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:46:11,084] INFO [RaftManager id=2] Completed transition to Unattached(epoch=4438, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1288, highWatermark=Optional.empty) from Unattached(epoch=4437, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1404, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:46:11,085] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4438, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4436, lastOffset=335547)])]) with epoch 4438 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:46:11,287] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=4438, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=4438, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1288, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:46:11,419] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=4438, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=4438, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1288, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:46:11,423] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Truncating to offset 335547 (kafka.log.UnifiedLog)
[2025-02-25 10:46:11,425] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Loading producer state till offset 335547 with message format version 2 (kafka.log.UnifiedLog$)
[2025-02-25 10:46:11,458] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:46:11,487] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Reloading from producer snapshot and rebuilding producer state from offset 335547 (kafka.log.UnifiedLog$)
[2025-02-25 10:46:11,488] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=334794, file=/tmp/kafka-logs-node2/__cluster_metadata-0/00000000000000334794.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-25 10:46:11,520] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 10:46:11,520] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:46:11,550] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 335547 with 0 producer ids in 39 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-25 10:46:11,551] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Producer state recovery took 23ms for snapshot load and 41ms for segment recovery from offset 335547 (kafka.log.UnifiedLog$)
[2025-02-25 10:46:11,551] INFO [RaftManager id=2] Truncated to offset 335547 from Fetch response from leader 1 (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:46:11,572] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:46:11,581] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 10:46:11,582] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:46:11,633] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:46:12,248] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=335548, metadata=Optional.empty)] for the first time for epoch 4438 (org.apache.kafka.raft.FollowerState)
[2025-02-25 10:53:19,051] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 10:53:19,172] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:53:19,172] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:53:19,172] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4439, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@2f9ddb36, 2=org.apache.kafka.raft.CandidateState$VoterState@78a2694a, 3=org.apache.kafka.raft.CandidateState$VoterState@5689e6a1}, highWatermark=Optional[LogOffsetMetadata(offset=336384, metadata=Optional.empty)], electionTimeoutMs=1920) from FollowerState(fetchTimeoutMs=2000, epoch=4438, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=336384, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:53:19,225] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:53:19,229] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 10:53:19,229] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:53:19,235] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4439, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@2f9ddb36, 2=org.apache.kafka.raft.CandidateState$VoterState@78a2694a, 3=org.apache.kafka.raft.CandidateState$VoterState@5689e6a1}, highWatermark=Optional[LogOffsetMetadata(offset=336384, metadata=Optional.empty)], electionTimeoutMs=1920) from FollowerState(fetchTimeoutMs=2000, epoch=4438, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=336384, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:53:19,236] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4439, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4438, lastOffset=336392)])]) with epoch 4439 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:53:19,308] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=4440, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1784, highWatermark=Optional[LogOffsetMetadata(offset=336384, metadata=Optional.empty)]) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4439, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@2f9ddb36, 2=org.apache.kafka.raft.CandidateState$VoterState@78a2694a, 3=org.apache.kafka.raft.CandidateState$VoterState@5689e6a1}, highWatermark=Optional[LogOffsetMetadata(offset=336384, metadata=Optional.empty)], electionTimeoutMs=1920) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:53:19,411] INFO [RaftManager id=2] Completed transition to Unattached(epoch=4440, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1784, highWatermark=Optional[LogOffsetMetadata(offset=336384, metadata=Optional.empty)]) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4439, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@2f9ddb36, 2=org.apache.kafka.raft.CandidateState$VoterState@78a2694a, 3=org.apache.kafka.raft.CandidateState$VoterState@5689e6a1}, highWatermark=Optional[LogOffsetMetadata(offset=336384, metadata=Optional.empty)], electionTimeoutMs=1920) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:53:19,411] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=4440, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1380, highWatermark=Optional[LogOffsetMetadata(offset=336384, metadata=Optional.empty)]) from Unattached(epoch=4440, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1784, highWatermark=Optional[LogOffsetMetadata(offset=336384, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:53:19,464] INFO [RaftManager id=2] Completed transition to Unattached(epoch=4440, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1380, highWatermark=Optional[LogOffsetMetadata(offset=336384, metadata=Optional.empty)]) from Unattached(epoch=4440, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1784, highWatermark=Optional[LogOffsetMetadata(offset=336384, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:53:19,464] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4440, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4438, lastOffset=336392)])]) with epoch 4440 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 10:53:19,542] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=4440, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=336384, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=4440, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1380, highWatermark=Optional[LogOffsetMetadata(offset=336384, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:53:19,574] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=4440, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=336384, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=4440, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1380, highWatermark=Optional[LogOffsetMetadata(offset=336384, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 10:53:19,598] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:53:19,615] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 10:53:19,616] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 10:53:19,666] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
