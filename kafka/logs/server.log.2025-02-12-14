[2025-02-12 15:16:56,450] INFO [SnapshotGenerator id=1] Creating new KRaft snapshot file snapshot 00000000000000141992-0000003237 because we have waited at least 60 minute(s). (org.apache.kafka.image.publisher.SnapshotGenerator)
[2025-02-12 15:16:56,787] INFO [SnapshotEmitter id=1] Successfully wrote snapshot 00000000000000141992-0000003237 (org.apache.kafka.image.publisher.SnapshotEmitter)
[2025-02-12 15:31:57,364] INFO [RaftManager id=1] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-12 15:31:57,365] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3238, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1fd17e9b, 2=org.apache.kafka.raft.CandidateState$VoterState@4aa28095, 3=org.apache.kafka.raft.CandidateState$VoterState@57a48878}, highWatermark=Optional[LogOffsetMetadata(offset=143782, metadata=Optional.empty)], electionTimeoutMs=1932) from FollowerState(fetchTimeoutMs=2000, epoch=3237, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=143782, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-12 15:31:58,585] INFO [RaftManager id=1] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-02-12 15:31:58,596] INFO [RaftManager id=1] Cancelled in-flight FETCH request with correlation id 44824 due to node 3 being disconnected (elapsed time since creation: 2002ms, elapsed time since send: 2002ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-02-12 15:31:58,674] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3238, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1fd17e9b, 2=org.apache.kafka.raft.CandidateState$VoterState@4aa28095, 3=org.apache.kafka.raft.CandidateState$VoterState@57a48878}, highWatermark=Optional[LogOffsetMetadata(offset=143782, metadata=Optional.empty)], electionTimeoutMs=1932) from FollowerState(fetchTimeoutMs=2000, epoch=3237, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=143782, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-12 15:31:59,375] INFO [RaftManager id=1] Election has timed out, backing off for 100ms before becoming a candidate again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-12 15:31:59,478] INFO [RaftManager id=1] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-12 15:31:59,478] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3239, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@13e92fa, 2=org.apache.kafka.raft.CandidateState$VoterState@158f11e0, 3=org.apache.kafka.raft.CandidateState$VoterState@4b778dec}, highWatermark=Optional[LogOffsetMetadata(offset=143782, metadata=Optional.empty)], electionTimeoutMs=1697) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3238, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1fd17e9b, 2=org.apache.kafka.raft.CandidateState$VoterState@4aa28095, 3=org.apache.kafka.raft.CandidateState$VoterState@57a48878}, highWatermark=Optional[LogOffsetMetadata(offset=143782, metadata=Optional.empty)], electionTimeoutMs=1932) (org.apache.kafka.raft.QuorumState)
[2025-02-12 15:31:59,555] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3239, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@13e92fa, 2=org.apache.kafka.raft.CandidateState$VoterState@158f11e0, 3=org.apache.kafka.raft.CandidateState$VoterState@4b778dec}, highWatermark=Optional[LogOffsetMetadata(offset=143782, metadata=Optional.empty)], electionTimeoutMs=1697) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3238, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1fd17e9b, 2=org.apache.kafka.raft.CandidateState$VoterState@4aa28095, 3=org.apache.kafka.raft.CandidateState$VoterState@57a48878}, highWatermark=Optional[LogOffsetMetadata(offset=143782, metadata=Optional.empty)], electionTimeoutMs=1932) (org.apache.kafka.raft.QuorumState)
[2025-02-12 15:31:59,555] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3239, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3237, lastOffset=143783)])]) with epoch 3239 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-12 15:31:59,667] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-12 15:31:59,690] INFO [RaftManager id=1] Insufficient remaining votes to become leader (rejected by [2, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-12 15:31:59,690] INFO [RaftManager id=1] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-12 15:31:59,691] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3240, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@38633bb2, 2=org.apache.kafka.raft.CandidateState$VoterState@4d3fd706, 3=org.apache.kafka.raft.CandidateState$VoterState@20d2df50}, highWatermark=Optional[LogOffsetMetadata(offset=143782, metadata=Optional.empty)], electionTimeoutMs=1265) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3239, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@13e92fa, 2=org.apache.kafka.raft.CandidateState$VoterState@158f11e0, 3=org.apache.kafka.raft.CandidateState$VoterState@4b778dec}, highWatermark=Optional[LogOffsetMetadata(offset=143782, metadata=Optional.empty)], electionTimeoutMs=1697) (org.apache.kafka.raft.QuorumState)
[2025-02-12 15:31:59,703] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3240, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@38633bb2, 2=org.apache.kafka.raft.CandidateState$VoterState@4d3fd706, 3=org.apache.kafka.raft.CandidateState$VoterState@20d2df50}, highWatermark=Optional[LogOffsetMetadata(offset=143782, metadata=Optional.empty)], electionTimeoutMs=1265) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3239, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@13e92fa, 2=org.apache.kafka.raft.CandidateState$VoterState@158f11e0, 3=org.apache.kafka.raft.CandidateState$VoterState@4b778dec}, highWatermark=Optional[LogOffsetMetadata(offset=143782, metadata=Optional.empty)], electionTimeoutMs=1697) (org.apache.kafka.raft.QuorumState)
[2025-02-12 15:31:59,734] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), epoch=3240, epochStartOffset=143783, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3240, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@38633bb2, 2=org.apache.kafka.raft.CandidateState$VoterState@4d3fd706, 3=org.apache.kafka.raft.CandidateState$VoterState@20d2df50}, highWatermark=Optional[LogOffsetMetadata(offset=143782, metadata=Optional.empty)], electionTimeoutMs=1265) (org.apache.kafka.raft.QuorumState)
[2025-02-12 15:31:59,748] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), epoch=3240, epochStartOffset=143783, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=3240, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@38633bb2, 2=org.apache.kafka.raft.CandidateState$VoterState@4d3fd706, 3=org.apache.kafka.raft.CandidateState$VoterState@20d2df50}, highWatermark=Optional[LogOffsetMetadata(offset=143782, metadata=Optional.empty)], electionTimeoutMs=1265) (org.apache.kafka.raft.QuorumState)
[2025-02-12 15:31:59,772] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-12 15:31:59,793] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-12 15:31:59,793] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-12 15:31:59,845] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-12 15:31:59,847] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-12 15:31:59,847] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-12 15:31:59,867] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=143784, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=10245130)]) for the first time for epoch 3240 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=143784, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=10245130)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=143784, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=10245130)])], lastFetchTimestamp=1739354519867, lastCaughtUpTimestamp=1739354519867, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-12 15:31:59,897] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
