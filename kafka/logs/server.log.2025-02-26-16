[2025-02-26 17:08:06,351] INFO [SnapshotGenerator id=3] Creating new KRaft snapshot file snapshot 00000000000000447782-0000006086 because we have waited at least 60 minute(s). (org.apache.kafka.image.publisher.SnapshotGenerator)
[2025-02-26 17:08:06,534] INFO [SnapshotEmitter id=3] Successfully wrote snapshot 00000000000000447782-0000006086 (org.apache.kafka.image.publisher.SnapshotEmitter)
[2025-02-26 17:27:20,424] INFO [RaftManager id=3] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:27:20,589] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6087, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@18d3a1c5, 2=org.apache.kafka.raft.CandidateState$VoterState@37b79bf5, 3=org.apache.kafka.raft.CandidateState$VoterState@3b663606}, highWatermark=Optional[LogOffsetMetadata(offset=450076, metadata=Optional.empty)], electionTimeoutMs=1278) from FollowerState(fetchTimeoutMs=2000, epoch=6086, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=450076, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:27:21,243] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6087, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@18d3a1c5, 2=org.apache.kafka.raft.CandidateState$VoterState@37b79bf5, 3=org.apache.kafka.raft.CandidateState$VoterState@3b663606}, highWatermark=Optional[LogOffsetMetadata(offset=450076, metadata=Optional.empty)], electionTimeoutMs=1278) from FollowerState(fetchTimeoutMs=2000, epoch=6086, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=450076, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:27:21,914] INFO [RaftManager id=3] Election has timed out, backing off for 100ms before becoming a candidate again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:27:21,990] INFO [RaftManager id=3] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:27:21,990] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6088, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7e72a315, 2=org.apache.kafka.raft.CandidateState$VoterState@7b2ae897, 3=org.apache.kafka.raft.CandidateState$VoterState@70c9bc34}, highWatermark=Optional[LogOffsetMetadata(offset=450076, metadata=Optional.empty)], electionTimeoutMs=1372) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6087, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@18d3a1c5, 2=org.apache.kafka.raft.CandidateState$VoterState@37b79bf5, 3=org.apache.kafka.raft.CandidateState$VoterState@3b663606}, highWatermark=Optional[LogOffsetMetadata(offset=450076, metadata=Optional.empty)], electionTimeoutMs=1278) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:27:22,044] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6088, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7e72a315, 2=org.apache.kafka.raft.CandidateState$VoterState@7b2ae897, 3=org.apache.kafka.raft.CandidateState$VoterState@70c9bc34}, highWatermark=Optional[LogOffsetMetadata(offset=450076, metadata=Optional.empty)], electionTimeoutMs=1372) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6087, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@18d3a1c5, 2=org.apache.kafka.raft.CandidateState$VoterState@37b79bf5, 3=org.apache.kafka.raft.CandidateState$VoterState@3b663606}, highWatermark=Optional[LogOffsetMetadata(offset=450076, metadata=Optional.empty)], electionTimeoutMs=1278) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:27:22,069] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:27:22,219] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6088, epochStartOffset=450077, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6088, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7e72a315, 2=org.apache.kafka.raft.CandidateState$VoterState@7b2ae897, 3=org.apache.kafka.raft.CandidateState$VoterState@70c9bc34}, highWatermark=Optional[LogOffsetMetadata(offset=450076, metadata=Optional.empty)], electionTimeoutMs=1372) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:27:22,277] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6088, epochStartOffset=450077, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6088, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7e72a315, 2=org.apache.kafka.raft.CandidateState$VoterState@7b2ae897, 3=org.apache.kafka.raft.CandidateState$VoterState@70c9bc34}, highWatermark=Optional[LogOffsetMetadata(offset=450076, metadata=Optional.empty)], electionTimeoutMs=1372) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:27:22,328] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:27:22,724] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:27:22,724] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:27:22,827] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:27:22,836] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=450078, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11143542)]) for the first time for epoch 6088 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=450078, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11143542)])], lastFetchTimestamp=1740571042830, lastCaughtUpTimestamp=1740571042830, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=450078, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11143542)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)] (org.apache.kafka.raft.LeaderState)
[2025-02-26 17:27:22,838] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:27:22,838] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:27:22,888] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:29:43,377] INFO [RaftManager id=3] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are java.util.stream.ReferencePipeline$3@7f7f7503 (org.apache.kafka.raft.LeaderState)
[2025-02-26 17:29:43,389] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:29:43,431] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 4406 due to node 3 being disconnected (elapsed time since creation: 4793ms, elapsed time since send: 4793ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:29:43,432] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:29:43,436] INFO [BrokerLifecycleManager id=3] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-02-26 17:29:43,455] INFO [RaftManager id=3] Completed transition to ResignedState(localId=3, epoch=6088, voters=[1, 2, 3], electionTimeoutMs=1729, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=2, directoryId=Optional.empty)]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6088, epochStartOffset=450077, highWatermark=Optional[LogOffsetMetadata(offset=450344, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11162694)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=450344, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11162694)])], lastFetchTimestamp=1740571177011, lastCaughtUpTimestamp=1740571176597, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=450344, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11162694)])], lastFetchTimestamp=1740571177011, lastCaughtUpTimestamp=1740571176587, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=450345, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11162766)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:29:43,471] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6089, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1790, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=6088, voters=[1, 2, 3], electionTimeoutMs=1729, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=2, directoryId=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:29:43,524] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6089, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1790, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=6088, voters=[1, 2, 3], electionTimeoutMs=1729, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=2, directoryId=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:29:43,527] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(1653145259). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:29:43,527] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6089, votedKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), voters=[1, 2, 3], electionTimeoutMs=1341, highWatermark=Optional.empty) from Unattached(epoch=6089, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1790, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:29:43,528] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(1725623184). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:29:43,528] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(1267198058). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:29:43,528] INFO [QuorumController id=3] failAll(NotControllerException): failing processBrokerHeartbeat(1634789442). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:29:43,530] INFO [QuorumController id=3] failAll(NotControllerException): failing processBrokerHeartbeat(1143488353). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:29:43,530] INFO [QuorumController id=3] failAll(NotControllerException): failing processBrokerHeartbeat(1965021727). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:29:43,530] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(19904622). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:29:43,530] INFO [QuorumController id=3] failAll(NotControllerException): failing maybeFenceReplicas(1744532209). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:29:43,559] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6089, votedKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), voters=[1, 2, 3], electionTimeoutMs=1341, highWatermark=Optional.empty) from Unattached(epoch=6089, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1790, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:29:43,559] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6089, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6088, lastOffset=450345)])]) with epoch 6089 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:29:43,561] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6089, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6088, lastOffset=450345)])]) with epoch 6089 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:29:43,562] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6090, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1306, highWatermark=Optional.empty) from Unattached(epoch=6089, votedKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), voters=[1, 2, 3], electionTimeoutMs=1341, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:29:43,570] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:29:43,594] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6090, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1306, highWatermark=Optional.empty) from Unattached(epoch=6089, votedKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), voters=[1, 2, 3], electionTimeoutMs=1341, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:29:43,594] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6090, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1583, highWatermark=Optional.empty) from Unattached(epoch=6090, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1306, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:29:43,670] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6090, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1583, highWatermark=Optional.empty) from Unattached(epoch=6090, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1306, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:29:43,671] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6090, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6088, lastOffset=450345)])]) with epoch 6090 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:29:43,671] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6090, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6088, lastOffset=450345)])]) with epoch 6090 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:29:43,800] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=6090, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=6090, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1583, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:29:43,842] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=6090, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=6090, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1583, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:29:43,896] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:29:43,901] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:29:43,901] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:29:43,960] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:29:44,023] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:29:44,024] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:29:44,076] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:29:44,553] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=450346, metadata=Optional.empty)] for the first time for epoch 6090 (org.apache.kafka.raft.FollowerState)
[2025-02-26 17:39:57,963] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6091, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1306, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=6090, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:39:57,983] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6091, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1306, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=6090, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:39:57,984] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6091, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6090, lastOffset=451559)])]) with epoch 6091 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:39:58,117] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6092, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1152, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)]) from Unattached(epoch=6091, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1306, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:39:58,139] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6092, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1152, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)]) from Unattached(epoch=6091, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1306, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:39:58,139] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6092, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6090, lastOffset=451559)])]) with epoch 6092 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:39:58,270] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6093, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=999, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)]) from Unattached(epoch=6092, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1152, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:39:58,324] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6093, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=999, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)]) from Unattached(epoch=6092, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1152, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:39:58,324] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6093, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6090, lastOffset=451559)])]) with epoch 6093 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:39:58,450] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6094, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=819, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)]) from Unattached(epoch=6093, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=999, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:39:58,478] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6094, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=819, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)]) from Unattached(epoch=6093, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=999, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:39:58,479] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6094, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6090, lastOffset=451559)])]) with epoch 6094 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:39:58,799] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6095, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=470, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)]) from Unattached(epoch=6094, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=819, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:39:58,833] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6095, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=470, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)]) from Unattached(epoch=6094, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=819, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:39:58,834] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6095, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6090, lastOffset=451559)])]) with epoch 6095 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:39:59,275] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6096, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@6f9bdd67, 2=org.apache.kafka.raft.CandidateState$VoterState@255d6c01, 3=org.apache.kafka.raft.CandidateState$VoterState@7151eb25}, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)], electionTimeoutMs=1250) from Unattached(epoch=6095, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=470, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:39:59,293] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6096, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@6f9bdd67, 2=org.apache.kafka.raft.CandidateState$VoterState@255d6c01, 3=org.apache.kafka.raft.CandidateState$VoterState@7151eb25}, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)], electionTimeoutMs=1250) from Unattached(epoch=6095, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=470, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:39:59,347] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6096, epochStartOffset=451565, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6096, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@6f9bdd67, 2=org.apache.kafka.raft.CandidateState$VoterState@255d6c01, 3=org.apache.kafka.raft.CandidateState$VoterState@7151eb25}, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)], electionTimeoutMs=1250) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:39:59,382] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6096, epochStartOffset=451565, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6096, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@6f9bdd67, 2=org.apache.kafka.raft.CandidateState$VoterState@255d6c01, 3=org.apache.kafka.raft.CandidateState$VoterState@7151eb25}, highWatermark=Optional[LogOffsetMetadata(offset=451564, metadata=Optional.empty)], electionTimeoutMs=1250) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:39:59,664] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=451566, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11250563)]) for the first time for epoch 6096 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=451566, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11250563)])], lastFetchTimestamp=1740571799654, lastCaughtUpTimestamp=1740571799654, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=451566, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11250563)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=451565, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11250457)])], lastFetchTimestamp=1740571799569, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-26 17:39:59,684] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:39:59,685] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:44:45,755] INFO [RaftManager id=3] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are java.util.stream.ReferencePipeline$3@72ed1fea (org.apache.kafka.raft.LeaderState)
[2025-02-26 17:44:46,012] INFO [RaftManager id=3] Completed transition to ResignedState(localId=3, epoch=6096, voters=[1, 2, 3], electionTimeoutMs=1314, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=2, directoryId=Optional.empty)]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6096, epochStartOffset=451565, highWatermark=Optional[LogOffsetMetadata(offset=452123, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11290545)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=452123, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11290545)])], lastFetchTimestamp=1740572082130, lastCaughtUpTimestamp=1740572081827, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=452123, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11290545)])], lastFetchTimestamp=1740572082129, lastCaughtUpTimestamp=1740572081809, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=452128, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11290783)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:44:46,242] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6098, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1734, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=6096, voters=[1, 2, 3], electionTimeoutMs=1314, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=2, directoryId=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:44:46,377] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6098, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1734, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=6096, voters=[1, 2, 3], electionTimeoutMs=1314, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=2, directoryId=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:44:46,409] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6098, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6096, lastOffset=452124)])]) with epoch 6098 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:44:46,445] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(1376345777). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:44:46,451] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(733749006). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:44:46,452] INFO [QuorumController id=3] failAll(NotControllerException): failing processBrokerHeartbeat(1930810203). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:44:46,453] INFO [QuorumController id=3] failAll(NotControllerException): failing processBrokerHeartbeat(1073093657). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:44:46,454] INFO [QuorumController id=3] failAll(NotControllerException): failing processBrokerHeartbeat(663892352). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:44:46,454] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(1813843475). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:44:46,454] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(827295680). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:44:46,454] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(1054233380). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:44:46,455] INFO [QuorumController id=3] failAll(NotControllerException): failing maybeFenceReplicas(150895439). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:44:46,455] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:44:46,455] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(202867157). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:44:46,465] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(1101751824). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:44:46,466] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(1298682482). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:44:47,154] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=6098, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=6098, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1734, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:44:47,170] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=6098, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=6098, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1734, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:44:47,206] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:44:47,234] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Truncating to offset 452124 (kafka.log.UnifiedLog)
[2025-02-26 17:44:47,268] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:44:47,268] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:44:47,328] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:44:47,330] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Loading producer state till offset 452124 with message format version 2 (kafka.log.UnifiedLog$)
[2025-02-26 17:44:47,334] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Reloading from producer snapshot and rebuilding producer state from offset 452124 (kafka.log.UnifiedLog$)
[2025-02-26 17:44:47,336] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=434938, file=/tmp/kafka-logs-node3/__cluster_metadata-0/00000000000000434938.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-26 17:44:47,336] INFO [BrokerLifecycleManager id=3] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-02-26 17:44:47,400] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 452124 with 0 producer ids in 8 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-26 17:44:47,401] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Producer state recovery took 13ms for snapshot load and 54ms for segment recovery from offset 452124 (kafka.log.UnifiedLog$)
[2025-02-26 17:44:47,401] INFO [RaftManager id=3] Truncated to offset 452124 from Fetch response from leader 1 (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:44:47,442] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=452125, metadata=Optional.empty)] for the first time for epoch 6098 (org.apache.kafka.raft.FollowerState)
[2025-02-26 17:44:55,389] INFO [RaftManager id=3] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:44:55,389] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6099, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@25b5b7b1, 2=org.apache.kafka.raft.CandidateState$VoterState@22ed8ec1, 3=org.apache.kafka.raft.CandidateState$VoterState@1066b9a5}, highWatermark=Optional[LogOffsetMetadata(offset=452136, metadata=Optional.empty)], electionTimeoutMs=1392) from FollowerState(fetchTimeoutMs=2000, epoch=6098, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=452136, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:44:55,789] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6099, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@25b5b7b1, 2=org.apache.kafka.raft.CandidateState$VoterState@22ed8ec1, 3=org.apache.kafka.raft.CandidateState$VoterState@1066b9a5}, highWatermark=Optional[LogOffsetMetadata(offset=452136, metadata=Optional.empty)], electionTimeoutMs=1392) from FollowerState(fetchTimeoutMs=2000, epoch=6098, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=452136, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:44:56,277] INFO [RaftManager id=3] Insufficient remaining votes to become leader (rejected by [1, 2]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:44:56,279] INFO [RaftManager id=3] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:44:56,279] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6100, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@79d24027, 2=org.apache.kafka.raft.CandidateState$VoterState@71d26893, 3=org.apache.kafka.raft.CandidateState$VoterState@3f876bee}, highWatermark=Optional[LogOffsetMetadata(offset=452136, metadata=Optional.empty)], electionTimeoutMs=1489) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6099, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@25b5b7b1, 2=org.apache.kafka.raft.CandidateState$VoterState@22ed8ec1, 3=org.apache.kafka.raft.CandidateState$VoterState@1066b9a5}, highWatermark=Optional[LogOffsetMetadata(offset=452136, metadata=Optional.empty)], electionTimeoutMs=1392) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:44:56,353] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6100, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@79d24027, 2=org.apache.kafka.raft.CandidateState$VoterState@71d26893, 3=org.apache.kafka.raft.CandidateState$VoterState@3f876bee}, highWatermark=Optional[LogOffsetMetadata(offset=452136, metadata=Optional.empty)], electionTimeoutMs=1489) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6099, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@25b5b7b1, 2=org.apache.kafka.raft.CandidateState$VoterState@22ed8ec1, 3=org.apache.kafka.raft.CandidateState$VoterState@1066b9a5}, highWatermark=Optional[LogOffsetMetadata(offset=452136, metadata=Optional.empty)], electionTimeoutMs=1392) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:44:56,457] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6100, epochStartOffset=452137, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6100, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@79d24027, 2=org.apache.kafka.raft.CandidateState$VoterState@71d26893, 3=org.apache.kafka.raft.CandidateState$VoterState@3f876bee}, highWatermark=Optional[LogOffsetMetadata(offset=452136, metadata=Optional.empty)], electionTimeoutMs=1489) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:44:56,481] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6100, epochStartOffset=452137, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6100, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@79d24027, 2=org.apache.kafka.raft.CandidateState$VoterState@71d26893, 3=org.apache.kafka.raft.CandidateState$VoterState@3f876bee}, highWatermark=Optional[LogOffsetMetadata(offset=452136, metadata=Optional.empty)], electionTimeoutMs=1489) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:44:56,606] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=452138, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11291693)]) for the first time for epoch 6100 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=452138, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11291693)])], lastFetchTimestamp=1740572096605, lastCaughtUpTimestamp=1740572096605, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=452138, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11291693)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-26 17:44:57,930] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:44:57,934] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:45:50,589] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6101, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1607, highWatermark=Optional[LogOffsetMetadata(offset=452240, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11299037)])]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6100, epochStartOffset=452137, highWatermark=Optional[LogOffsetMetadata(offset=452240, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11299037)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=452239, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11298965)])], lastFetchTimestamp=1740572148123, lastCaughtUpTimestamp=1740572147698, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=452240, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11299037)])], lastFetchTimestamp=1740572150527, lastCaughtUpTimestamp=1740572148123, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=452244, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11299142)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:45:50,806] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6101, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1607, highWatermark=Optional[LogOffsetMetadata(offset=452240, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11299037)])]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6100, epochStartOffset=452137, highWatermark=Optional[LogOffsetMetadata(offset=452240, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11299037)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=452239, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11298965)])], lastFetchTimestamp=1740572148123, lastCaughtUpTimestamp=1740572147698, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=452240, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11299037)])], lastFetchTimestamp=1740572150527, lastCaughtUpTimestamp=1740572148123, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=452244, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11299142)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:45:50,820] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6101, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6100, lastOffset=452240)])]) with epoch 6101 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:45:50,836] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(206999268). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:45:50,840] INFO [QuorumController id=3] failAll(NotControllerException): failing processBrokerHeartbeat(2041910619). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:45:50,841] INFO [QuorumController id=3] failAll(NotControllerException): failing processBrokerHeartbeat(273069562). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:45:50,860] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:45:50,860] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(1941646210). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:45:50,861] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(1268955839). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:45:50,861] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(443314525). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:45:50,861] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(1067515535). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:45:51,793] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=6101, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=452240, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11299037)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=6101, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1607, highWatermark=Optional[LogOffsetMetadata(offset=452240, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11299037)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:45:51,871] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=6101, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=452240, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11299037)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=6101, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1607, highWatermark=Optional[LogOffsetMetadata(offset=452240, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11299037)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:45:51,877] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:45:51,883] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:45:51,884] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:45:51,923] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Truncating to offset 452240 (kafka.log.UnifiedLog)
[2025-02-26 17:45:51,924] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Loading producer state till offset 452240 with message format version 2 (kafka.log.UnifiedLog$)
[2025-02-26 17:45:51,924] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Reloading from producer snapshot and rebuilding producer state from offset 452240 (kafka.log.UnifiedLog$)
[2025-02-26 17:45:51,925] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=452124, file=/tmp/kafka-logs-node3/__cluster_metadata-0/00000000000000452124.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-26 17:45:51,934] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:45:51,956] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 452240 with 0 producer ids in 31 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-26 17:45:51,958] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Producer state recovery took 1ms for snapshot load and 33ms for segment recovery from offset 452240 (kafka.log.UnifiedLog$)
[2025-02-26 17:45:51,958] INFO [RaftManager id=3] Truncated to offset 452240 from Fetch response from leader 2 (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:47:34,602] INFO [RaftManager id=3] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:47:34,602] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6102, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@481e6a04, 2=org.apache.kafka.raft.CandidateState$VoterState@13cdc976, 3=org.apache.kafka.raft.CandidateState$VoterState@58eb0a4f}, highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)], electionTimeoutMs=1325) from FollowerState(fetchTimeoutMs=2000, epoch=6101, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:47:35,590] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6102, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@481e6a04, 2=org.apache.kafka.raft.CandidateState$VoterState@13cdc976, 3=org.apache.kafka.raft.CandidateState$VoterState@58eb0a4f}, highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)], electionTimeoutMs=1325) from FollowerState(fetchTimeoutMs=2000, epoch=6101, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:47:35,591] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6102, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6101, lastOffset=452441)])]) with epoch 6102 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:47:35,930] INFO [RaftManager id=3] Election has timed out, backing off for 0ms before becoming a candidate again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:47:35,930] INFO [RaftManager id=3] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:47:35,931] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6103, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@21061867, 2=org.apache.kafka.raft.CandidateState$VoterState@1a731809, 3=org.apache.kafka.raft.CandidateState$VoterState@6788e448}, highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)], electionTimeoutMs=1447) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6102, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@481e6a04, 2=org.apache.kafka.raft.CandidateState$VoterState@13cdc976, 3=org.apache.kafka.raft.CandidateState$VoterState@58eb0a4f}, highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)], electionTimeoutMs=1325) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:47:36,897] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6103, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@21061867, 2=org.apache.kafka.raft.CandidateState$VoterState@1a731809, 3=org.apache.kafka.raft.CandidateState$VoterState@6788e448}, highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)], electionTimeoutMs=1447) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6102, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@481e6a04, 2=org.apache.kafka.raft.CandidateState$VoterState@13cdc976, 3=org.apache.kafka.raft.CandidateState$VoterState@58eb0a4f}, highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)], electionTimeoutMs=1325) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:47:36,902] INFO [RaftManager id=3] Disconnecting from node 2 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:47:36,911] INFO [RaftManager id=3] Cancelled in-flight FETCH request with correlation id 18889 due to node 2 being disconnected (elapsed time since creation: 2690ms, elapsed time since send: 2689ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:47:37,187] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Disconnecting from node 2 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:47:37,187] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 4952 due to node 2 being disconnected (elapsed time since creation: 4520ms, elapsed time since send: 4519ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:47:37,187] INFO [BrokerLifecycleManager id=3] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-02-26 17:47:37,384] INFO [RaftManager id=3] Election has timed out, backing off for 300ms before becoming a candidate again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:47:37,684] INFO [RaftManager id=3] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:47:37,685] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6104, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@67312384, 2=org.apache.kafka.raft.CandidateState$VoterState@76e5ca25, 3=org.apache.kafka.raft.CandidateState$VoterState@74d427a0}, highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)], electionTimeoutMs=1378) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6103, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@21061867, 2=org.apache.kafka.raft.CandidateState$VoterState@1a731809, 3=org.apache.kafka.raft.CandidateState$VoterState@6788e448}, highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)], electionTimeoutMs=1447) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:47:37,729] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6104, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@67312384, 2=org.apache.kafka.raft.CandidateState$VoterState@76e5ca25, 3=org.apache.kafka.raft.CandidateState$VoterState@74d427a0}, highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)], electionTimeoutMs=1378) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6103, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@21061867, 2=org.apache.kafka.raft.CandidateState$VoterState@1a731809, 3=org.apache.kafka.raft.CandidateState$VoterState@6788e448}, highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)], electionTimeoutMs=1447) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:47:37,732] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6104, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6101, lastOffset=452441)])]) with epoch 6104 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:47:37,869] INFO [RaftManager id=3] Insufficient remaining votes to become leader (rejected by [1, 2]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:47:38,204] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6105, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=858, highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)]) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6104, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@67312384, 2=org.apache.kafka.raft.CandidateState$VoterState@76e5ca25, 3=org.apache.kafka.raft.CandidateState$VoterState@74d427a0}, highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)], electionTimeoutMs=1378) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:47:38,252] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6105, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=858, highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)]) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6104, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@67312384, 2=org.apache.kafka.raft.CandidateState$VoterState@76e5ca25, 3=org.apache.kafka.raft.CandidateState$VoterState@74d427a0}, highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)], electionTimeoutMs=1378) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:47:38,253] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6105, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1633, highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)]) from Unattached(epoch=6105, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=858, highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:47:38,285] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6105, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1633, highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)]) from Unattached(epoch=6105, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=858, highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:47:38,286] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6105, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6101, lastOffset=452441)])]) with epoch 6105 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:47:38,415] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=6105, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=6105, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1633, highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:47:38,463] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=6105, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=6105, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1633, highWatermark=Optional[LogOffsetMetadata(offset=452440, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:47:38,506] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:47:38,567] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:47:38,568] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:47:38,625] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:49:27,953] INFO [RaftManager id=3] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:49:27,954] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6106, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@62277207, 2=org.apache.kafka.raft.CandidateState$VoterState@21489109, 3=org.apache.kafka.raft.CandidateState$VoterState@fbf2030}, highWatermark=Optional[LogOffsetMetadata(offset=452654, metadata=Optional.empty)], electionTimeoutMs=1160) from FollowerState(fetchTimeoutMs=2000, epoch=6105, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=452654, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:49:28,873] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6106, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@62277207, 2=org.apache.kafka.raft.CandidateState$VoterState@21489109, 3=org.apache.kafka.raft.CandidateState$VoterState@fbf2030}, highWatermark=Optional[LogOffsetMetadata(offset=452654, metadata=Optional.empty)], electionTimeoutMs=1160) from FollowerState(fetchTimeoutMs=2000, epoch=6105, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=452654, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:49:29,117] INFO [RaftManager id=3] Election has timed out, backing off for 0ms before becoming a candidate again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:49:29,117] INFO [RaftManager id=3] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:49:29,117] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6107, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@22caf3b7, 2=org.apache.kafka.raft.CandidateState$VoterState@7b241aa3, 3=org.apache.kafka.raft.CandidateState$VoterState@1e811c17}, highWatermark=Optional[LogOffsetMetadata(offset=452654, metadata=Optional.empty)], electionTimeoutMs=1354) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6106, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@62277207, 2=org.apache.kafka.raft.CandidateState$VoterState@21489109, 3=org.apache.kafka.raft.CandidateState$VoterState@fbf2030}, highWatermark=Optional[LogOffsetMetadata(offset=452654, metadata=Optional.empty)], electionTimeoutMs=1160) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:49:29,317] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:49:29,318] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6107, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@22caf3b7, 2=org.apache.kafka.raft.CandidateState$VoterState@7b241aa3, 3=org.apache.kafka.raft.CandidateState$VoterState@1e811c17}, highWatermark=Optional[LogOffsetMetadata(offset=452654, metadata=Optional.empty)], electionTimeoutMs=1354) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6106, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@62277207, 2=org.apache.kafka.raft.CandidateState$VoterState@21489109, 3=org.apache.kafka.raft.CandidateState$VoterState@fbf2030}, highWatermark=Optional[LogOffsetMetadata(offset=452654, metadata=Optional.empty)], electionTimeoutMs=1160) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:49:30,479] INFO [RaftManager id=3] Election has timed out, backing off for 300ms before becoming a candidate again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:49:30,528] INFO [BrokerLifecycleManager id=3] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-02-26 17:49:30,558] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6107, epochStartOffset=452655, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6107, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@22caf3b7, 2=org.apache.kafka.raft.CandidateState$VoterState@7b241aa3, 3=org.apache.kafka.raft.CandidateState$VoterState@1e811c17}, highWatermark=Optional[LogOffsetMetadata(offset=452654, metadata=Optional.empty)], electionTimeoutMs=1354) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:49:30,613] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6107, epochStartOffset=452655, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6107, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@22caf3b7, 2=org.apache.kafka.raft.CandidateState$VoterState@7b241aa3, 3=org.apache.kafka.raft.CandidateState$VoterState@1e811c17}, highWatermark=Optional[LogOffsetMetadata(offset=452654, metadata=Optional.empty)], electionTimeoutMs=1354) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:49:30,630] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:49:30,637] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:49:30,638] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:49:30,691] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:49:30,708] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:49:30,709] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:49:30,759] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:49:30,801] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:49:30,811] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:49:30,864] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:49:30,871] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:49:30,873] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:49:30,924] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:49:30,929] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:49:30,930] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:49:30,976] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=452656, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11329030)]) for the first time for epoch 6107 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=452656, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11329030)])], lastFetchTimestamp=1740572370975, lastCaughtUpTimestamp=1740572370975, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=452656, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11329030)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=452655, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11328924)])], lastFetchTimestamp=1740572370920, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-26 17:49:30,982] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:51:26,119] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6108, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1070, highWatermark=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6107, epochStartOffset=452655, highWatermark=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])], lastFetchTimestamp=1740572486009, lastCaughtUpTimestamp=1740572486009, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=452879, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345025)])], lastFetchTimestamp=1740572483625, lastCaughtUpTimestamp=1740572483233, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:51:26,273] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6108, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1070, highWatermark=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6107, epochStartOffset=452655, highWatermark=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])], lastFetchTimestamp=1740572486009, lastCaughtUpTimestamp=1740572486009, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=452879, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345025)])], lastFetchTimestamp=1740572483625, lastCaughtUpTimestamp=1740572483233, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:51:26,275] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(260759858). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-26 17:51:26,276] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6108, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6107, lastOffset=452880)])]) with epoch 6108 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:51:26,550] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6109, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=639, highWatermark=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])]) from Unattached(epoch=6108, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1070, highWatermark=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:51:26,741] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6109, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=639, highWatermark=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])]) from Unattached(epoch=6108, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1070, highWatermark=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:51:26,743] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6109, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6107, lastOffset=452880)])]) with epoch 6109 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:51:27,069] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6110, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=120, highWatermark=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])]) from Unattached(epoch=6109, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=639, highWatermark=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:51:27,466] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6110, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=120, highWatermark=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])]) from Unattached(epoch=6109, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=639, highWatermark=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:51:27,466] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6110, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6107, lastOffset=452880)])]) with epoch 6110 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:51:27,468] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6111, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@2969f1c1, 2=org.apache.kafka.raft.CandidateState$VoterState@2cce5f54, 3=org.apache.kafka.raft.CandidateState$VoterState@383f6b3}, highWatermark=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])], electionTimeoutMs=1144) from Unattached(epoch=6110, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=120, highWatermark=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:51:27,897] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6111, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@2969f1c1, 2=org.apache.kafka.raft.CandidateState$VoterState@2cce5f54, 3=org.apache.kafka.raft.CandidateState$VoterState@383f6b3}, highWatermark=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])], electionTimeoutMs=1144) from Unattached(epoch=6110, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=120, highWatermark=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:51:28,012] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:51:28,544] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6111, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6107, lastOffset=452884)])]) with epoch 6111 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:51:28,611] INFO [RaftManager id=3] Insufficient remaining votes to become leader (rejected by [1, 2]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:51:28,621] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6111, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6107, lastOffset=452880)])]) with epoch 6111 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:51:28,711] INFO [RaftManager id=3] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:51:28,712] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6112, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@387e654e, 2=org.apache.kafka.raft.CandidateState$VoterState@5eff6c79, 3=org.apache.kafka.raft.CandidateState$VoterState@15bc0d}, highWatermark=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])], electionTimeoutMs=1847) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6111, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@2969f1c1, 2=org.apache.kafka.raft.CandidateState$VoterState@2cce5f54, 3=org.apache.kafka.raft.CandidateState$VoterState@383f6b3}, highWatermark=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])], electionTimeoutMs=1144) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:51:28,831] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6112, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@387e654e, 2=org.apache.kafka.raft.CandidateState$VoterState@5eff6c79, 3=org.apache.kafka.raft.CandidateState$VoterState@15bc0d}, highWatermark=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])], electionTimeoutMs=1847) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6111, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@2969f1c1, 2=org.apache.kafka.raft.CandidateState$VoterState@2cce5f54, 3=org.apache.kafka.raft.CandidateState$VoterState@383f6b3}, highWatermark=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])], electionTimeoutMs=1144) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:51:28,853] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6112, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6107, lastOffset=452884)])]) with epoch 6112 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:51:29,127] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6112, epochStartOffset=452884, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6112, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@387e654e, 2=org.apache.kafka.raft.CandidateState$VoterState@5eff6c79, 3=org.apache.kafka.raft.CandidateState$VoterState@15bc0d}, highWatermark=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])], electionTimeoutMs=1847) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:51:29,564] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6112, epochStartOffset=452884, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6112, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@387e654e, 2=org.apache.kafka.raft.CandidateState$VoterState@5eff6c79, 3=org.apache.kafka.raft.CandidateState$VoterState@15bc0d}, highWatermark=Optional[LogOffsetMetadata(offset=452884, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345263)])], electionTimeoutMs=1847) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:51:29,569] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:51:29,594] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:51:29,594] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:51:29,645] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:51:29,648] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:51:29,649] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:51:29,699] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:51:29,711] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:51:29,712] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:51:29,753] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6113, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1222, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6112, epochStartOffset=452884, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=452885, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345369)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:51:29,770] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:51:29,787] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:51:29,790] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:51:29,842] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:51:29,855] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:51:29,857] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:51:29,906] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:51:29,909] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:51:29,910] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:51:29,919] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6113, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1222, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6112, epochStartOffset=452884, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=452885, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=11345369)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:51:29,919] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6113, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6107, lastOffset=452884)])]) with epoch 6113 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:51:29,965] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=6113, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=6113, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1222, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:51:30,035] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=6113, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=6113, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1222, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:51:30,066] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:51:30,103] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Truncating to offset 452884 (kafka.log.UnifiedLog)
[2025-02-26 17:51:30,147] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:51:30,157] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Loading producer state till offset 452884 with message format version 2 (kafka.log.UnifiedLog$)
[2025-02-26 17:51:30,158] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Reloading from producer snapshot and rebuilding producer state from offset 452884 (kafka.log.UnifiedLog$)
[2025-02-26 17:51:30,158] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=452240, file=/tmp/kafka-logs-node3/__cluster_metadata-0/00000000000000452240.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-26 17:51:30,173] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:51:30,198] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:51:30,231] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 452884 with 0 producer ids in 69 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-26 17:51:30,231] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Producer state recovery took 1ms for snapshot load and 72ms for segment recovery from offset 452884 (kafka.log.UnifiedLog$)
[2025-02-26 17:51:30,231] INFO [RaftManager id=3] Truncated to offset 452884 from Fetch response from leader 1 (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:51:30,288] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=452885, metadata=Optional.empty)] for the first time for epoch 6113 (org.apache.kafka.raft.FollowerState)
[2025-02-26 17:53:19,055] INFO [RaftManager id=3] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:53:19,091] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6114, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@68352a8f, 2=org.apache.kafka.raft.CandidateState$VoterState@555f18bb, 3=org.apache.kafka.raft.CandidateState$VoterState@444c57cf}, highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)], electionTimeoutMs=1615) from FollowerState(fetchTimeoutMs=2000, epoch=6113, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:53:20,222] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6114, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@68352a8f, 2=org.apache.kafka.raft.CandidateState$VoterState@555f18bb, 3=org.apache.kafka.raft.CandidateState$VoterState@444c57cf}, highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)], electionTimeoutMs=1615) from FollowerState(fetchTimeoutMs=2000, epoch=6113, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:53:20,645] INFO [RaftManager id=3] Insufficient remaining votes to become leader (rejected by [1, 2]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:53:20,645] INFO [RaftManager id=3] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:53:20,646] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6115, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5bec3191, 2=org.apache.kafka.raft.CandidateState$VoterState@1a4c0931, 3=org.apache.kafka.raft.CandidateState$VoterState@37fb4003}, highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)], electionTimeoutMs=1813) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6114, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@68352a8f, 2=org.apache.kafka.raft.CandidateState$VoterState@555f18bb, 3=org.apache.kafka.raft.CandidateState$VoterState@444c57cf}, highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)], electionTimeoutMs=1615) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:53:20,698] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6115, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5bec3191, 2=org.apache.kafka.raft.CandidateState$VoterState@1a4c0931, 3=org.apache.kafka.raft.CandidateState$VoterState@37fb4003}, highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)], electionTimeoutMs=1813) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6114, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@68352a8f, 2=org.apache.kafka.raft.CandidateState$VoterState@555f18bb, 3=org.apache.kafka.raft.CandidateState$VoterState@444c57cf}, highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)], electionTimeoutMs=1615) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:53:20,793] INFO [RaftManager id=3] Insufficient remaining votes to become leader (rejected by [1, 2]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:53:21,093] INFO [RaftManager id=3] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:53:21,094] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6116, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@112f8b1c, 2=org.apache.kafka.raft.CandidateState$VoterState@2b754011, 3=org.apache.kafka.raft.CandidateState$VoterState@518ad1cf}, highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)], electionTimeoutMs=1654) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6115, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5bec3191, 2=org.apache.kafka.raft.CandidateState$VoterState@1a4c0931, 3=org.apache.kafka.raft.CandidateState$VoterState@37fb4003}, highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)], electionTimeoutMs=1813) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:53:21,174] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6116, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@112f8b1c, 2=org.apache.kafka.raft.CandidateState$VoterState@2b754011, 3=org.apache.kafka.raft.CandidateState$VoterState@518ad1cf}, highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)], electionTimeoutMs=1654) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6115, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5bec3191, 2=org.apache.kafka.raft.CandidateState$VoterState@1a4c0931, 3=org.apache.kafka.raft.CandidateState$VoterState@37fb4003}, highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)], electionTimeoutMs=1813) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:53:21,261] INFO [RaftManager id=3] Insufficient remaining votes to become leader (rejected by [1, 2]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:53:21,274] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:53:21,846] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6117, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=902, highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)]) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6116, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@112f8b1c, 2=org.apache.kafka.raft.CandidateState$VoterState@2b754011, 3=org.apache.kafka.raft.CandidateState$VoterState@518ad1cf}, highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)], electionTimeoutMs=1654) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:53:21,907] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6117, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=902, highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)]) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6116, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@112f8b1c, 2=org.apache.kafka.raft.CandidateState$VoterState@2b754011, 3=org.apache.kafka.raft.CandidateState$VoterState@518ad1cf}, highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)], electionTimeoutMs=1654) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:53:21,907] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6117, votedKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), voters=[1, 2, 3], electionTimeoutMs=1461, highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)]) from Unattached(epoch=6117, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=902, highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:53:21,947] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6117, votedKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), voters=[1, 2, 3], electionTimeoutMs=1461, highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)]) from Unattached(epoch=6117, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=902, highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:53:21,947] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6117, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6113, lastOffset=453101)])]) with epoch 6117 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-26 17:53:22,074] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=6117, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=6117, votedKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), voters=[1, 2, 3], electionTimeoutMs=1461, highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:53:22,172] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=6117, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=6117, votedKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), voters=[1, 2, 3], electionTimeoutMs=1461, highWatermark=Optional[LogOffsetMetadata(offset=453094, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-26 17:53:22,203] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:53:22,225] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:53:22,227] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:53:22,279] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:53:22,298] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-26 17:53:22,299] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-26 17:53:22,350] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
