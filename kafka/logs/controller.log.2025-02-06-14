[2025-02-06 15:03:12,725] INFO [QuorumController id=2] maybeBalancePartitionLeaders: generated 4 records in 32281 microseconds. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:03:12,736] INFO [QuorumController id=2] maybeElectUncleanLeaders: generated 0 records in 437 microseconds. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:05:28,381] INFO [QuorumController id=2] Replaying ProducerIdsRecord ProducerIdsRecord(brokerId=2, brokerEpoch=29585, nextProducerId=7000) (org.apache.kafka.controller.ProducerIdControlManager)
[2025-02-06 15:05:28,510] INFO [QuorumController id=2] Replaying ProducerIdsRecord ProducerIdsRecord(brokerId=3, brokerEpoch=29584, nextProducerId=8000) (org.apache.kafka.controller.ProducerIdControlManager)
[2025-02-06 15:05:45,565] WARN [QuorumController id=2] Renouncing the leadership due to a metadata log event. We were the leader at epoch 409, but in the new epoch 410, the leader is (none). Reverting to last stable offset 30549. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:05:45,566] INFO [QuorumController id=2] writeNoOpRecord: event failed with NotControllerException in 2064631 microseconds. Exception message: No controller appears to be active. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:05:45,566] INFO [QuorumController id=2] writeNoOpRecord: event failed with NotControllerException in 1560986 microseconds. Exception message: No controller appears to be active. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:05:45,566] INFO [QuorumController id=2] processBrokerHeartbeat: event failed with NotControllerException in 1481929 microseconds. Exception message: No controller appears to be active. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:05:45,569] INFO [QuorumController id=2] processBrokerHeartbeat: event failed with NotControllerException in 1483821 microseconds. Exception message: No controller appears to be active. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:05:45,569] INFO [QuorumController id=2] writeNoOpRecord: event failed with NotControllerException in 1052009 microseconds. Exception message: No controller appears to be active. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:05:45,569] INFO [QuorumController id=2] writeNoOpRecord: event failed with NotControllerException in 551637 microseconds. Exception message: No controller appears to be active. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:05:45,569] INFO [QuorumController id=2] maybeFenceReplicas: event failed with NotControllerException in 514530 microseconds. Exception message: No controller appears to be active. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:05:45,570] INFO [QuorumController id=2] writeNoOpRecord: event failed with NotControllerException in 51673 microseconds. Exception message: No controller appears to be active. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:05:46,927] INFO [QuorumController id=2] In the new epoch 411, the leader is (none). (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:05:47,424] INFO [QuorumController id=2] processBrokerHeartbeat: event failed with NotControllerException in 154 microseconds. Exception message: The active controller appears to be node 2. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:05:47,485] INFO [QuorumController id=2] processBrokerHeartbeat: event failed with NotControllerException in 64 microseconds. Exception message: The active controller appears to be node 2. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:05:47,540] INFO [QuorumController id=2] processBrokerHeartbeat: event failed with NotControllerException in 28 microseconds. Exception message: The active controller appears to be node 2. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:05:47,599] INFO [QuorumController id=2] processBrokerHeartbeat: event failed with NotControllerException in 181 microseconds. Exception message: The active controller appears to be node 2. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:05:47,618] INFO [QuorumController id=2] processBrokerHeartbeat: event failed with NotControllerException in 44 microseconds. Exception message: The active controller appears to be node 2. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:05:47,632] INFO [QuorumController id=2] Becoming the active controller at epoch 411, next write offset 30555. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:05:47,632] WARN [QuorumController id=2] Performing controller activation. Loaded ZK migration state of NONE. This is expected because this is a de-novo KRaft cluster. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:10:47,640] INFO [QuorumController id=2] maybeBalancePartitionLeaders: generated 0 records in 7292 microseconds. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:10:47,641] INFO [QuorumController id=2] maybeElectUncleanLeaders: generated 0 records in 648 microseconds. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:15:47,648] INFO [QuorumController id=2] maybeBalancePartitionLeaders: generated 0 records in 6641 microseconds. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:15:47,649] INFO [QuorumController id=2] maybeElectUncleanLeaders: generated 0 records in 796 microseconds. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:16:30,637] INFO [QuorumController id=2] Replayed RegisterControllerRecord contaning ControllerRegistration(id=1, incarnationId=RfUKH8TfRhK_ThbJn9O-qA, zkMigrationReady=false, listeners=[Endpoint(listenerName='CONTROLLER', securityProtocol=PLAINTEXT, host='vbox', port=19092)], supportedFeatures={kraft.version: 0-1, metadata.version: 1-21}). Previous incarnation was BoH3JIVET1ulWASZiJuWpA (org.apache.kafka.controller.ClusterControlManager)
[2025-02-06 15:16:30,761] INFO [QuorumController id=2] Registering a new incarnation of broker 1. Previous incarnation ID was 8QQSYoPWS3a04yu83o0PCg; new incarnation ID is rioja3KBS5eFanx1VdC8jg. Generated 0 record(s) to clean up previous incarnations. Broker epoch will become 31835. (org.apache.kafka.controller.ClusterControlManager)
[2025-02-06 15:16:30,761] INFO [QuorumController id=2] Replayed RegisterBrokerRecord establishing a new incarnation of broker 1: RegisterBrokerRecord(brokerId=1, isMigratingZkBroker=false, incarnationId=rioja3KBS5eFanx1VdC8jg, brokerEpoch=31835, endPoints=[BrokerEndpoint(name='PLAINTEXT', host='172.25.10.83', port=9092, securityProtocol=0)], features=[BrokerFeature(name='kraft.version', minSupportedVersion=0, maxSupportedVersion=1), BrokerFeature(name='metadata.version', minSupportedVersion=1, maxSupportedVersion=21)], rack=null, fenced=true, inControlledShutdown=false, logDirs=[mQes9A54bQCw7Vbw6Ptauw]) (org.apache.kafka.controller.ClusterControlManager)
[2025-02-06 15:16:31,921] INFO [QuorumController id=2] The request from broker 1 to unfence has been granted because it has caught up with the offset of its register broker record 31835. (org.apache.kafka.controller.BrokerHeartbeatManager)
[2025-02-06 15:16:31,922] INFO [QuorumController id=2] handleBrokerUnfenced: changing 16 partition(s) (org.apache.kafka.controller.ReplicationControlManager)
[2025-02-06 15:16:31,922] INFO [QuorumController id=2] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 1: BrokerRegistrationChangeRecord(brokerId=1, brokerEpoch=31835, fenced=-1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2025-02-06 15:20:47,650] INFO [QuorumController id=2] maybeBalancePartitionLeaders: generated 4 records in 1556 microseconds. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:20:47,653] INFO [QuorumController id=2] maybeElectUncleanLeaders: generated 0 records in 212 microseconds. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:36,990] WARN [QuorumController id=2] Renouncing the leadership due to a metadata log event. We were the leader at epoch 411, but in the new epoch 412, the leader is (none). Reverting to last stable offset 33071. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:36,991] INFO [QuorumController id=2] writeNoOpRecord: event failed with NotControllerException in 2210177 microseconds. Exception message: No controller appears to be active. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:36,991] INFO [QuorumController id=2] writeNoOpRecord: event failed with NotControllerException in 1710009 microseconds. Exception message: No controller appears to be active. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:36,991] INFO [QuorumController id=2] writeNoOpRecord: event failed with NotControllerException in 1208723 microseconds. Exception message: No controller appears to be active. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:36,991] INFO [QuorumController id=2] processBrokerHeartbeat: event failed with NotControllerException in 866320 microseconds. Exception message: No controller appears to be active. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:36,992] INFO [QuorumController id=2] processBrokerHeartbeat: event failed with NotControllerException in 866180 microseconds. Exception message: No controller appears to be active. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:36,996] INFO [QuorumController id=2] processBrokerHeartbeat: event failed with NotControllerException in 869156 microseconds. Exception message: No controller appears to be active. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:36,996] INFO [QuorumController id=2] writeNoOpRecord: event failed with NotControllerException in 713103 microseconds. Exception message: No controller appears to be active. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:36,996] INFO [QuorumController id=2] writeNoOpRecord: event failed with NotControllerException in 212713 microseconds. Exception message: No controller appears to be active. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:37,214] INFO [QuorumController id=2] In the new epoch 413, the leader is (none). (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:37,828] INFO [QuorumController id=2] In the new epoch 414, the leader is (none). (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:38,004] INFO [QuorumController id=2] In the new epoch 415, the leader is (none). (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:38,597] INFO [QuorumController id=2] In the new epoch 416, the leader is (none). (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:39,131] INFO [QuorumController id=2] processBrokerHeartbeat: event failed with NotControllerException in 283 microseconds. Exception message: The active controller appears to be node 2. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:39,187] INFO [QuorumController id=2] processBrokerHeartbeat: event failed with NotControllerException in 25 microseconds. Exception message: The active controller appears to be node 2. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:39,243] INFO [QuorumController id=2] processBrokerHeartbeat: event failed with NotControllerException in 98 microseconds. Exception message: The active controller appears to be node 2. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:39,302] INFO [QuorumController id=2] processBrokerHeartbeat: event failed with NotControllerException in 88 microseconds. Exception message: The active controller appears to be node 2. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:39,359] INFO [QuorumController id=2] processBrokerHeartbeat: event failed with NotControllerException in 29 microseconds. Exception message: The active controller appears to be node 2. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:39,361] INFO [QuorumController id=2] processBrokerHeartbeat: event failed with NotControllerException in 29 microseconds. Exception message: The active controller appears to be node 2. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:39,416] INFO [QuorumController id=2] processBrokerHeartbeat: event failed with NotControllerException in 110 microseconds. Exception message: The active controller appears to be node 2. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:39,422] INFO [QuorumController id=2] processBrokerHeartbeat: event failed with NotControllerException in 71 microseconds. Exception message: The active controller appears to be node 2. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:39,434] INFO [QuorumController id=2] processBrokerHeartbeat: event failed with NotControllerException in 98 microseconds. Exception message: The active controller appears to be node 2. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:39,471] INFO [QuorumController id=2] processBrokerHeartbeat: event failed with NotControllerException in 36 microseconds. Exception message: The active controller appears to be node 2. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:39,479] INFO [QuorumController id=2] processBrokerHeartbeat: event failed with NotControllerException in 39 microseconds. Exception message: The active controller appears to be node 2. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:39,496] INFO [QuorumController id=2] processBrokerHeartbeat: event failed with NotControllerException in 93 microseconds. Exception message: The active controller appears to be node 2. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:39,522] INFO [QuorumController id=2] Becoming the active controller at epoch 416, next write offset 33077. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:26:39,522] WARN [QuorumController id=2] Performing controller activation. Loaded ZK migration state of NONE. This is expected because this is a de-novo KRaft cluster. (org.apache.kafka.controller.QuorumController)
[2025-02-06 15:34:30,420] INFO [QuorumController id=2] Replaying ProducerIdsRecord ProducerIdsRecord(brokerId=1, brokerEpoch=31835, nextProducerId=9000) (org.apache.kafka.controller.ProducerIdControlManager)
[2025-02-06 15:37:46,369] INFO [QuorumController id=2] Unfenced broker 1 has requested and been granted a controlled shutdown. (org.apache.kafka.controller.BrokerHeartbeatManager)
[2025-02-06 15:37:46,370] INFO [QuorumController id=2] enterControlledShutdown[1]: changing 28 partition(s) (org.apache.kafka.controller.ReplicationControlManager)
[2025-02-06 15:37:46,371] INFO [QuorumController id=2] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 1: BrokerRegistrationChangeRecord(brokerId=1, brokerEpoch=31835, fenced=0, inControlledShutdown=1, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2025-02-06 15:37:46,390] INFO [QuorumController id=2] Unfenced broker 3 has requested and been granted a controlled shutdown. (org.apache.kafka.controller.BrokerHeartbeatManager)
[2025-02-06 15:37:46,392] INFO [QuorumController id=2] enterControlledShutdown[3]: changing 29 partition(s) (org.apache.kafka.controller.ReplicationControlManager)
[2025-02-06 15:37:46,392] INFO [QuorumController id=2] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 3: BrokerRegistrationChangeRecord(brokerId=3, brokerEpoch=29584, fenced=0, inControlledShutdown=1, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2025-02-06 15:37:46,393] INFO [QuorumController id=2] Unfenced broker 2 has requested and been granted a controlled shutdown. (org.apache.kafka.controller.BrokerHeartbeatManager)
[2025-02-06 15:37:46,408] INFO [QuorumController id=2] enterControlledShutdown[2]: changing 29 partition(s) (org.apache.kafka.controller.ReplicationControlManager)
[2025-02-06 15:37:46,409] INFO [QuorumController id=2] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 2: BrokerRegistrationChangeRecord(brokerId=2, brokerEpoch=29585, fenced=0, inControlledShutdown=1, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2025-02-06 15:37:46,501] INFO [QuorumController id=2] The request from broker 3 to shut down has been granted since the lowest active offset 9223372036854775807 is now greater than the broker's controlled shutdown offset 34463. (org.apache.kafka.controller.BrokerHeartbeatManager)
[2025-02-06 15:37:46,502] INFO [QuorumController id=2] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 3: BrokerRegistrationChangeRecord(brokerId=3, brokerEpoch=29584, fenced=1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2025-02-06 15:37:46,504] INFO [QuorumController id=2] The request from broker 1 to shut down has been granted since the lowest active offset 9223372036854775807 is now greater than the broker's controlled shutdown offset 34433. (org.apache.kafka.controller.BrokerHeartbeatManager)
[2025-02-06 15:37:46,505] INFO [QuorumController id=2] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 1: BrokerRegistrationChangeRecord(brokerId=1, brokerEpoch=31835, fenced=1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2025-02-06 15:37:46,520] INFO [QuorumController id=2] The request from broker 2 to shut down has been granted since the lowest active offset 9223372036854775807 is now greater than the broker's controlled shutdown offset 34493. (org.apache.kafka.controller.BrokerHeartbeatManager)
[2025-02-06 15:37:46,522] INFO [QuorumController id=2] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 2: BrokerRegistrationChangeRecord(brokerId=2, brokerEpoch=29585, fenced=1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2025-02-06 15:37:47,947] INFO [QuorumController id=2] writeNoOpRecord: event failed with NotLeaderException (treated as NotControllerException) at epoch 416 in 116 microseconds. Renouncing leadership and reverting to the last committed offset 34499. Exception message: Append failed because the replica is not the current leader (org.apache.kafka.controller.QuorumController)
