[2025-02-25 12:00:26,496] INFO [SnapshotGenerator id=1] Creating new KRaft snapshot file snapshot 00000000000000344400-0000004447 because we have waited at least 60 minute(s). (org.apache.kafka.image.publisher.SnapshotGenerator)
[2025-02-25 12:00:26,625] INFO [SnapshotEmitter id=1] Successfully wrote snapshot 00000000000000344400-0000004447 (org.apache.kafka.image.publisher.SnapshotEmitter)
[2025-02-25 12:17:15,197] INFO [RaftManager id=1] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 12:17:15,223] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4448, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@55ef7aa3, 2=org.apache.kafka.raft.CandidateState$VoterState@1e1bdc5d, 3=org.apache.kafka.raft.CandidateState$VoterState@3f13f641}, highWatermark=Optional[LogOffsetMetadata(offset=346402, metadata=Optional.empty)], electionTimeoutMs=1086) from FollowerState(fetchTimeoutMs=2000, epoch=4447, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=346402, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 12:17:15,288] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4448, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@55ef7aa3, 2=org.apache.kafka.raft.CandidateState$VoterState@1e1bdc5d, 3=org.apache.kafka.raft.CandidateState$VoterState@3f13f641}, highWatermark=Optional[LogOffsetMetadata(offset=346402, metadata=Optional.empty)], electionTimeoutMs=1086) from FollowerState(fetchTimeoutMs=2000, epoch=4447, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=346402, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 12:17:15,358] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4448, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4447, lastOffset=346403)])]) with epoch 4448 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 12:17:15,442] INFO [RaftManager id=1] Insufficient remaining votes to become leader (rejected by [2, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 12:17:15,449] INFO [RaftManager id=1] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 12:17:15,449] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4449, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7c77dc5c, 2=org.apache.kafka.raft.CandidateState$VoterState@52e39b13, 3=org.apache.kafka.raft.CandidateState$VoterState@125a5c26}, highWatermark=Optional[LogOffsetMetadata(offset=346402, metadata=Optional.empty)], electionTimeoutMs=1815) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4448, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@55ef7aa3, 2=org.apache.kafka.raft.CandidateState$VoterState@1e1bdc5d, 3=org.apache.kafka.raft.CandidateState$VoterState@3f13f641}, highWatermark=Optional[LogOffsetMetadata(offset=346402, metadata=Optional.empty)], electionTimeoutMs=1086) (org.apache.kafka.raft.QuorumState)
[2025-02-25 12:17:15,479] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4449, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7c77dc5c, 2=org.apache.kafka.raft.CandidateState$VoterState@52e39b13, 3=org.apache.kafka.raft.CandidateState$VoterState@125a5c26}, highWatermark=Optional[LogOffsetMetadata(offset=346402, metadata=Optional.empty)], electionTimeoutMs=1815) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4448, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@55ef7aa3, 2=org.apache.kafka.raft.CandidateState$VoterState@1e1bdc5d, 3=org.apache.kafka.raft.CandidateState$VoterState@3f13f641}, highWatermark=Optional[LogOffsetMetadata(offset=346402, metadata=Optional.empty)], electionTimeoutMs=1086) (org.apache.kafka.raft.QuorumState)
[2025-02-25 12:17:15,604] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), epoch=4449, epochStartOffset=346403, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4449, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7c77dc5c, 2=org.apache.kafka.raft.CandidateState$VoterState@52e39b13, 3=org.apache.kafka.raft.CandidateState$VoterState@125a5c26}, highWatermark=Optional[LogOffsetMetadata(offset=346402, metadata=Optional.empty)], electionTimeoutMs=1815) (org.apache.kafka.raft.QuorumState)
[2025-02-25 12:17:15,629] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), epoch=4449, epochStartOffset=346403, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4449, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7c77dc5c, 2=org.apache.kafka.raft.CandidateState$VoterState@52e39b13, 3=org.apache.kafka.raft.CandidateState$VoterState@125a5c26}, highWatermark=Optional[LogOffsetMetadata(offset=346402, metadata=Optional.empty)], electionTimeoutMs=1815) (org.apache.kafka.raft.QuorumState)
[2025-02-25 12:17:15,731] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 12:17:15,792] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 12:17:15,877] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 12:17:15,877] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 12:17:15,885] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=346404, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3730423)]) for the first time for epoch 4449 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=346404, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3730423)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=346404, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3730423)])], lastFetchTimestamp=1740466035885, lastCaughtUpTimestamp=1740466035885, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-25 12:17:15,929] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 12:19:35,623] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Incremented log start offset to 264312 due to snapshot generated (kafka.log.UnifiedLog)
[2025-02-25 12:19:35,654] INFO [MetadataLog partition=__cluster_metadata-0, nodeId=1] Marking snapshot OffsetAndEpoch(offset=257160, epoch=3943) for deletion because its timestamp (1739861327278) is now (1740466175618) older than the
retention (604800000) (kafka.raft.KafkaMetadataLog)
[2025-02-25 12:20:35,687] INFO Deleted snapshot files for snapshot OffsetAndEpoch(offset=257160, epoch=3943). (org.apache.kafka.snapshot.Snapshots)
[2025-02-25 12:39:28,381] INFO [RaftManager id=1] Attempting durable transition to Unattached(epoch=4450, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1499, highWatermark=Optional[LogOffsetMetadata(offset=349048, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3920689)])]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), epoch=4449, epochStartOffset=346403, highWatermark=Optional[LogOffsetMetadata(offset=349048, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3920689)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=349053, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3920866)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=349048, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3920689)])], lastFetchTimestamp=1740467365934, lastCaughtUpTimestamp=1740467365653, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=349048, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3920689)])], lastFetchTimestamp=1740467365934, lastCaughtUpTimestamp=1740467365639, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 12:39:28,528] INFO [RaftManager id=1] Completed transition to Unattached(epoch=4450, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1499, highWatermark=Optional[LogOffsetMetadata(offset=349048, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3920689)])]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), epoch=4449, epochStartOffset=346403, highWatermark=Optional[LogOffsetMetadata(offset=349048, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3920689)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=349053, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3920866)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=349048, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3920689)])], lastFetchTimestamp=1740467365934, lastCaughtUpTimestamp=1740467365653, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=349048, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3920689)])], lastFetchTimestamp=1740467365934, lastCaughtUpTimestamp=1740467365639, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 12:39:28,530] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4450, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4449, lastOffset=349049)])]) with epoch 4450 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 12:39:28,533] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4450, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4449, lastOffset=349049)])]) with epoch 4450 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 12:39:28,537] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(710859216). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 12:39:28,538] INFO [QuorumController id=1] failAll(NotControllerException): failing processBrokerHeartbeat(1603261057). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 12:39:28,540] INFO [QuorumController id=1] failAll(NotControllerException): failing processBrokerHeartbeat(591409228). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 12:39:28,541] INFO [QuorumController id=1] failAll(NotControllerException): failing processBrokerHeartbeat(2141123112). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 12:39:28,542] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(592589906). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 12:39:28,542] INFO [QuorumController id=1] failAll(NotControllerException): failing maybeFenceReplicas(48820579). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 12:39:28,542] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(545813282). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 12:39:28,542] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(672123561). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 12:39:28,543] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(441289566). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 12:39:28,543] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(1609237149). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 12:39:28,541] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 12:39:28,794] INFO [RaftManager id=1] Attempting durable transition to Unattached(epoch=4451, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1087, highWatermark=Optional[LogOffsetMetadata(offset=349048, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3920689)])]) from Unattached(epoch=4450, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1499, highWatermark=Optional[LogOffsetMetadata(offset=349048, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3920689)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 12:39:28,953] INFO [RaftManager id=1] Completed transition to Unattached(epoch=4451, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1087, highWatermark=Optional[LogOffsetMetadata(offset=349048, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3920689)])]) from Unattached(epoch=4450, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1499, highWatermark=Optional[LogOffsetMetadata(offset=349048, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3920689)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 12:39:28,954] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4451, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4449, lastOffset=349049)])]) with epoch 4451 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 12:39:29,321] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=4451, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=349048, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3920689)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=4451, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1087, highWatermark=Optional[LogOffsetMetadata(offset=349048, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3920689)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 12:39:29,449] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=4451, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=349048, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3920689)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=4451, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1087, highWatermark=Optional[LogOffsetMetadata(offset=349048, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3920689)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 12:39:29,452] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 12:39:29,465] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 12:39:29,465] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 12:39:29,516] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 12:39:29,531] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 12:39:29,531] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Truncating to offset 349049 (kafka.log.UnifiedLog)
[2025-02-25 12:39:29,533] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 12:39:29,569] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Loading producer state till offset 349049 with message format version 2 (kafka.log.UnifiedLog$)
[2025-02-25 12:39:29,570] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Reloading from producer snapshot and rebuilding producer state from offset 349049 (kafka.log.UnifiedLog$)
[2025-02-25 12:39:29,570] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=336392, file=/tmp/kafka-logs/__cluster_metadata-0/00000000000000336392.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-25 12:39:29,584] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 12:39:29,629] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 349049 with 0 producer ids in 21 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-25 12:39:29,629] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Producer state recovery took 21ms for snapshot load and 38ms for segment recovery from offset 349049 (kafka.log.UnifiedLog$)
[2025-02-25 12:39:29,629] INFO [RaftManager id=1] Truncated to offset 349049 from Fetch response from leader 3 (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 12:43:32,170] INFO [RaftManager id=1] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 12:43:32,243] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4452, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@30c1de09, 2=org.apache.kafka.raft.CandidateState$VoterState@dbb05e4, 3=org.apache.kafka.raft.CandidateState$VoterState@3980e9bc}, highWatermark=Optional[LogOffsetMetadata(offset=349527, metadata=Optional.empty)], electionTimeoutMs=1703) from FollowerState(fetchTimeoutMs=2000, epoch=4451, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=349527, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 12:43:32,434] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4452, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@30c1de09, 2=org.apache.kafka.raft.CandidateState$VoterState@dbb05e4, 3=org.apache.kafka.raft.CandidateState$VoterState@3980e9bc}, highWatermark=Optional[LogOffsetMetadata(offset=349527, metadata=Optional.empty)], electionTimeoutMs=1703) from FollowerState(fetchTimeoutMs=2000, epoch=4451, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=349527, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 12:43:32,434] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4452, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4451, lastOffset=349527)])]) with epoch 4452 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 12:43:33,161] INFO [RaftManager id=1] Insufficient remaining votes to become leader (rejected by [2, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 12:43:33,161] INFO [RaftManager id=1] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 12:43:33,162] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4453, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@6f5fd32, 2=org.apache.kafka.raft.CandidateState$VoterState@387a4a73, 3=org.apache.kafka.raft.CandidateState$VoterState@6d3bfcbd}, highWatermark=Optional[LogOffsetMetadata(offset=349527, metadata=Optional.empty)], electionTimeoutMs=1161) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4452, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@30c1de09, 2=org.apache.kafka.raft.CandidateState$VoterState@dbb05e4, 3=org.apache.kafka.raft.CandidateState$VoterState@3980e9bc}, highWatermark=Optional[LogOffsetMetadata(offset=349527, metadata=Optional.empty)], electionTimeoutMs=1703) (org.apache.kafka.raft.QuorumState)
[2025-02-25 12:43:33,226] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4453, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@6f5fd32, 2=org.apache.kafka.raft.CandidateState$VoterState@387a4a73, 3=org.apache.kafka.raft.CandidateState$VoterState@6d3bfcbd}, highWatermark=Optional[LogOffsetMetadata(offset=349527, metadata=Optional.empty)], electionTimeoutMs=1161) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4452, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@30c1de09, 2=org.apache.kafka.raft.CandidateState$VoterState@dbb05e4, 3=org.apache.kafka.raft.CandidateState$VoterState@3980e9bc}, highWatermark=Optional[LogOffsetMetadata(offset=349527, metadata=Optional.empty)], electionTimeoutMs=1703) (org.apache.kafka.raft.QuorumState)
[2025-02-25 12:43:33,416] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), epoch=4453, epochStartOffset=349528, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4453, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@6f5fd32, 2=org.apache.kafka.raft.CandidateState$VoterState@387a4a73, 3=org.apache.kafka.raft.CandidateState$VoterState@6d3bfcbd}, highWatermark=Optional[LogOffsetMetadata(offset=349527, metadata=Optional.empty)], electionTimeoutMs=1161) (org.apache.kafka.raft.QuorumState)
[2025-02-25 12:43:33,476] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), epoch=4453, epochStartOffset=349528, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4453, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@6f5fd32, 2=org.apache.kafka.raft.CandidateState$VoterState@387a4a73, 3=org.apache.kafka.raft.CandidateState$VoterState@6d3bfcbd}, highWatermark=Optional[LogOffsetMetadata(offset=349527, metadata=Optional.empty)], electionTimeoutMs=1161) (org.apache.kafka.raft.QuorumState)
[2025-02-25 12:43:33,815] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=349529, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3955267)]) for the first time for epoch 4453 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=349529, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3955267)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=349529, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=3955267)])], lastFetchTimestamp=1740467613814, lastCaughtUpTimestamp=1740467613814, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-25 12:43:34,408] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 12:43:34,409] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 12:47:40,042] INFO [NodeToControllerChannelManager id=1 name=forwarding] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
