[2025-02-13 18:08:15,658] INFO [RaftManager id=3] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-13 18:08:16,363] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3726, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@32c7614e, 2=org.apache.kafka.raft.CandidateState$VoterState@54a1ba2b, 3=org.apache.kafka.raft.CandidateState$VoterState@1d328c63}, highWatermark=Optional[LogOffsetMetadata(offset=212001, metadata=Optional.empty)], electionTimeoutMs=1426) from FollowerState(fetchTimeoutMs=2000, epoch=3725, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=212001, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-13 18:08:16,891] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3726, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@32c7614e, 2=org.apache.kafka.raft.CandidateState$VoterState@54a1ba2b, 3=org.apache.kafka.raft.CandidateState$VoterState@1d328c63}, highWatermark=Optional[LogOffsetMetadata(offset=212001, metadata=Optional.empty)], electionTimeoutMs=1426) from FollowerState(fetchTimeoutMs=2000, epoch=3725, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=212001, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-13 18:08:16,916] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3726, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3725, lastOffset=212001)])]) with epoch 3726 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-13 18:08:17,732] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-13 18:08:17,770] INFO [RaftManager id=3] Insufficient remaining votes to become leader (rejected by [1, 2]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-13 18:08:17,871] INFO [RaftManager id=3] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-13 18:08:17,872] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3727, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5f4955a3, 2=org.apache.kafka.raft.CandidateState$VoterState@560d8215, 3=org.apache.kafka.raft.CandidateState$VoterState@fa40a1d}, highWatermark=Optional[LogOffsetMetadata(offset=212001, metadata=Optional.empty)], electionTimeoutMs=1513) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3726, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@32c7614e, 2=org.apache.kafka.raft.CandidateState$VoterState@54a1ba2b, 3=org.apache.kafka.raft.CandidateState$VoterState@1d328c63}, highWatermark=Optional[LogOffsetMetadata(offset=212001, metadata=Optional.empty)], electionTimeoutMs=1426) (org.apache.kafka.raft.QuorumState)
[2025-02-13 18:08:17,892] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3727, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5f4955a3, 2=org.apache.kafka.raft.CandidateState$VoterState@560d8215, 3=org.apache.kafka.raft.CandidateState$VoterState@fa40a1d}, highWatermark=Optional[LogOffsetMetadata(offset=212001, metadata=Optional.empty)], electionTimeoutMs=1513) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3726, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@32c7614e, 2=org.apache.kafka.raft.CandidateState$VoterState@54a1ba2b, 3=org.apache.kafka.raft.CandidateState$VoterState@1d328c63}, highWatermark=Optional[LogOffsetMetadata(offset=212001, metadata=Optional.empty)], electionTimeoutMs=1426) (org.apache.kafka.raft.QuorumState)
[2025-02-13 18:08:17,908] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3727, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3725, lastOffset=212001)])]) with epoch 3727 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-13 18:08:17,928] INFO [RaftManager id=3] Insufficient remaining votes to become leader (rejected by [1, 2]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-13 18:08:18,029] INFO [RaftManager id=3] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-13 18:08:18,031] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3728, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@67cce1e, 2=org.apache.kafka.raft.CandidateState$VoterState@138d773f, 3=org.apache.kafka.raft.CandidateState$VoterState@292a5271}, highWatermark=Optional[LogOffsetMetadata(offset=212001, metadata=Optional.empty)], electionTimeoutMs=1683) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3727, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5f4955a3, 2=org.apache.kafka.raft.CandidateState$VoterState@560d8215, 3=org.apache.kafka.raft.CandidateState$VoterState@fa40a1d}, highWatermark=Optional[LogOffsetMetadata(offset=212001, metadata=Optional.empty)], electionTimeoutMs=1513) (org.apache.kafka.raft.QuorumState)
[2025-02-13 18:08:18,068] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3728, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@67cce1e, 2=org.apache.kafka.raft.CandidateState$VoterState@138d773f, 3=org.apache.kafka.raft.CandidateState$VoterState@292a5271}, highWatermark=Optional[LogOffsetMetadata(offset=212001, metadata=Optional.empty)], electionTimeoutMs=1683) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3727, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5f4955a3, 2=org.apache.kafka.raft.CandidateState$VoterState@560d8215, 3=org.apache.kafka.raft.CandidateState$VoterState@fa40a1d}, highWatermark=Optional[LogOffsetMetadata(offset=212001, metadata=Optional.empty)], electionTimeoutMs=1513) (org.apache.kafka.raft.QuorumState)
[2025-02-13 18:08:18,154] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=3728, epochStartOffset=212002, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3728, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@67cce1e, 2=org.apache.kafka.raft.CandidateState$VoterState@138d773f, 3=org.apache.kafka.raft.CandidateState$VoterState@292a5271}, highWatermark=Optional[LogOffsetMetadata(offset=212001, metadata=Optional.empty)], electionTimeoutMs=1683) (org.apache.kafka.raft.QuorumState)
[2025-02-13 18:08:18,186] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=3728, epochStartOffset=212002, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3728, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@67cce1e, 2=org.apache.kafka.raft.CandidateState$VoterState@138d773f, 3=org.apache.kafka.raft.CandidateState$VoterState@292a5271}, highWatermark=Optional[LogOffsetMetadata(offset=212001, metadata=Optional.empty)], electionTimeoutMs=1683) (org.apache.kafka.raft.QuorumState)
[2025-02-13 18:08:18,241] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 18:08:18,273] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-13 18:08:18,277] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 18:08:18,326] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 18:08:18,341] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-13 18:08:18,342] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 18:08:18,392] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 18:08:18,427] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-13 18:08:18,438] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=212003, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3892041)]) for the first time for epoch 3728 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=212003, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3892041)])], lastFetchTimestamp=1739450298437, lastCaughtUpTimestamp=1739450298437, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=212003, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3892041)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-13 18:08:18,445] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 18:08:18,497] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 18:15:24,834] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=3729, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1067, highWatermark=Optional[LogOffsetMetadata(offset=212852, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953108)])]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=3728, epochStartOffset=212002, highWatermark=Optional[LogOffsetMetadata(offset=212852, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953108)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=212846, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3952676)])], lastFetchTimestamp=1739450722094, lastCaughtUpTimestamp=1739450721625, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=212852, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953108)])], lastFetchTimestamp=1739450724669, lastCaughtUpTimestamp=1739450724669, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=212852, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953108)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-13 18:15:24,935] INFO [RaftManager id=3] Completed transition to Unattached(epoch=3729, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1067, highWatermark=Optional[LogOffsetMetadata(offset=212852, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953108)])]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=3728, epochStartOffset=212002, highWatermark=Optional[LogOffsetMetadata(offset=212852, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953108)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=212846, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3952676)])], lastFetchTimestamp=1739450722094, lastCaughtUpTimestamp=1739450721625, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=212852, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953108)])], lastFetchTimestamp=1739450724669, lastCaughtUpTimestamp=1739450724669, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=212852, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953108)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-13 18:15:24,969] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3729, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3728, lastOffset=212847)])]) with epoch 3729 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-13 18:15:25,162] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=3730, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=726, highWatermark=Optional[LogOffsetMetadata(offset=212852, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953108)])]) from Unattached(epoch=3729, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1067, highWatermark=Optional[LogOffsetMetadata(offset=212852, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953108)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-13 18:15:25,276] INFO [RaftManager id=3] Completed transition to Unattached(epoch=3730, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=726, highWatermark=Optional[LogOffsetMetadata(offset=212852, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953108)])]) from Unattached(epoch=3729, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1067, highWatermark=Optional[LogOffsetMetadata(offset=212852, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953108)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-13 18:15:25,277] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3730, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3728, lastOffset=212847)])]) with epoch 3730 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-13 18:15:25,535] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=3731, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=353, highWatermark=Optional[LogOffsetMetadata(offset=212852, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953108)])]) from Unattached(epoch=3730, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=726, highWatermark=Optional[LogOffsetMetadata(offset=212852, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953108)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-13 18:15:25,613] INFO [RaftManager id=3] Completed transition to Unattached(epoch=3731, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=353, highWatermark=Optional[LogOffsetMetadata(offset=212852, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953108)])]) from Unattached(epoch=3730, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=726, highWatermark=Optional[LogOffsetMetadata(offset=212852, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953108)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-13 18:15:25,613] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3731, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3728, lastOffset=212847)])]) with epoch 3731 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-13 18:15:25,890] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3732, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@75d2f5c2, 2=org.apache.kafka.raft.CandidateState$VoterState@72fb8859, 3=org.apache.kafka.raft.CandidateState$VoterState@7fe27efa}, highWatermark=Optional[LogOffsetMetadata(offset=212852, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953108)])], electionTimeoutMs=1064) from Unattached(epoch=3731, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=353, highWatermark=Optional[LogOffsetMetadata(offset=212852, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953108)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-13 18:15:25,953] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3732, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@75d2f5c2, 2=org.apache.kafka.raft.CandidateState$VoterState@72fb8859, 3=org.apache.kafka.raft.CandidateState$VoterState@7fe27efa}, highWatermark=Optional[LogOffsetMetadata(offset=212852, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953108)])], electionTimeoutMs=1064) from Unattached(epoch=3731, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=353, highWatermark=Optional[LogOffsetMetadata(offset=212852, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953108)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-13 18:15:26,136] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=3732, epochStartOffset=212852, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3732, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@75d2f5c2, 2=org.apache.kafka.raft.CandidateState$VoterState@72fb8859, 3=org.apache.kafka.raft.CandidateState$VoterState@7fe27efa}, highWatermark=Optional[LogOffsetMetadata(offset=212852, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953108)])], electionTimeoutMs=1064) (org.apache.kafka.raft.QuorumState)
[2025-02-13 18:15:26,196] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=3732, epochStartOffset=212852, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3732, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@75d2f5c2, 2=org.apache.kafka.raft.CandidateState$VoterState@72fb8859, 3=org.apache.kafka.raft.CandidateState$VoterState@7fe27efa}, highWatermark=Optional[LogOffsetMetadata(offset=212852, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953108)])], electionTimeoutMs=1064) (org.apache.kafka.raft.QuorumState)
[2025-02-13 18:15:26,378] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-13 18:15:26,417] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 18:15:26,445] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 18:15:26,451] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=212853, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953214)]) for the first time for epoch 3732 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=212853, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953214)])], lastFetchTimestamp=1739450726451, lastCaughtUpTimestamp=1739450726451, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=212853, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3953214)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=212847, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3952748)])], lastFetchTimestamp=1739450726388, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-13 18:19:04,781] INFO [RaftManager id=3] Disconnecting from node 2 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-02-13 18:19:04,807] INFO [RaftManager id=3] Cancelled in-flight BEGIN_QUORUM_EPOCH request with correlation id 19977 due to node 2 being disconnected (elapsed time since creation: 2853ms, elapsed time since send: 2047ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-02-13 18:19:04,887] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=3733, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1756, highWatermark=Optional[LogOffsetMetadata(offset=213280, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3983958)])]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=3732, epochStartOffset=212852, highWatermark=Optional[LogOffsetMetadata(offset=213280, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3983958)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=213280, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3983958)])], lastFetchTimestamp=1739450942861, lastCaughtUpTimestamp=1739450940900, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=213280, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3983958)])], lastFetchTimestamp=1739450942731, lastCaughtUpTimestamp=1739450940899, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=213287, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3984340)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-13 18:19:04,934] INFO [RaftManager id=3] Completed transition to Unattached(epoch=3733, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1756, highWatermark=Optional[LogOffsetMetadata(offset=213280, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3983958)])]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=3732, epochStartOffset=212852, highWatermark=Optional[LogOffsetMetadata(offset=213280, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3983958)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=213280, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3983958)])], lastFetchTimestamp=1739450942861, lastCaughtUpTimestamp=1739450940900, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=213280, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3983958)])], lastFetchTimestamp=1739450942731, lastCaughtUpTimestamp=1739450940899, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=213287, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3984340)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-13 18:19:04,934] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(686714442). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 18:19:04,934] INFO [QuorumController id=3] failAll(NotControllerException): failing maybeFenceReplicas(74346150). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 18:19:04,935] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3733, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3732, lastOffset=213280)])]) with epoch 3733 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-13 18:19:04,937] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(63595288). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 18:19:04,937] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(622062678). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 18:19:04,937] INFO [QuorumController id=3] failAll(NotControllerException): failing processBrokerHeartbeat(2127841920). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 18:19:04,938] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(163053730). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 18:19:04,938] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(1505390638). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 18:19:04,938] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(1668367891). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 18:19:04,938] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(1059946679). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 18:19:04,939] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-13 18:19:04,939] INFO [QuorumController id=3] failAll(NotControllerException): failing processBrokerHeartbeat(1985559264). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 18:19:04,939] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(2087194373). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 18:19:05,079] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=3733, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=213280, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3983958)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=3733, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1756, highWatermark=Optional[LogOffsetMetadata(offset=213280, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3983958)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-13 18:19:05,107] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=3733, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=213280, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3983958)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=3733, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1756, highWatermark=Optional[LogOffsetMetadata(offset=213280, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=3983958)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-13 18:19:05,139] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 18:19:05,177] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-13 18:19:05,178] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 18:19:05,189] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Truncating to offset 213280 (kafka.log.UnifiedLog)
[2025-02-13 18:19:05,227] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 18:19:05,230] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-13 18:19:05,230] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 18:19:05,246] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Loading producer state till offset 213280 with message format version 2 (kafka.log.UnifiedLog$)
[2025-02-13 18:19:05,250] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Reloading from producer snapshot and rebuilding producer state from offset 213280 (kafka.log.UnifiedLog$)
[2025-02-13 18:19:05,252] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=209949, file=/tmp/kafka-logs-node3/__cluster_metadata-0/00000000000000209949.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-13 18:19:05,280] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 18:19:05,289] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 213280 with 0 producer ids in 13 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-13 18:19:05,289] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Producer state recovery took 9ms for snapshot load and 30ms for segment recovery from offset 213280 (kafka.log.UnifiedLog$)
[2025-02-13 18:19:05,289] INFO [RaftManager id=3] Truncated to offset 213280 from Fetch response from leader 1 (org.apache.kafka.raft.KafkaRaftClient)
