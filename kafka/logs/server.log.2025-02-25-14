[2025-02-25 15:00:35,852] INFO [SnapshotGenerator id=1] Creating new KRaft snapshot file snapshot 00000000000000358699-0000004467 because we have waited at least 60 minute(s). (org.apache.kafka.image.publisher.SnapshotGenerator)
[2025-02-25 15:00:36,009] INFO [SnapshotEmitter id=1] Successfully wrote snapshot 00000000000000358699-0000004467 (org.apache.kafka.image.publisher.SnapshotEmitter)
[2025-02-25 15:07:49,133] INFO [RaftManager id=1] Attempting durable transition to Unattached(epoch=4468, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1307, highWatermark=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), epoch=4467, epochStartOffset=355588, highWatermark=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=359562, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676450)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])], lastFetchTimestamp=1740476269010, lastCaughtUpTimestamp=1740476266808, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])], lastFetchTimestamp=1740476269070, lastCaughtUpTimestamp=1740476266808, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 15:07:49,201] INFO [RaftManager id=1] Completed transition to Unattached(epoch=4468, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1307, highWatermark=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), epoch=4467, epochStartOffset=355588, highWatermark=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=359562, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676450)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])], lastFetchTimestamp=1740476269010, lastCaughtUpTimestamp=1740476266808, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])], lastFetchTimestamp=1740476269070, lastCaughtUpTimestamp=1740476266808, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 15:07:49,204] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(2020155262). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 15:07:49,205] INFO [QuorumController id=1] failAll(NotControllerException): failing processBrokerHeartbeat(435980858). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 15:07:49,217] INFO [QuorumController id=1] failAll(NotControllerException): failing processBrokerHeartbeat(1068913404). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 15:07:49,218] INFO [QuorumController id=1] failAll(NotControllerException): failing processBrokerHeartbeat(2108904574). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 15:07:49,219] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(1301358169). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 15:07:49,219] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(809617547). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 15:07:49,219] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(1038962125). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 15:07:49,219] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 15:07:49,232] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4468, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4467, lastOffset=359558)])]) with epoch 4468 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 15:07:49,244] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4468, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4467, lastOffset=359558)])]) with epoch 4468 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 15:07:49,428] INFO [RaftManager id=1] Attempting durable transition to Unattached(epoch=4469, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1011, highWatermark=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])]) from Unattached(epoch=4468, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1307, highWatermark=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 15:07:49,476] INFO [RaftManager id=1] Completed transition to Unattached(epoch=4469, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1011, highWatermark=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])]) from Unattached(epoch=4468, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1307, highWatermark=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 15:07:49,477] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4469, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4467, lastOffset=359558)])]) with epoch 4469 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 15:07:49,478] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4469, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4467, lastOffset=359558)])]) with epoch 4469 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 15:07:49,757] INFO [RaftManager id=1] Attempting durable transition to Unattached(epoch=4470, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=682, highWatermark=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])]) from Unattached(epoch=4469, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1011, highWatermark=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 15:07:49,799] INFO [RaftManager id=1] Completed transition to Unattached(epoch=4470, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=682, highWatermark=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])]) from Unattached(epoch=4469, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1011, highWatermark=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 15:07:49,799] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4470, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4467, lastOffset=359558)])]) with epoch 4470 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 15:07:49,800] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4470, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4467, lastOffset=359558)])]) with epoch 4470 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 15:07:49,837] INFO [RaftManager id=1] Attempting durable transition to Unattached(epoch=4471, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=602, highWatermark=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])]) from Unattached(epoch=4470, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=682, highWatermark=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 15:07:49,877] INFO [RaftManager id=1] Completed transition to Unattached(epoch=4471, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=602, highWatermark=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])]) from Unattached(epoch=4470, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=682, highWatermark=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 15:07:49,877] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4471, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4467, lastOffset=359558)])]) with epoch 4471 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 15:07:50,083] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=4471, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=4471, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=602, highWatermark=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 15:07:50,136] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=4471, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=4471, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=602, highWatermark=Optional[LogOffsetMetadata(offset=359558, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4676284)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 15:07:50,206] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Truncating to offset 359558 (kafka.log.UnifiedLog)
[2025-02-25 15:07:50,229] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 15:07:50,254] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Loading producer state till offset 359558 with message format version 2 (kafka.log.UnifiedLog$)
[2025-02-25 15:07:50,256] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Reloading from producer snapshot and rebuilding producer state from offset 359558 (kafka.log.UnifiedLog$)
[2025-02-25 15:07:50,256] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=353307, file=/tmp/kafka-logs/__cluster_metadata-0/00000000000000353307.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-25 15:07:50,322] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 359558 with 0 producer ids in 18 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-25 15:07:50,322] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Producer state recovery took 17ms for snapshot load and 49ms for segment recovery from offset 359558 (kafka.log.UnifiedLog$)
[2025-02-25 15:07:50,323] INFO [RaftManager id=1] Truncated to offset 359558 from Fetch response from leader 2 (org.apache.kafka.raft.KafkaRaftClient)
