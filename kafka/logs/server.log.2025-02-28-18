[2025-02-28 19:02:26,841] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 19:02:27,024] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8457, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3db132b, 2=org.apache.kafka.raft.CandidateState$VoterState@73cf1e0b, 3=org.apache.kafka.raft.CandidateState$VoterState@2173a16a}, highWatermark=Optional[LogOffsetMetadata(offset=563279, metadata=Optional.empty)], electionTimeoutMs=1969) from FollowerState(fetchTimeoutMs=2000, epoch=8456, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=563279, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:02:27,044] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8457, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3db132b, 2=org.apache.kafka.raft.CandidateState$VoterState@73cf1e0b, 3=org.apache.kafka.raft.CandidateState$VoterState@2173a16a}, highWatermark=Optional[LogOffsetMetadata(offset=563279, metadata=Optional.empty)], electionTimeoutMs=1969) from FollowerState(fetchTimeoutMs=2000, epoch=8456, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=563279, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:02:27,045] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=8457, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=8456, lastOffset=563280)])]) with epoch 8457 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 19:02:27,099] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 19:02:27,099] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 19:02:27,099] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8458, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@40e514d2, 2=org.apache.kafka.raft.CandidateState$VoterState@1b7c15ae, 3=org.apache.kafka.raft.CandidateState$VoterState@10c87f8c}, highWatermark=Optional[LogOffsetMetadata(offset=563279, metadata=Optional.empty)], electionTimeoutMs=1392) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8457, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3db132b, 2=org.apache.kafka.raft.CandidateState$VoterState@73cf1e0b, 3=org.apache.kafka.raft.CandidateState$VoterState@2173a16a}, highWatermark=Optional[LogOffsetMetadata(offset=563279, metadata=Optional.empty)], electionTimeoutMs=1969) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:02:27,103] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-28 19:02:27,117] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8458, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@40e514d2, 2=org.apache.kafka.raft.CandidateState$VoterState@1b7c15ae, 3=org.apache.kafka.raft.CandidateState$VoterState@10c87f8c}, highWatermark=Optional[LogOffsetMetadata(offset=563279, metadata=Optional.empty)], electionTimeoutMs=1392) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8457, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3db132b, 2=org.apache.kafka.raft.CandidateState$VoterState@73cf1e0b, 3=org.apache.kafka.raft.CandidateState$VoterState@2173a16a}, highWatermark=Optional[LogOffsetMetadata(offset=563279, metadata=Optional.empty)], electionTimeoutMs=1969) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:02:27,203] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=8458, epochStartOffset=563280, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8458, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@40e514d2, 2=org.apache.kafka.raft.CandidateState$VoterState@1b7c15ae, 3=org.apache.kafka.raft.CandidateState$VoterState@10c87f8c}, highWatermark=Optional[LogOffsetMetadata(offset=563279, metadata=Optional.empty)], electionTimeoutMs=1392) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:02:27,240] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=8458, epochStartOffset=563280, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8458, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@40e514d2, 2=org.apache.kafka.raft.CandidateState$VoterState@1b7c15ae, 3=org.apache.kafka.raft.CandidateState$VoterState@10c87f8c}, highWatermark=Optional[LogOffsetMetadata(offset=563279, metadata=Optional.empty)], electionTimeoutMs=1392) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:02:27,305] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 19:02:27,313] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-28 19:02:27,314] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 19:02:27,364] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 19:02:27,366] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-28 19:02:27,366] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 19:02:27,406] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=563281, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=19252264)]) for the first time for epoch 8458 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=563281, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=19252264)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=563281, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=19252264)])], lastFetchTimestamp=1740749547402, lastCaughtUpTimestamp=1740749547402, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=563280, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=19252158)])], lastFetchTimestamp=1740749547383, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-28 19:02:27,417] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 19:08:04,058] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Disconnecting from node 2 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-02-28 19:08:04,059] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 6701 due to node 2 being disconnected (elapsed time since creation: 4518ms, elapsed time since send: 4518ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-02-28 19:08:04,059] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 19:08:04,311] INFO [RaftManager id=2] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-02-28 19:08:04,312] INFO [RaftManager id=2] Cancelled in-flight BEGIN_QUORUM_EPOCH request with correlation id 24676 due to node 1 being disconnected (elapsed time since creation: 4853ms, elapsed time since send: 3938ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-02-28 19:08:04,964] INFO [BrokerLifecycleManager id=2] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-02-28 19:08:06,158] INFO [RaftManager id=2] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are java.util.stream.ReferencePipeline$3@5d5b2890 (org.apache.kafka.raft.LeaderState)
[2025-02-28 19:08:06,158] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=8458, voters=[1, 2, 3], electionTimeoutMs=1289, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=3, directoryId=Optional.empty), ReplicaKey(id=1, directoryId=Optional.empty)]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=8458, epochStartOffset=563280, highWatermark=Optional[LogOffsetMetadata(offset=563941, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=19299784)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=563940, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=19299712)])], lastFetchTimestamp=1740749880372, lastCaughtUpTimestamp=1740749878280, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=563953, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=19300343)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=563941, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=19299784)])], lastFetchTimestamp=1740749882296, lastCaughtUpTimestamp=1740749879454, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:08:06,485] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1565016027). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-28 19:08:06,485] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(1562443535). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-28 19:08:06,488] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(1320588477). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-28 19:08:06,489] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=8459, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1463, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=8458, voters=[1, 2, 3], electionTimeoutMs=1289, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=3, directoryId=Optional.empty), ReplicaKey(id=1, directoryId=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:08:06,500] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(898744708). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-28 19:08:06,510] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(691770890). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-28 19:08:06,511] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1941556389). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-28 19:08:06,512] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(164670739). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-28 19:08:06,515] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(855035980). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-28 19:08:06,516] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1200131038). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-28 19:08:06,516] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(2062138222). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-28 19:08:06,516] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1994205461). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-28 19:08:06,516] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1923998514). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-28 19:08:06,516] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1903706306). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-28 19:08:06,516] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1191032648). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-28 19:08:06,516] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1509407491). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-28 19:08:06,516] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1147041660). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-28 19:08:06,516] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(2006143333). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-28 19:08:06,518] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-28 19:08:06,519] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 19:08:06,569] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 19:08:06,576] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-28 19:08:06,577] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 19:08:06,637] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 19:08:06,680] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-28 19:08:06,682] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 19:08:06,696] INFO [RaftManager id=2] Completed transition to Unattached(epoch=8459, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1463, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=8458, voters=[1, 2, 3], electionTimeoutMs=1289, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=3, directoryId=Optional.empty), ReplicaKey(id=1, directoryId=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:08:06,698] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=8459, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=8458, lastOffset=563941)])]) with epoch 8459 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 19:08:06,702] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=8461, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1250, highWatermark=Optional.empty) from Unattached(epoch=8459, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1463, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:08:06,764] INFO [RaftManager id=2] Completed transition to Unattached(epoch=8461, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1250, highWatermark=Optional.empty) from Unattached(epoch=8459, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1463, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:08:06,774] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=8461, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=8458, lastOffset=563941)])]) with epoch 8461 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 19:08:07,914] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=8461, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=8461, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1250, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:08:07,990] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=8461, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=8461, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1250, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:08:07,999] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Truncating to offset 563941 (kafka.log.UnifiedLog)
[2025-02-28 19:08:08,000] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Loading producer state till offset 563941 with message format version 2 (kafka.log.UnifiedLog$)
[2025-02-28 19:08:08,000] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Reloading from producer snapshot and rebuilding producer state from offset 563941 (kafka.log.UnifiedLog$)
[2025-02-28 19:08:08,001] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=562844, file=/tmp/kafka-logs-node2/__cluster_metadata-0/00000000000000562844.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-28 19:08:08,052] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 563941 with 0 producer ids in 22 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-28 19:08:08,052] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Producer state recovery took 23ms for snapshot load and 28ms for segment recovery from offset 563941 (kafka.log.UnifiedLog$)
[2025-02-28 19:08:08,052] INFO [RaftManager id=2] Truncated to offset 563941 from Fetch response from leader 3 (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 19:08:08,054] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 19:08:08,062] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-28 19:08:08,065] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 19:08:08,115] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 19:08:08,133] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-28 19:08:08,134] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 19:08:08,184] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 19:08:08,693] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=563942, metadata=Optional.empty)] for the first time for epoch 8461 (org.apache.kafka.raft.FollowerState)
[2025-02-28 19:09:10,615] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 19:09:10,616] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8462, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@6c265f1f, 2=org.apache.kafka.raft.CandidateState$VoterState@12ea84d5, 3=org.apache.kafka.raft.CandidateState$VoterState@485f89c7}, highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)], electionTimeoutMs=1609) from FollowerState(fetchTimeoutMs=2000, epoch=8461, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:09:10,904] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8462, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@6c265f1f, 2=org.apache.kafka.raft.CandidateState$VoterState@12ea84d5, 3=org.apache.kafka.raft.CandidateState$VoterState@485f89c7}, highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)], electionTimeoutMs=1609) from FollowerState(fetchTimeoutMs=2000, epoch=8461, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:09:12,244] INFO [RaftManager id=2] Election has timed out, backing off for 100ms before becoming a candidate again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 19:09:12,344] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 19:09:12,345] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8463, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@4dea26b3, 2=org.apache.kafka.raft.CandidateState$VoterState@13ea46b6, 3=org.apache.kafka.raft.CandidateState$VoterState@5560a432}, highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)], electionTimeoutMs=1966) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8462, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@6c265f1f, 2=org.apache.kafka.raft.CandidateState$VoterState@12ea84d5, 3=org.apache.kafka.raft.CandidateState$VoterState@485f89c7}, highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)], electionTimeoutMs=1609) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:09:12,926] INFO [RaftManager id=2] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-02-28 19:09:12,926] INFO [RaftManager id=2] Cancelled in-flight VOTE request with correlation id 24806 due to node 1 being disconnected (elapsed time since creation: 2022ms, elapsed time since send: 2021ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-02-28 19:09:12,927] INFO [RaftManager id=2] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-02-28 19:09:12,927] INFO [RaftManager id=2] Cancelled in-flight FETCH request with correlation id 24805 due to node 3 being disconnected (elapsed time since creation: 2901ms, elapsed time since send: 2896ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-02-28 19:09:13,519] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-02-28 19:09:13,519] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 6748 due to node 3 being disconnected (elapsed time since creation: 4506ms, elapsed time since send: 4506ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-02-28 19:09:13,519] INFO [BrokerLifecycleManager id=2] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-02-28 19:09:13,608] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8463, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@4dea26b3, 2=org.apache.kafka.raft.CandidateState$VoterState@13ea46b6, 3=org.apache.kafka.raft.CandidateState$VoterState@5560a432}, highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)], electionTimeoutMs=1966) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8462, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@6c265f1f, 2=org.apache.kafka.raft.CandidateState$VoterState@12ea84d5, 3=org.apache.kafka.raft.CandidateState$VoterState@485f89c7}, highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)], electionTimeoutMs=1609) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:09:14,312] INFO [RaftManager id=2] Election has timed out, backing off for 200ms before becoming a candidate again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 19:09:14,515] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 19:09:14,517] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8464, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@61450ee8, 2=org.apache.kafka.raft.CandidateState$VoterState@7d0663cd, 3=org.apache.kafka.raft.CandidateState$VoterState@3c98552d}, highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)], electionTimeoutMs=1710) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8463, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@4dea26b3, 2=org.apache.kafka.raft.CandidateState$VoterState@13ea46b6, 3=org.apache.kafka.raft.CandidateState$VoterState@5560a432}, highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)], electionTimeoutMs=1966) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:09:14,666] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8464, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@61450ee8, 2=org.apache.kafka.raft.CandidateState$VoterState@7d0663cd, 3=org.apache.kafka.raft.CandidateState$VoterState@3c98552d}, highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)], electionTimeoutMs=1710) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8463, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@4dea26b3, 2=org.apache.kafka.raft.CandidateState$VoterState@13ea46b6, 3=org.apache.kafka.raft.CandidateState$VoterState@5560a432}, highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)], electionTimeoutMs=1966) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:09:15,810] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=8465, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=418, highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)]) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8464, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@61450ee8, 2=org.apache.kafka.raft.CandidateState$VoterState@7d0663cd, 3=org.apache.kafka.raft.CandidateState$VoterState@3c98552d}, highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)], electionTimeoutMs=1710) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:09:15,862] INFO [RaftManager id=2] Completed transition to Unattached(epoch=8465, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=418, highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)]) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8464, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@61450ee8, 2=org.apache.kafka.raft.CandidateState$VoterState@7d0663cd, 3=org.apache.kafka.raft.CandidateState$VoterState@3c98552d}, highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)], electionTimeoutMs=1710) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:09:15,863] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=8465, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1819, highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)]) from Unattached(epoch=8465, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=418, highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:09:15,925] INFO [RaftManager id=2] Completed transition to Unattached(epoch=8465, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1819, highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)]) from Unattached(epoch=8465, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=418, highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:09:15,925] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=8465, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=8461, lastOffset=564070)])]) with epoch 8465 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 19:09:16,144] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=8465, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=8465, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1819, highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:09:16,200] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=8465, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=8465, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1819, highWatermark=Optional[LogOffsetMetadata(offset=564059, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-28 19:09:16,220] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 19:09:16,240] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-28 19:09:16,241] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 19:09:16,292] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 19:09:16,299] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-28 19:09:16,299] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 19:09:16,353] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 19:09:16,358] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-28 19:09:16,358] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 19:09:16,408] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
