[2025-02-28 15:00:08,895] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:12,479] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8000, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@35ccd72e, 2=org.apache.kafka.raft.CandidateState$VoterState@2cf246ad, 3=org.apache.kafka.raft.CandidateState$VoterState@64376d8c}, highWatermark=Optional[LogOffsetMetadata(offset=539895, metadata=Optional.empty)], electionTimeoutMs=1930) from FollowerState(fetchTimeoutMs=2000, epoch=7999, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=539895, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:12,528] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8000, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@35ccd72e, 2=org.apache.kafka.raft.CandidateState$VoterState@2cf246ad, 3=org.apache.kafka.raft.CandidateState$VoterState@64376d8c}, highWatermark=Optional[LogOffsetMetadata(offset=539895, metadata=Optional.empty)], electionTimeoutMs=1930) from FollowerState(fetchTimeoutMs=2000, epoch=7999, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=539895, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:12,605] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-28 15:00:12,709] INFO [BrokerLifecycleManager id=2] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-02-28 15:00:12,783] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=8000, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=7999, lastOffset=539896)])]) with epoch 8000 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:12,795] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:12,889] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=8001, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1519, highWatermark=Optional[LogOffsetMetadata(offset=539895, metadata=Optional.empty)]) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8000, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@35ccd72e, 2=org.apache.kafka.raft.CandidateState$VoterState@2cf246ad, 3=org.apache.kafka.raft.CandidateState$VoterState@64376d8c}, highWatermark=Optional[LogOffsetMetadata(offset=539895, metadata=Optional.empty)], electionTimeoutMs=1930) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:12,937] INFO [RaftManager id=2] Completed transition to Unattached(epoch=8001, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1519, highWatermark=Optional[LogOffsetMetadata(offset=539895, metadata=Optional.empty)]) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8000, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@35ccd72e, 2=org.apache.kafka.raft.CandidateState$VoterState@2cf246ad, 3=org.apache.kafka.raft.CandidateState$VoterState@64376d8c}, highWatermark=Optional[LogOffsetMetadata(offset=539895, metadata=Optional.empty)], electionTimeoutMs=1930) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:12,938] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=8001, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1899, highWatermark=Optional[LogOffsetMetadata(offset=539895, metadata=Optional.empty)]) from Unattached(epoch=8001, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1519, highWatermark=Optional[LogOffsetMetadata(offset=539895, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:12,995] INFO [RaftManager id=2] Completed transition to Unattached(epoch=8001, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1899, highWatermark=Optional[LogOffsetMetadata(offset=539895, metadata=Optional.empty)]) from Unattached(epoch=8001, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1519, highWatermark=Optional[LogOffsetMetadata(offset=539895, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:12,995] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=8001, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=7999, lastOffset=539896)])]) with epoch 8001 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:13,286] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=8001, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=539895, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=8001, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1899, highWatermark=Optional[LogOffsetMetadata(offset=539895, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:13,392] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=8001, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=539895, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=8001, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1899, highWatermark=Optional[LogOffsetMetadata(offset=539895, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:13,430] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:13,502] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-28 15:00:13,504] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:13,563] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:13,570] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-28 15:00:13,570] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:13,621] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:13,639] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-28 15:00:13,639] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:13,690] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.64.134:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:28,952] INFO Terminating process due to signal SIGTERM (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-02-28 15:00:28,952] INFO Terminating process due to signal SIGTERM (org.apache.kafka.common.utils.LoggingSignalHandler)
[2025-02-28 15:00:29,143] INFO [BrokerServer id=2] Transition from STARTED to SHUTTING_DOWN (kafka.server.BrokerServer)
[2025-02-28 15:00:29,154] INFO [BrokerServer id=2] shutting down (kafka.server.BrokerServer)
[2025-02-28 15:00:29,303] INFO [BrokerLifecycleManager id=2] Beginning controlled shutdown. (kafka.server.BrokerLifecycleManager)
[2025-02-28 15:00:29,541] INFO [BrokerLifecycleManager id=2] The broker is in PENDING_CONTROLLED_SHUTDOWN state, still waiting for the active controller. (kafka.server.BrokerLifecycleManager)
[2025-02-28 15:00:29,597] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions Set(kraft-test-0, kraft-test-1, kraft-test-2) (kafka.server.ReplicaFetcherManager)
[2025-02-28 15:00:32,127] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:32,199] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8002, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@78d3f389, 2=org.apache.kafka.raft.CandidateState$VoterState@19a30c2, 3=org.apache.kafka.raft.CandidateState$VoterState@4a729c0a}, highWatermark=Optional[LogOffsetMetadata(offset=539993, metadata=Optional.empty)], electionTimeoutMs=1880) from FollowerState(fetchTimeoutMs=2000, epoch=8001, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=539993, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:32,300] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8002, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@78d3f389, 2=org.apache.kafka.raft.CandidateState$VoterState@19a30c2, 3=org.apache.kafka.raft.CandidateState$VoterState@4a729c0a}, highWatermark=Optional[LogOffsetMetadata(offset=539993, metadata=Optional.empty)], electionTimeoutMs=1880) from FollowerState(fetchTimeoutMs=2000, epoch=8001, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=539993, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:32,304] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=8002, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=8001, lastOffset=539994)])]) with epoch 8002 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:32,371] INFO [BrokerLifecycleManager id=2] The controller has asked us to exit controlled shutdown. (kafka.server.BrokerLifecycleManager)
[2025-02-28 15:00:32,371] INFO [BrokerLifecycleManager id=2] beginShutdown: shutting down event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-02-28 15:00:32,377] INFO [BrokerLifecycleManager id=2] Transitioning from PENDING_CONTROLLED_SHUTDOWN to SHUTTING_DOWN. (kafka.server.BrokerLifecycleManager)
[2025-02-28 15:00:32,378] INFO [broker-2-to-controller-heartbeat-channel-manager]: Shutting down (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:32,380] INFO [broker-2-to-controller-heartbeat-channel-manager]: Stopped (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:32,381] INFO [broker-2-to-controller-heartbeat-channel-manager]: Shutdown completed (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:32,462] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions HashSet(__consumer_offsets-4, __consumer_offsets-28, kraft-test-2, demo-1, __consumer_offsets-2, __consumer_offsets-34, __consumer_offsets-10, __consumer_offsets-7, __consumer_offsets-46, __consumer_offsets-23, __consumer_offsets-49, __consumer_offsets-31, __consumer_offsets-36, kraft-test-0, __consumer_offsets-15, __consumer_offsets-24, __consumer_offsets-20, __consumer_offsets-44, __consumer_offsets-39, __consumer_offsets-12, kraft-test-1) (kafka.server.ReplicaFetcherManager)
[2025-02-28 15:00:32,464] INFO [ReplicaAlterLogDirsManager on broker 2] Removed fetcher for partitions HashSet(__consumer_offsets-4, __consumer_offsets-28, kraft-test-2, demo-1, __consumer_offsets-2, __consumer_offsets-34, __consumer_offsets-10, __consumer_offsets-7, __consumer_offsets-46, __consumer_offsets-23, __consumer_offsets-49, __consumer_offsets-31, __consumer_offsets-36, kraft-test-0, __consumer_offsets-15, __consumer_offsets-24, __consumer_offsets-20, __consumer_offsets-44, __consumer_offsets-39, __consumer_offsets-12, kraft-test-1) (kafka.server.ReplicaAlterLogDirsManager)
[2025-02-28 15:00:32,489] INFO [SocketServer listenerType=BROKER, nodeId=2] Stopping socket server request processors (kafka.network.SocketServer)
[2025-02-28 15:00:32,490] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:32,494] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:32,494] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8003, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@221661cd, 2=org.apache.kafka.raft.CandidateState$VoterState@453e81bd, 3=org.apache.kafka.raft.CandidateState$VoterState@1572a5f8}, highWatermark=Optional[LogOffsetMetadata(offset=539993, metadata=Optional.empty)], electionTimeoutMs=1496) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8002, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@78d3f389, 2=org.apache.kafka.raft.CandidateState$VoterState@19a30c2, 3=org.apache.kafka.raft.CandidateState$VoterState@4a729c0a}, highWatermark=Optional[LogOffsetMetadata(offset=539993, metadata=Optional.empty)], electionTimeoutMs=1880) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:32,638] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8003, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@221661cd, 2=org.apache.kafka.raft.CandidateState$VoterState@453e81bd, 3=org.apache.kafka.raft.CandidateState$VoterState@1572a5f8}, highWatermark=Optional[LogOffsetMetadata(offset=539993, metadata=Optional.empty)], electionTimeoutMs=1496) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8002, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@78d3f389, 2=org.apache.kafka.raft.CandidateState$VoterState@19a30c2, 3=org.apache.kafka.raft.CandidateState$VoterState@4a729c0a}, highWatermark=Optional[LogOffsetMetadata(offset=539993, metadata=Optional.empty)], electionTimeoutMs=1880) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:32,639] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=8003, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=8001, lastOffset=539994)])]) with epoch 8003 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:32,709] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:32,751] INFO Node to controller channel manager for heartbeat shutdown (kafka.server.NodeToControllerChannelManagerImpl)
[2025-02-28 15:00:32,814] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:32,817] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8004, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@4bbee990, 2=org.apache.kafka.raft.CandidateState$VoterState@5ab7e123, 3=org.apache.kafka.raft.CandidateState$VoterState@6bb5a0a1}, highWatermark=Optional[LogOffsetMetadata(offset=539993, metadata=Optional.empty)], electionTimeoutMs=1473) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8003, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@221661cd, 2=org.apache.kafka.raft.CandidateState$VoterState@453e81bd, 3=org.apache.kafka.raft.CandidateState$VoterState@1572a5f8}, highWatermark=Optional[LogOffsetMetadata(offset=539993, metadata=Optional.empty)], electionTimeoutMs=1496) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:32,822] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 15 in epoch OptionalInt[77] (kafka.coordinator.group.GroupCoordinator)
[2025-02-28 15:00:32,850] INFO [SocketServer listenerType=BROKER, nodeId=2] Stopped socket server request processors (kafka.network.SocketServer)
[2025-02-28 15:00:32,862] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-15 (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,863] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 46 in epoch OptionalInt[77] (kafka.coordinator.group.GroupCoordinator)
[2025-02-28 15:00:32,863] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-46 (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,863] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 12 in epoch OptionalInt[77] (kafka.coordinator.group.GroupCoordinator)
[2025-02-28 15:00:32,863] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-12 (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,863] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 44 in epoch OptionalInt[77] (kafka.coordinator.group.GroupCoordinator)
[2025-02-28 15:00:32,863] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-44 (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,863] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 10 in epoch OptionalInt[77] (kafka.coordinator.group.GroupCoordinator)
[2025-02-28 15:00:32,863] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-10 (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,866] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 23 in epoch OptionalInt[77] (kafka.coordinator.group.GroupCoordinator)
[2025-02-28 15:00:32,866] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-23 (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,866] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 24 in epoch OptionalInt[77] (kafka.coordinator.group.GroupCoordinator)
[2025-02-28 15:00:32,873] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-24 (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,873] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 20 in epoch OptionalInt[77] (kafka.coordinator.group.GroupCoordinator)
[2025-02-28 15:00:32,873] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-20 (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,873] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 49 in epoch OptionalInt[77] (kafka.coordinator.group.GroupCoordinator)
[2025-02-28 15:00:32,873] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-49 (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,873] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 31 in epoch OptionalInt[77] (kafka.coordinator.group.GroupCoordinator)
[2025-02-28 15:00:32,873] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-31 (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,873] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 28 in epoch OptionalInt[77] (kafka.coordinator.group.GroupCoordinator)
[2025-02-28 15:00:32,873] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-28 (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,873] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 7 in epoch OptionalInt[77] (kafka.coordinator.group.GroupCoordinator)
[2025-02-28 15:00:32,873] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-7 (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,873] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 39 in epoch OptionalInt[77] (kafka.coordinator.group.GroupCoordinator)
[2025-02-28 15:00:32,873] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-39 (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,873] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 4 in epoch OptionalInt[77] (kafka.coordinator.group.GroupCoordinator)
[2025-02-28 15:00:32,873] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-4 (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,873] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 36 in epoch OptionalInt[77] (kafka.coordinator.group.GroupCoordinator)
[2025-02-28 15:00:32,874] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-36 (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,865] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8004, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@4bbee990, 2=org.apache.kafka.raft.CandidateState$VoterState@5ab7e123, 3=org.apache.kafka.raft.CandidateState$VoterState@6bb5a0a1}, highWatermark=Optional[LogOffsetMetadata(offset=539993, metadata=Optional.empty)], electionTimeoutMs=1473) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8003, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@221661cd, 2=org.apache.kafka.raft.CandidateState$VoterState@453e81bd, 3=org.apache.kafka.raft.CandidateState$VoterState@1572a5f8}, highWatermark=Optional[LogOffsetMetadata(offset=539993, metadata=Optional.empty)], electionTimeoutMs=1496) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:32,878] INFO [GroupCoordinator 2]: Unloading group metadata for demo-group with generation 10 (kafka.coordinator.group.GroupCoordinator)
[2025-02-28 15:00:32,893] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 2 in epoch OptionalInt[77] (kafka.coordinator.group.GroupCoordinator)
[2025-02-28 15:00:32,894] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-2 (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,894] INFO [GroupCoordinator 2]: Resigned as the group coordinator for partition 34 in epoch OptionalInt[77] (kafka.coordinator.group.GroupCoordinator)
[2025-02-28 15:00:32,894] INFO [GroupMetadataManager brokerId=2] Scheduling unloading of offsets and group metadata from __consumer_offsets-34 (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,957] INFO [data-plane Kafka Request Handler on Broker 2], shutting down (kafka.server.KafkaRequestHandlerPool)
[2025-02-28 15:00:32,979] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-15 for coordinator epoch OptionalInt[77]. Removed 3 cached offsets and 1 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,980] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-46 for coordinator epoch OptionalInt[77]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,980] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-12 for coordinator epoch OptionalInt[77]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,980] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-44 for coordinator epoch OptionalInt[77]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,980] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-10 for coordinator epoch OptionalInt[77]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,980] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-23 for coordinator epoch OptionalInt[77]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,980] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-24 for coordinator epoch OptionalInt[77]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,980] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-20 for coordinator epoch OptionalInt[77]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,980] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-49 for coordinator epoch OptionalInt[77]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,980] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-31 for coordinator epoch OptionalInt[77]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:32,980] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-28 for coordinator epoch OptionalInt[77]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:33,004] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-7 for coordinator epoch OptionalInt[77]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:33,009] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-39 for coordinator epoch OptionalInt[77]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:33,010] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-4 for coordinator epoch OptionalInt[77]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:33,012] INFO [GroupCoordinator 2]: Unloading group metadata for kraft-group with generation 201 (kafka.coordinator.group.GroupCoordinator)
[2025-02-28 15:00:33,028] INFO [data-plane Kafka Request Handler on Broker 2], shut down completely (kafka.server.KafkaRequestHandlerPool)
[2025-02-28 15:00:33,063] INFO [ExpirationReaper-2-AlterAcls]: Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:33,088] INFO [ExpirationReaper-2-AlterAcls]: Stopped (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:33,090] INFO [ExpirationReaper-2-AlterAcls]: Shutdown completed (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:33,099] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-36 for coordinator epoch OptionalInt[77]. Removed 3 cached offsets and 1 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:33,145] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-2 for coordinator epoch OptionalInt[77]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:33,149] INFO [GroupMetadataManager brokerId=2] Finished unloading __consumer_offsets-34 for coordinator epoch OptionalInt[77]. Removed 0 cached offsets and 0 cached groups. (kafka.coordinator.group.GroupMetadataManager)
[2025-02-28 15:00:33,163] INFO [KafkaApi-2] Shutdown complete. (kafka.server.KafkaApis)
[2025-02-28 15:00:33,247] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=8004, epochStartOffset=539994, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8004, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@4bbee990, 2=org.apache.kafka.raft.CandidateState$VoterState@5ab7e123, 3=org.apache.kafka.raft.CandidateState$VoterState@6bb5a0a1}, highWatermark=Optional[LogOffsetMetadata(offset=539993, metadata=Optional.empty)], electionTimeoutMs=1473) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:33,274] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=8004, epochStartOffset=539994, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8004, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@4bbee990, 2=org.apache.kafka.raft.CandidateState$VoterState@5ab7e123, 3=org.apache.kafka.raft.CandidateState$VoterState@6bb5a0a1}, highWatermark=Optional[LogOffsetMetadata(offset=539993, metadata=Optional.empty)], electionTimeoutMs=1473) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:33,282] INFO [TransactionCoordinator id=2] Shutting down. (kafka.coordinator.transaction.TransactionCoordinator)
[2025-02-28 15:00:33,312] INFO [Transaction State Manager 2]: Shutdown complete (kafka.coordinator.transaction.TransactionStateManager)
[2025-02-28 15:00:33,314] INFO [TxnMarkerSenderThread-2]: Shutting down (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2025-02-28 15:00:33,315] INFO [TxnMarkerSenderThread-2]: Stopped (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2025-02-28 15:00:33,315] INFO [TxnMarkerSenderThread-2]: Shutdown completed (kafka.coordinator.transaction.TransactionMarkerChannelManager)
[2025-02-28 15:00:36,576] INFO [TransactionCoordinator id=2] Shutdown complete. (kafka.coordinator.transaction.TransactionCoordinator)
[2025-02-28 15:00:36,577] INFO [GroupCoordinator 2]: Shutting down. (kafka.coordinator.group.GroupCoordinator)
[2025-02-28 15:00:36,682] INFO [ExpirationReaper-2-Heartbeat]: Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:36,684] INFO [ExpirationReaper-2-Heartbeat]: Stopped (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:36,686] INFO [ExpirationReaper-2-Heartbeat]: Shutdown completed (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:36,689] INFO [ExpirationReaper-2-Rebalance]: Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:36,702] INFO [ExpirationReaper-2-Rebalance]: Stopped (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:36,706] INFO [ExpirationReaper-2-Rebalance]: Shutdown completed (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:36,709] INFO [GroupCoordinator 2]: Shutdown complete. (kafka.coordinator.group.GroupCoordinator)
[2025-02-28 15:00:37,459] INFO [AssignmentsManager id=2]KafkaEventQueue#close: shutting down event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-02-28 15:00:37,479] INFO [RaftManager id=2] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are java.util.stream.ReferencePipeline$3@4f5e4cd8 (org.apache.kafka.raft.LeaderState)
[2025-02-28 15:00:37,704] INFO [AssignmentsManager id=2] shutting down. (org.apache.kafka.server.AssignmentsManager)
[2025-02-28 15:00:37,707] INFO [broker-2-to-controller-directory-assignments-channel-manager]: Shutting down (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:37,714] INFO [broker-2-to-controller-directory-assignments-channel-manager]: Stopped (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:37,714] INFO [broker-2-to-controller-directory-assignments-channel-manager]: Shutdown completed (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:37,716] INFO Node to controller channel manager for directory-assignments shutdown (kafka.server.NodeToControllerChannelManagerImpl)
[2025-02-28 15:00:37,716] INFO [AssignmentsManager id=2]closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-02-28 15:00:37,721] INFO [ReplicaManager broker=2] Shutting down (kafka.server.ReplicaManager)
[2025-02-28 15:00:37,758] INFO [LogDirFailureHandler]: Shutting down (kafka.server.ReplicaManager$LogDirFailureHandler)
[2025-02-28 15:00:37,766] INFO [LogDirFailureHandler]: Stopped (kafka.server.ReplicaManager$LogDirFailureHandler)
[2025-02-28 15:00:37,770] INFO [LogDirFailureHandler]: Shutdown completed (kafka.server.ReplicaManager$LogDirFailureHandler)
[2025-02-28 15:00:37,781] INFO [ReplicaFetcherManager on broker 2] shutting down (kafka.server.ReplicaFetcherManager)
[2025-02-28 15:00:37,808] INFO [ReplicaFetcherManager on broker 2] shutdown completed (kafka.server.ReplicaFetcherManager)
[2025-02-28 15:00:37,828] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=8004, voters=[1, 2, 3], electionTimeoutMs=1291, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=3, directoryId=Optional.empty)]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=8004, epochStartOffset=539994, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:37,829] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=8006, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1822, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=8004, voters=[1, 2, 3], electionTimeoutMs=1291, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=3, directoryId=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:37,838] INFO [ReplicaAlterLogDirsManager on broker 2] shutting down (kafka.server.ReplicaAlterLogDirsManager)
[2025-02-28 15:00:37,839] INFO [ReplicaAlterLogDirsManager on broker 2] shutdown completed (kafka.server.ReplicaAlterLogDirsManager)
[2025-02-28 15:00:37,839] INFO [ExpirationReaper-2-Fetch]: Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:37,839] INFO [ExpirationReaper-2-Fetch]: Stopped (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:37,839] INFO [ExpirationReaper-2-Fetch]: Shutdown completed (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:37,843] INFO [ExpirationReaper-2-RemoteFetch]: Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:37,862] INFO [ExpirationReaper-2-RemoteFetch]: Stopped (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:37,862] INFO [ExpirationReaper-2-RemoteFetch]: Shutdown completed (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:37,863] INFO [ExpirationReaper-2-Produce]: Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:37,867] INFO [ExpirationReaper-2-Produce]: Stopped (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:37,868] INFO [ExpirationReaper-2-Produce]: Shutdown completed (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:37,870] INFO [ExpirationReaper-2-DeleteRecords]: Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:37,872] INFO [ExpirationReaper-2-DeleteRecords]: Stopped (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:37,872] INFO [ExpirationReaper-2-DeleteRecords]: Shutdown completed (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:37,872] INFO [ExpirationReaper-2-ElectLeader]: Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:37,911] INFO [ExpirationReaper-2-ElectLeader]: Stopped (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:37,911] INFO [ExpirationReaper-2-ElectLeader]: Shutdown completed (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:37,968] INFO [RaftManager id=2] Completed transition to Unattached(epoch=8006, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1822, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=8004, voters=[1, 2, 3], electionTimeoutMs=1291, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=3, directoryId=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:37,990] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=8006, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=8001, lastOffset=539994)])]) with epoch 8006 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:38,262] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=8007, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1389, highWatermark=Optional.empty) from Unattached(epoch=8006, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1822, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:38,499] INFO [RaftManager id=2] Completed transition to Unattached(epoch=8007, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1389, highWatermark=Optional.empty) from Unattached(epoch=8006, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1822, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:38,503] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=8007, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=8001, lastOffset=539994)])]) with epoch 8007 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:38,576] INFO [AddPartitionsToTxnSenderThread-2]: Shutting down (kafka.server.AddPartitionsToTxnManager)
[2025-02-28 15:00:38,589] INFO [AddPartitionsToTxnSenderThread-2]: Stopped (kafka.server.AddPartitionsToTxnManager)
[2025-02-28 15:00:38,590] INFO [AddPartitionsToTxnSenderThread-2]: Shutdown completed (kafka.server.AddPartitionsToTxnManager)
[2025-02-28 15:00:38,615] INFO [ReplicaManager broker=2] Shut down completely (kafka.server.ReplicaManager)
[2025-02-28 15:00:38,660] INFO [broker-2-to-controller-alter-partition-channel-manager]: Shutting down (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:38,661] INFO [broker-2-to-controller-alter-partition-channel-manager]: Stopped (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:38,661] INFO [broker-2-to-controller-alter-partition-channel-manager]: Shutdown completed (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:38,663] INFO Node to controller channel manager for alter-partition shutdown (kafka.server.NodeToControllerChannelManagerImpl)
[2025-02-28 15:00:38,784] INFO [broker-2-to-controller-forwarding-channel-manager]: Shutting down (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:38,785] INFO [broker-2-to-controller-forwarding-channel-manager]: Stopped (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:38,785] INFO [broker-2-to-controller-forwarding-channel-manager]: Shutdown completed (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:38,799] INFO Node to controller channel manager for forwarding shutdown (kafka.server.NodeToControllerChannelManagerImpl)
[2025-02-28 15:00:39,021] INFO Shutting down. (kafka.log.LogManager)
[2025-02-28 15:00:39,115] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=8008, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=535, highWatermark=Optional.empty) from Unattached(epoch=8007, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1389, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:39,280] INFO [kafka-log-cleaner-thread-0]: Shutting down (kafka.log.LogCleaner$CleanerThread)
[2025-02-28 15:00:39,281] INFO [kafka-log-cleaner-thread-0]: Stopped (kafka.log.LogCleaner$CleanerThread)
[2025-02-28 15:00:39,282] INFO [kafka-log-cleaner-thread-0]: Shutdown completed (kafka.log.LogCleaner$CleanerThread)
[2025-02-28 15:00:39,438] INFO [RaftManager id=2] Completed transition to Unattached(epoch=8008, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=535, highWatermark=Optional.empty) from Unattached(epoch=8007, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1389, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:39,442] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=8008, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=8001, lastOffset=539994)])]) with epoch 8008 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:39,449] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=8008, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=8001, lastOffset=540000)])]) with epoch 8008 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:39,651] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8009, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@56c30331, 2=org.apache.kafka.raft.CandidateState$VoterState@3ba5a8b2, 3=org.apache.kafka.raft.CandidateState$VoterState@5edecf72}, highWatermark=Optional.empty, electionTimeoutMs=1483) from Unattached(epoch=8008, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=535, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:39,974] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8009, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@56c30331, 2=org.apache.kafka.raft.CandidateState$VoterState@3ba5a8b2, 3=org.apache.kafka.raft.CandidateState$VoterState@5edecf72}, highWatermark=Optional.empty, electionTimeoutMs=1483) from Unattached(epoch=8008, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=535, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:39,997] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=8009, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=8001, lastOffset=539994)])]) with epoch 8009 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:40,174] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:40,190] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=8009, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=8001, lastOffset=540000)])]) with epoch 8009 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:40,273] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:40,273] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8010, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7b6ff222, 2=org.apache.kafka.raft.CandidateState$VoterState@35fbacf5, 3=org.apache.kafka.raft.CandidateState$VoterState@230d72c0}, highWatermark=Optional.empty, electionTimeoutMs=1451) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8009, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@56c30331, 2=org.apache.kafka.raft.CandidateState$VoterState@3ba5a8b2, 3=org.apache.kafka.raft.CandidateState$VoterState@5edecf72}, highWatermark=Optional.empty, electionTimeoutMs=1483) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:40,350] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8010, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7b6ff222, 2=org.apache.kafka.raft.CandidateState$VoterState@35fbacf5, 3=org.apache.kafka.raft.CandidateState$VoterState@230d72c0}, highWatermark=Optional.empty, electionTimeoutMs=1451) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8009, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@56c30331, 2=org.apache.kafka.raft.CandidateState$VoterState@3ba5a8b2, 3=org.apache.kafka.raft.CandidateState$VoterState@5edecf72}, highWatermark=Optional.empty, electionTimeoutMs=1483) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:40,370] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=8010, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=8001, lastOffset=540000)])]) with epoch 8010 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:40,505] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:40,704] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:40,704] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8011, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@b008c8c, 2=org.apache.kafka.raft.CandidateState$VoterState@ffa812c, 3=org.apache.kafka.raft.CandidateState$VoterState@678e0822}, highWatermark=Optional.empty, electionTimeoutMs=1666) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8010, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7b6ff222, 2=org.apache.kafka.raft.CandidateState$VoterState@35fbacf5, 3=org.apache.kafka.raft.CandidateState$VoterState@230d72c0}, highWatermark=Optional.empty, electionTimeoutMs=1451) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:40,775] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8011, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@b008c8c, 2=org.apache.kafka.raft.CandidateState$VoterState@ffa812c, 3=org.apache.kafka.raft.CandidateState$VoterState@678e0822}, highWatermark=Optional.empty, electionTimeoutMs=1666) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8010, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7b6ff222, 2=org.apache.kafka.raft.CandidateState$VoterState@35fbacf5, 3=org.apache.kafka.raft.CandidateState$VoterState@230d72c0}, highWatermark=Optional.empty, electionTimeoutMs=1451) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:41,086] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=8011, epochStartOffset=539994, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8011, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@b008c8c, 2=org.apache.kafka.raft.CandidateState$VoterState@ffa812c, 3=org.apache.kafka.raft.CandidateState$VoterState@678e0822}, highWatermark=Optional.empty, electionTimeoutMs=1666) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:41,198] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=8011, epochStartOffset=539994, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=8011, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@b008c8c, 2=org.apache.kafka.raft.CandidateState$VoterState@ffa812c, 3=org.apache.kafka.raft.CandidateState$VoterState@678e0822}, highWatermark=Optional.empty, electionTimeoutMs=1666) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:41,576] INFO [ProducerStateManager partition=kraft-test-0] Wrote producer snapshot at offset 3250 with 60 producer ids in 121 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-28 15:00:41,807] INFO [ProducerStateManager partition=__consumer_offsets-15] Wrote producer snapshot at offset 5572 with 0 producer ids in 37 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-28 15:00:42,138] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=539995, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=17578721)]) for the first time for epoch 8011 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=539995, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=17578721)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=539995, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=17578721)])], lastFetchTimestamp=1740735042137, lastCaughtUpTimestamp=1740735042137, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-28 15:00:44,684] INFO Shutdown complete. (kafka.log.LogManager)
[2025-02-28 15:00:44,701] INFO [broker-2-ThrottledChannelReaper-Fetch]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:44,707] INFO [broker-2-ThrottledChannelReaper-Fetch]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:44,707] INFO [broker-2-ThrottledChannelReaper-Fetch]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:44,707] INFO [broker-2-ThrottledChannelReaper-Produce]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:44,708] INFO [broker-2-ThrottledChannelReaper-Produce]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:44,708] INFO [broker-2-ThrottledChannelReaper-Produce]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:44,708] INFO [broker-2-ThrottledChannelReaper-Request]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:44,709] INFO [broker-2-ThrottledChannelReaper-Request]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:44,709] INFO [broker-2-ThrottledChannelReaper-Request]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:44,711] INFO [broker-2-ThrottledChannelReaper-ControllerMutation]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:44,711] INFO [broker-2-ThrottledChannelReaper-ControllerMutation]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:44,711] INFO [broker-2-ThrottledChannelReaper-ControllerMutation]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:44,713] INFO [SocketServer listenerType=BROKER, nodeId=2] Shutting down socket server (kafka.network.SocketServer)
[2025-02-28 15:00:44,799] INFO [SocketServer listenerType=BROKER, nodeId=2] Shutdown completed (kafka.network.SocketServer)
[2025-02-28 15:00:44,803] INFO Broker and topic stats closed (kafka.server.BrokerTopicStats)
[2025-02-28 15:00:44,805] INFO [BrokerLifecycleManager id=2] closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-02-28 15:00:44,842] INFO [client-metrics-reaper]: Shutting down (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-02-28 15:00:44,849] INFO [client-metrics-reaper]: Stopped (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-02-28 15:00:44,849] INFO [client-metrics-reaper]: Shutdown completed (org.apache.kafka.server.util.timer.SystemTimerReaper$Reaper)
[2025-02-28 15:00:44,852] INFO [BrokerServer id=2] shut down completed (kafka.server.BrokerServer)
[2025-02-28 15:00:44,852] INFO [BrokerServer id=2] Transition from SHUTTING_DOWN to SHUTDOWN (kafka.server.BrokerServer)
[2025-02-28 15:00:44,894] INFO [ControllerServer id=2] shutting down (kafka.server.ControllerServer)
[2025-02-28 15:00:44,933] INFO [raft-expiration-reaper]: Shutting down (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2025-02-28 15:00:45,018] INFO [raft-expiration-reaper]: Stopped (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2025-02-28 15:00:45,022] INFO [raft-expiration-reaper]: Shutdown completed (kafka.raft.TimingWheelExpirationService$ExpiredOperationReaper)
[2025-02-28 15:00:45,049] INFO [kafka-2-raft-io-thread]: Shutting down (org.apache.kafka.raft.KafkaRaftClientDriver)
[2025-02-28 15:00:45,063] INFO [RaftManager id=2] Beginning graceful shutdown (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:45,092] INFO [RaftManager id=2] Failed to handle fetch from ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]) at 540000 due to NOT_LEADER_OR_FOLLOWER (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:45,132] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=8011, voters=[1, 2, 3], electionTimeoutMs=1453, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=3, directoryId=Optional.empty)]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=8011, epochStartOffset=539994, highWatermark=Optional[LogOffsetMetadata(offset=540000, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=17579050)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=540000, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=17579050)])], lastFetchTimestamp=1740735045082, lastCaughtUpTimestamp=1740735045082, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=540000, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=17579050)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=539999, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=17578978)])], lastFetchTimestamp=1740735044988, lastCaughtUpTimestamp=1740735044559, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:45,245] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=8012, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1159, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=8011, voters=[1, 2, 3], electionTimeoutMs=1453, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=3, directoryId=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:45,270] INFO [RaftManager id=2] Completed transition to Unattached(epoch=8012, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1159, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=8011, voters=[1, 2, 3], electionTimeoutMs=1453, unackedVoters=[], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=3, directoryId=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:45,271] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=8012, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1335, highWatermark=Optional.empty) from Unattached(epoch=8012, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1159, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:45,297] INFO [RaftManager id=2] Completed transition to Unattached(epoch=8012, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1335, highWatermark=Optional.empty) from Unattached(epoch=8012, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1159, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:45,297] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=8012, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=8011, lastOffset=540000)])]) with epoch 8012 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:45,420] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=8012, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=8012, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1335, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:45,454] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=8012, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=8012, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1335, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-28 15:00:45,454] INFO [RaftManager id=2] Graceful shutdown completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-28 15:00:45,454] INFO [RaftManager id=2] Completed graceful shutdown of RaftClient (org.apache.kafka.raft.KafkaRaftClientDriver)
[2025-02-28 15:00:45,454] INFO [kafka-2-raft-io-thread]: Shutdown completed (org.apache.kafka.raft.KafkaRaftClientDriver)
[2025-02-28 15:00:45,454] INFO [kafka-2-raft-io-thread]: Stopped (org.apache.kafka.raft.KafkaRaftClientDriver)
[2025-02-28 15:00:45,530] INFO [kafka-2-raft-outbound-request-thread]: Shutting down (org.apache.kafka.raft.KafkaNetworkChannel$SendThread)
[2025-02-28 15:00:45,530] INFO [kafka-2-raft-outbound-request-thread]: Stopped (org.apache.kafka.raft.KafkaNetworkChannel$SendThread)
[2025-02-28 15:00:45,530] INFO [kafka-2-raft-outbound-request-thread]: Shutdown completed (org.apache.kafka.raft.KafkaNetworkChannel$SendThread)
[2025-02-28 15:00:45,584] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 540000 with 0 producer ids in 39 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-28 15:00:45,765] INFO [ControllerRegistrationManager id=2 incarnation=ZV5EUKoVQh-lwUgtiAW7JA] beginShutdown: shutting down event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-02-28 15:00:45,790] INFO [ControllerRegistrationManager id=2 incarnation=ZV5EUKoVQh-lwUgtiAW7JA] shutting down. (kafka.server.ControllerRegistrationManager)
[2025-02-28 15:00:45,790] INFO [controller-2-to-controller-registration-channel-manager]: Shutting down (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:45,790] INFO [controller-2-to-controller-registration-channel-manager]: Stopped (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:45,790] INFO [controller-2-to-controller-registration-channel-manager]: Shutdown completed (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:45,791] INFO Node to controller channel manager for registration shutdown (kafka.server.NodeToControllerChannelManagerImpl)
[2025-02-28 15:00:45,791] INFO [ControllerRegistrationManager id=2 incarnation=ZV5EUKoVQh-lwUgtiAW7JA] closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-02-28 15:00:45,792] INFO [controller-2-to-controller-registration-channel-manager]: Shutdown completed (kafka.server.NodeToControllerRequestThread)
[2025-02-28 15:00:45,792] WARN [NodeToControllerChannelManager id=2 name=registration] Attempting to close NetworkClient that has already been closed. (org.apache.kafka.clients.NetworkClient)
[2025-02-28 15:00:45,792] INFO Node to controller channel manager for registration shutdown (kafka.server.NodeToControllerChannelManagerImpl)
[2025-02-28 15:00:45,793] INFO [ControllerRegistrationManager id=2 incarnation=ZV5EUKoVQh-lwUgtiAW7JA] closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-02-28 15:00:45,797] INFO [SocketServer listenerType=CONTROLLER, nodeId=2] Stopping socket server request processors (kafka.network.SocketServer)
[2025-02-28 15:00:45,810] INFO [SocketServer listenerType=CONTROLLER, nodeId=2] Stopped socket server request processors (kafka.network.SocketServer)
[2025-02-28 15:00:45,829] INFO [QuorumController id=2] QuorumController#beginShutdown: shutting down event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-02-28 15:00:45,830] INFO [SocketServer listenerType=CONTROLLER, nodeId=2] Shutting down socket server (kafka.network.SocketServer)
[2025-02-28 15:00:45,866] INFO [SocketServer listenerType=CONTROLLER, nodeId=2] Shutdown completed (kafka.network.SocketServer)
[2025-02-28 15:00:45,871] INFO [data-plane Kafka Request Handler on Broker 2], shutting down (kafka.server.KafkaRequestHandlerPool)
[2025-02-28 15:00:45,875] INFO [data-plane Kafka Request Handler on Broker 2], shut down completely (kafka.server.KafkaRequestHandlerPool)
[2025-02-28 15:00:45,876] INFO [ExpirationReaper-2-AlterAcls]: Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:45,899] INFO [ExpirationReaper-2-AlterAcls]: Stopped (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:45,899] INFO [ExpirationReaper-2-AlterAcls]: Shutdown completed (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2025-02-28 15:00:45,900] INFO [controller-2-ThrottledChannelReaper-Fetch]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:45,900] INFO [controller-2-ThrottledChannelReaper-Fetch]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:45,900] INFO [controller-2-ThrottledChannelReaper-Fetch]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:45,900] INFO [controller-2-ThrottledChannelReaper-Produce]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:45,900] INFO [controller-2-ThrottledChannelReaper-Produce]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:45,901] INFO [controller-2-ThrottledChannelReaper-Produce]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:45,901] INFO [controller-2-ThrottledChannelReaper-Request]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:45,901] INFO [controller-2-ThrottledChannelReaper-Request]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:45,902] INFO [controller-2-ThrottledChannelReaper-Request]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:45,902] INFO [controller-2-ThrottledChannelReaper-ControllerMutation]: Shutting down (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:45,902] INFO [controller-2-ThrottledChannelReaper-ControllerMutation]: Stopped (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:45,902] INFO [controller-2-ThrottledChannelReaper-ControllerMutation]: Shutdown completed (kafka.server.ClientQuotaManager$ThrottledChannelReaper)
[2025-02-28 15:00:45,902] INFO [QuorumController id=2] closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-02-28 15:00:45,908] INFO [SharedServer id=2] Stopping SharedServer (kafka.server.SharedServer)
[2025-02-28 15:00:45,910] INFO [MetadataLoader id=2] beginShutdown: shutting down event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-02-28 15:00:45,913] INFO [SnapshotGenerator id=2] close: shutting down event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-02-28 15:00:45,993] INFO [SnapshotGenerator id=2] closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-02-28 15:00:45,996] INFO [MetadataLoader id=2] closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-02-28 15:00:45,997] INFO [SnapshotGenerator id=2] closed event queue. (org.apache.kafka.queue.KafkaEventQueue)
[2025-02-28 15:00:46,013] INFO Metrics scheduler closed (org.apache.kafka.common.metrics.Metrics)
[2025-02-28 15:00:46,013] INFO Closing reporter org.apache.kafka.common.metrics.JmxReporter (org.apache.kafka.common.metrics.Metrics)
[2025-02-28 15:00:46,014] INFO Metrics reporters closed (org.apache.kafka.common.metrics.Metrics)
[2025-02-28 15:00:46,020] INFO App info kafka.server for 2 unregistered (org.apache.kafka.common.utils.AppInfoParser)
[2025-02-28 15:00:46,026] INFO App info kafka.server for 2 unregistered (org.apache.kafka.common.utils.AppInfoParser)
