[2025-02-18 12:10:19,595] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-18 12:10:20,007] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3942, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@291d5591, 2=org.apache.kafka.raft.CandidateState$VoterState@10cb681f, 3=org.apache.kafka.raft.CandidateState$VoterState@313212ae}, highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)], electionTimeoutMs=1791) from FollowerState(fetchTimeoutMs=2000, epoch=3941, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:10:20,037] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3942, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@291d5591, 2=org.apache.kafka.raft.CandidateState$VoterState@10cb681f, 3=org.apache.kafka.raft.CandidateState$VoterState@313212ae}, highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)], electionTimeoutMs=1791) from FollowerState(fetchTimeoutMs=2000, epoch=3941, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:10:19,595] INFO [RaftManager id=3] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-18 12:10:20,050] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3942, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3a7936d7, 2=org.apache.kafka.raft.CandidateState$VoterState@2206121f, 3=org.apache.kafka.raft.CandidateState$VoterState@4370a583}, highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)], electionTimeoutMs=1924) from FollowerState(fetchTimeoutMs=2000, epoch=3941, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:10:20,082] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3942, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3a7936d7, 2=org.apache.kafka.raft.CandidateState$VoterState@2206121f, 3=org.apache.kafka.raft.CandidateState$VoterState@4370a583}, highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)], electionTimeoutMs=1924) from FollowerState(fetchTimeoutMs=2000, epoch=3941, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:10:20,089] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3942, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3941, lastOffset=256150)])]) with epoch 3942 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-18 12:10:20,144] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-18 12:10:20,144] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-18 12:10:20,145] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3943, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@793aa5a9, 2=org.apache.kafka.raft.CandidateState$VoterState@3ac8c6c2, 3=org.apache.kafka.raft.CandidateState$VoterState@7108da14}, highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)], electionTimeoutMs=1581) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3942, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@291d5591, 2=org.apache.kafka.raft.CandidateState$VoterState@10cb681f, 3=org.apache.kafka.raft.CandidateState$VoterState@313212ae}, highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)], electionTimeoutMs=1791) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:10:20,173] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3943, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@793aa5a9, 2=org.apache.kafka.raft.CandidateState$VoterState@3ac8c6c2, 3=org.apache.kafka.raft.CandidateState$VoterState@7108da14}, highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)], electionTimeoutMs=1581) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3942, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@291d5591, 2=org.apache.kafka.raft.CandidateState$VoterState@10cb681f, 3=org.apache.kafka.raft.CandidateState$VoterState@313212ae}, highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)], electionTimeoutMs=1791) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:10:20,176] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=3943, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1795, highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)]) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3942, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3a7936d7, 2=org.apache.kafka.raft.CandidateState$VoterState@2206121f, 3=org.apache.kafka.raft.CandidateState$VoterState@4370a583}, highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)], electionTimeoutMs=1924) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:10:20,184] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-18 12:10:20,190] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-18 12:10:20,199] INFO [RaftManager id=3] Completed transition to Unattached(epoch=3943, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1795, highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)]) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3942, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3a7936d7, 2=org.apache.kafka.raft.CandidateState$VoterState@2206121f, 3=org.apache.kafka.raft.CandidateState$VoterState@4370a583}, highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)], electionTimeoutMs=1924) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:10:20,199] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=3943, votedKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), voters=[1, 2, 3], electionTimeoutMs=1401, highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)]) from Unattached(epoch=3943, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1795, highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:10:20,223] INFO [RaftManager id=3] Completed transition to Unattached(epoch=3943, votedKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), voters=[1, 2, 3], electionTimeoutMs=1401, highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)]) from Unattached(epoch=3943, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1795, highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:10:20,224] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3943, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3941, lastOffset=256150)])]) with epoch 3943 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-18 12:10:20,230] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=3943, epochStartOffset=256150, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3943, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@793aa5a9, 2=org.apache.kafka.raft.CandidateState$VoterState@3ac8c6c2, 3=org.apache.kafka.raft.CandidateState$VoterState@7108da14}, highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)], electionTimeoutMs=1581) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:10:20,249] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=3943, epochStartOffset=256150, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3943, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@793aa5a9, 2=org.apache.kafka.raft.CandidateState$VoterState@3ac8c6c2, 3=org.apache.kafka.raft.CandidateState$VoterState@7108da14}, highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)], electionTimeoutMs=1581) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:10:20,291] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-18 12:10:20,309] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-18 12:10:20,309] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-18 12:10:20,335] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=3943, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=3943, votedKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), voters=[1, 2, 3], electionTimeoutMs=1401, highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:10:20,359] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=3943, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=3943, votedKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), voters=[1, 2, 3], electionTimeoutMs=1401, highWatermark=Optional[LogOffsetMetadata(offset=256149, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:10:20,360] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-18 12:10:20,381] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-18 12:10:20,382] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-18 12:10:20,386] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-18 12:10:20,400] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-18 12:10:20,400] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-18 12:10:20,433] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-18 12:10:20,443] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-18 12:10:20,443] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-18 12:10:20,451] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-18 12:10:20,455] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-18 12:10:20,456] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-18 12:10:20,478] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=256151, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7066529)]) for the first time for epoch 3943 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=256151, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7066529)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=256151, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7066529)])], lastFetchTimestamp=1739860820476, lastCaughtUpTimestamp=1739860820476, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-18 12:10:20,493] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-18 12:10:20,505] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-18 12:18:47,917] INFO [SnapshotGenerator id=3] Creating new KRaft snapshot file snapshot 00000000000000257160-0000003943 because we have waited at least 60 minute(s). (org.apache.kafka.image.publisher.SnapshotGenerator)
[2025-02-18 12:18:48,131] INFO [SnapshotEmitter id=3] Successfully wrote snapshot 00000000000000257160-0000003943 (org.apache.kafka.image.publisher.SnapshotEmitter)
[2025-02-18 12:18:49,400] INFO [SnapshotGenerator id=2] Creating new KRaft snapshot file snapshot 00000000000000257164-0000003943 because we have waited at least 60 minute(s). (org.apache.kafka.image.publisher.SnapshotGenerator)
[2025-02-18 12:18:49,545] INFO [SnapshotEmitter id=2] Successfully wrote snapshot 00000000000000257164-0000003943 (org.apache.kafka.image.publisher.SnapshotEmitter)
[2025-02-18 12:40:16,488] INFO [RaftManager id=3] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-18 12:40:16,500] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3944, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5b2c7004, 2=org.apache.kafka.raft.CandidateState$VoterState@3dac0c52, 3=org.apache.kafka.raft.CandidateState$VoterState@20ce003e}, highWatermark=Optional[LogOffsetMetadata(offset=259722, metadata=Optional.empty)], electionTimeoutMs=1848) from FollowerState(fetchTimeoutMs=2000, epoch=3943, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=259722, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:40:16,790] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3944, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5b2c7004, 2=org.apache.kafka.raft.CandidateState$VoterState@3dac0c52, 3=org.apache.kafka.raft.CandidateState$VoterState@20ce003e}, highWatermark=Optional[LogOffsetMetadata(offset=259722, metadata=Optional.empty)], electionTimeoutMs=1848) from FollowerState(fetchTimeoutMs=2000, epoch=3943, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=259722, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:40:16,799] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=3944, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1079, highWatermark=Optional[LogOffsetMetadata(offset=259723, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7323408)])]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=3943, epochStartOffset=256150, highWatermark=Optional[LogOffsetMetadata(offset=259723, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7323408)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=259723, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7323408)])], lastFetchTimestamp=1739862616751, lastCaughtUpTimestamp=1739862614486, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=259727, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7323574)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=259723, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7323408)])], lastFetchTimestamp=1739862616580, lastCaughtUpTimestamp=1739862614484, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:40:16,849] INFO [RaftManager id=2] Completed transition to Unattached(epoch=3944, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1079, highWatermark=Optional[LogOffsetMetadata(offset=259723, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7323408)])]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=3943, epochStartOffset=256150, highWatermark=Optional[LogOffsetMetadata(offset=259723, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7323408)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=259723, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7323408)])], lastFetchTimestamp=1739862616751, lastCaughtUpTimestamp=1739862614486, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=259727, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7323574)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=259723, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7323408)])], lastFetchTimestamp=1739862616580, lastCaughtUpTimestamp=1739862614484, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:40:16,851] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3944, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3943, lastOffset=259723)])]) with epoch 3944 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-18 12:40:16,852] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3944, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3943, lastOffset=259723)])]) with epoch 3944 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-18 12:40:16,861] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3944, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3943, lastOffset=259723)])]) with epoch 3944 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-18 12:40:16,869] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(687216352). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-18 12:40:16,870] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1601675990). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-18 12:40:16,870] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1843879735). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-18 12:40:16,870] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(518482243). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-18 12:40:16,871] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(113130857). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-18 12:40:16,871] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(1681739386). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-18 12:40:16,871] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(871672621). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-18 12:40:16,871] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-18 12:40:16,871] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-18 12:40:17,387] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=3945, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=961, highWatermark=Optional[LogOffsetMetadata(offset=259722, metadata=Optional.empty)]) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3944, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5b2c7004, 2=org.apache.kafka.raft.CandidateState$VoterState@3dac0c52, 3=org.apache.kafka.raft.CandidateState$VoterState@20ce003e}, highWatermark=Optional[LogOffsetMetadata(offset=259722, metadata=Optional.empty)], electionTimeoutMs=1848) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:40:17,389] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=3945, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=489, highWatermark=Optional[LogOffsetMetadata(offset=259723, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7323408)])]) from Unattached(epoch=3944, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1079, highWatermark=Optional[LogOffsetMetadata(offset=259723, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7323408)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:40:17,409] INFO [RaftManager id=3] Completed transition to Unattached(epoch=3945, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=961, highWatermark=Optional[LogOffsetMetadata(offset=259722, metadata=Optional.empty)]) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3944, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5b2c7004, 2=org.apache.kafka.raft.CandidateState$VoterState@3dac0c52, 3=org.apache.kafka.raft.CandidateState$VoterState@20ce003e}, highWatermark=Optional[LogOffsetMetadata(offset=259722, metadata=Optional.empty)], electionTimeoutMs=1848) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:40:17,409] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=3945, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1350, highWatermark=Optional[LogOffsetMetadata(offset=259722, metadata=Optional.empty)]) from Unattached(epoch=3945, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=961, highWatermark=Optional[LogOffsetMetadata(offset=259722, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:40:17,416] INFO [RaftManager id=2] Completed transition to Unattached(epoch=3945, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=489, highWatermark=Optional[LogOffsetMetadata(offset=259723, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7323408)])]) from Unattached(epoch=3944, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1079, highWatermark=Optional[LogOffsetMetadata(offset=259723, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7323408)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:40:17,416] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3945, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3943, lastOffset=259723)])]) with epoch 3945 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-18 12:40:17,430] INFO [RaftManager id=3] Completed transition to Unattached(epoch=3945, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1350, highWatermark=Optional[LogOffsetMetadata(offset=259722, metadata=Optional.empty)]) from Unattached(epoch=3945, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=961, highWatermark=Optional[LogOffsetMetadata(offset=259722, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:40:17,430] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3945, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3943, lastOffset=259723)])]) with epoch 3945 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-18 12:40:17,540] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=3945, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=259722, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=3945, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1350, highWatermark=Optional[LogOffsetMetadata(offset=259722, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:40:17,541] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=3945, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=259723, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7323408)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=3945, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=489, highWatermark=Optional[LogOffsetMetadata(offset=259723, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7323408)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:40:17,573] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=3945, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=259723, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7323408)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=3945, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=489, highWatermark=Optional[LogOffsetMetadata(offset=259723, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7323408)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:40:17,581] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-18 12:40:17,586] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=3945, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=259722, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=3945, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1350, highWatermark=Optional[LogOffsetMetadata(offset=259722, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:40:17,589] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-18 12:40:17,589] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-18 12:40:17,640] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-18 12:40:17,643] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-18 12:40:17,644] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-18 12:40:17,648] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Truncating to offset 259723 (kafka.log.UnifiedLog)
[2025-02-18 12:40:17,665] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Loading producer state till offset 259723 with message format version 2 (kafka.log.UnifiedLog$)
[2025-02-18 12:40:17,667] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Reloading from producer snapshot and rebuilding producer state from offset 259723 (kafka.log.UnifiedLog$)
[2025-02-18 12:40:17,668] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=253116, file=/tmp/kafka-logs-node2/__cluster_metadata-0/00000000000000253116.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-18 12:40:17,681] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-18 12:40:17,684] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 259723 with 0 producer ids in 9 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-18 12:40:17,684] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Producer state recovery took 4ms for snapshot load and 13ms for segment recovery from offset 259723 (kafka.log.UnifiedLog$)
[2025-02-18 12:40:17,685] INFO [RaftManager id=2] Truncated to offset 259723 from Fetch response from leader 1 (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-18 12:40:17,694] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-18 12:42:15,665] INFO [RaftManager id=3] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-18 12:42:15,837] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3946, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@66a0d425, 2=org.apache.kafka.raft.CandidateState$VoterState@65ab09cf, 3=org.apache.kafka.raft.CandidateState$VoterState@16e7a424}, highWatermark=Optional[LogOffsetMetadata(offset=259954, metadata=Optional.empty)], electionTimeoutMs=1020) from FollowerState(fetchTimeoutMs=2000, epoch=3945, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=259954, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:42:16,165] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-18 12:42:16,166] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3946, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@4507b274, 2=org.apache.kafka.raft.CandidateState$VoterState@599d5d3f, 3=org.apache.kafka.raft.CandidateState$VoterState@51966dd9}, highWatermark=Optional[LogOffsetMetadata(offset=259955, metadata=Optional.empty)], electionTimeoutMs=1409) from FollowerState(fetchTimeoutMs=2000, epoch=3945, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=259955, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:42:16,450] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3946, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@66a0d425, 2=org.apache.kafka.raft.CandidateState$VoterState@65ab09cf, 3=org.apache.kafka.raft.CandidateState$VoterState@16e7a424}, highWatermark=Optional[LogOffsetMetadata(offset=259954, metadata=Optional.empty)], electionTimeoutMs=1020) from FollowerState(fetchTimeoutMs=2000, epoch=3945, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=259954, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:42:16,495] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3946, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@4507b274, 2=org.apache.kafka.raft.CandidateState$VoterState@599d5d3f, 3=org.apache.kafka.raft.CandidateState$VoterState@51966dd9}, highWatermark=Optional[LogOffsetMetadata(offset=259955, metadata=Optional.empty)], electionTimeoutMs=1409) from FollowerState(fetchTimeoutMs=2000, epoch=3945, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=259955, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:42:16,496] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3946, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3945, lastOffset=259955)])]) with epoch 3946 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-18 12:42:16,499] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3946, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3945, lastOffset=259956)])]) with epoch 3946 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-18 12:42:16,590] INFO [RaftManager id=3] Insufficient remaining votes to become leader (rejected by [1, 2]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-18 12:42:16,591] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-18 12:42:16,592] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-18 12:42:16,592] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3947, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@17369d4e, 2=org.apache.kafka.raft.CandidateState$VoterState@6f5a09ce, 3=org.apache.kafka.raft.CandidateState$VoterState@5c9dd5bf}, highWatermark=Optional[LogOffsetMetadata(offset=259955, metadata=Optional.empty)], electionTimeoutMs=1686) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3946, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@4507b274, 2=org.apache.kafka.raft.CandidateState$VoterState@599d5d3f, 3=org.apache.kafka.raft.CandidateState$VoterState@51966dd9}, highWatermark=Optional[LogOffsetMetadata(offset=259955, metadata=Optional.empty)], electionTimeoutMs=1409) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:42:16,636] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3947, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@17369d4e, 2=org.apache.kafka.raft.CandidateState$VoterState@6f5a09ce, 3=org.apache.kafka.raft.CandidateState$VoterState@5c9dd5bf}, highWatermark=Optional[LogOffsetMetadata(offset=259955, metadata=Optional.empty)], electionTimeoutMs=1686) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3946, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@4507b274, 2=org.apache.kafka.raft.CandidateState$VoterState@599d5d3f, 3=org.apache.kafka.raft.CandidateState$VoterState@51966dd9}, highWatermark=Optional[LogOffsetMetadata(offset=259955, metadata=Optional.empty)], electionTimeoutMs=1409) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:42:16,641] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=3947, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=216, highWatermark=Optional[LogOffsetMetadata(offset=259954, metadata=Optional.empty)]) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3946, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@66a0d425, 2=org.apache.kafka.raft.CandidateState$VoterState@65ab09cf, 3=org.apache.kafka.raft.CandidateState$VoterState@16e7a424}, highWatermark=Optional[LogOffsetMetadata(offset=259954, metadata=Optional.empty)], electionTimeoutMs=1020) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:42:16,701] INFO [RaftManager id=3] Completed transition to Unattached(epoch=3947, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=216, highWatermark=Optional[LogOffsetMetadata(offset=259954, metadata=Optional.empty)]) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=3946, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@66a0d425, 2=org.apache.kafka.raft.CandidateState$VoterState@65ab09cf, 3=org.apache.kafka.raft.CandidateState$VoterState@16e7a424}, highWatermark=Optional[LogOffsetMetadata(offset=259954, metadata=Optional.empty)], electionTimeoutMs=1020) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:42:16,702] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=3947, votedKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), voters=[1, 2, 3], electionTimeoutMs=1971, highWatermark=Optional[LogOffsetMetadata(offset=259954, metadata=Optional.empty)]) from Unattached(epoch=3947, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=216, highWatermark=Optional[LogOffsetMetadata(offset=259954, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:42:16,763] INFO [RaftManager id=3] Completed transition to Unattached(epoch=3947, votedKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), voters=[1, 2, 3], electionTimeoutMs=1971, highWatermark=Optional[LogOffsetMetadata(offset=259954, metadata=Optional.empty)]) from Unattached(epoch=3947, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=216, highWatermark=Optional[LogOffsetMetadata(offset=259954, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:42:16,763] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3947, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3945, lastOffset=259956)])]) with epoch 3947 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-18 12:42:16,765] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=3947, epochStartOffset=259956, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3947, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@17369d4e, 2=org.apache.kafka.raft.CandidateState$VoterState@6f5a09ce, 3=org.apache.kafka.raft.CandidateState$VoterState@5c9dd5bf}, highWatermark=Optional[LogOffsetMetadata(offset=259955, metadata=Optional.empty)], electionTimeoutMs=1686) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:42:16,793] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=3947, epochStartOffset=259956, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3947, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@17369d4e, 2=org.apache.kafka.raft.CandidateState$VoterState@6f5a09ce, 3=org.apache.kafka.raft.CandidateState$VoterState@5c9dd5bf}, highWatermark=Optional[LogOffsetMetadata(offset=259955, metadata=Optional.empty)], electionTimeoutMs=1686) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:42:16,849] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=3947, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=259954, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=3947, votedKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), voters=[1, 2, 3], electionTimeoutMs=1971, highWatermark=Optional[LogOffsetMetadata(offset=259954, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:42:16,895] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=3947, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=259954, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=3947, votedKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), voters=[1, 2, 3], electionTimeoutMs=1971, highWatermark=Optional[LogOffsetMetadata(offset=259954, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-18 12:42:16,998] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=259957, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7340324)]) for the first time for epoch 3947 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=259957, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7340324)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=259957, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=7340324)])], lastFetchTimestamp=1739862736998, lastCaughtUpTimestamp=1739862736998, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-18 12:42:18,536] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-18 12:42:18,536] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-18 12:42:18,541] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-18 12:42:18,542] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
