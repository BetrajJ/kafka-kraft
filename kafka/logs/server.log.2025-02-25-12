[2025-02-25 13:00:26,852] INFO [SnapshotGenerator id=1] Creating new KRaft snapshot file snapshot 00000000000000351547-0000004453 because we have waited at least 60 minute(s). (org.apache.kafka.image.publisher.SnapshotGenerator)
[2025-02-25 13:00:26,944] INFO [SnapshotEmitter id=1] Successfully wrote snapshot 00000000000000351547-0000004453 (org.apache.kafka.image.publisher.SnapshotEmitter)
[2025-02-25 13:10:27,414] INFO [RaftManager id=1] Attempting durable transition to Unattached(epoch=4454, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1260, highWatermark=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), epoch=4453, epochStartOffset=349528, highWatermark=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=352743, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186471)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=352739, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186244)])], lastFetchTimestamp=1740469227279, lastCaughtUpTimestamp=1740469225151, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])], lastFetchTimestamp=1740469227391, lastCaughtUpTimestamp=1740469226472, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:10:27,568] INFO [RaftManager id=1] Completed transition to Unattached(epoch=4454, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1260, highWatermark=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), epoch=4453, epochStartOffset=349528, highWatermark=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=352743, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186471)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=352739, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186244)])], lastFetchTimestamp=1740469227279, lastCaughtUpTimestamp=1740469225151, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])], lastFetchTimestamp=1740469227391, lastCaughtUpTimestamp=1740469226472, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:10:27,570] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4454, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4453, lastOffset=352739)])]) with epoch 4454 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 13:10:27,571] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(1368744738). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 13:10:27,571] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(405715326). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 13:10:27,572] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(914517044). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 13:10:28,119] INFO [RaftManager id=1] Attempting durable transition to Unattached(epoch=4455, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=555, highWatermark=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])]) from Unattached(epoch=4454, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1260, highWatermark=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:10:28,161] INFO [RaftManager id=1] Completed transition to Unattached(epoch=4455, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=555, highWatermark=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])]) from Unattached(epoch=4454, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1260, highWatermark=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:10:28,161] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4455, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4453, lastOffset=352739)])]) with epoch 4455 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 13:10:28,476] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 13:10:28,588] INFO [RaftManager id=1] Attempting durable transition to Unattached(epoch=4456, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=87, highWatermark=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])]) from Unattached(epoch=4455, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=555, highWatermark=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:10:28,680] INFO [RaftManager id=1] Completed transition to Unattached(epoch=4456, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=87, highWatermark=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])]) from Unattached(epoch=4455, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=555, highWatermark=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:10:28,681] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4456, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4453, lastOffset=352739)])]) with epoch 4456 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 13:10:28,682] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4457, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@157db42e, 2=org.apache.kafka.raft.CandidateState$VoterState@236117f, 3=org.apache.kafka.raft.CandidateState$VoterState@7ec7215f}, highWatermark=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])], electionTimeoutMs=1712) from Unattached(epoch=4456, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=87, highWatermark=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:10:28,974] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4457, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@157db42e, 2=org.apache.kafka.raft.CandidateState$VoterState@236117f, 3=org.apache.kafka.raft.CandidateState$VoterState@7ec7215f}, highWatermark=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])], electionTimeoutMs=1712) from Unattached(epoch=4456, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=87, highWatermark=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:10:28,998] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4457, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4453, lastOffset=352743)])]) with epoch 4457 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 13:10:29,001] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4457, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4453, lastOffset=352739)])]) with epoch 4457 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 13:10:29,008] INFO [RaftManager id=1] Insufficient remaining votes to become leader (rejected by [2, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 13:10:29,009] INFO [RaftManager id=1] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 13:10:29,009] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4458, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@69295cc0, 2=org.apache.kafka.raft.CandidateState$VoterState@118d490f, 3=org.apache.kafka.raft.CandidateState$VoterState@23821fa8}, highWatermark=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])], electionTimeoutMs=1024) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4457, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@157db42e, 2=org.apache.kafka.raft.CandidateState$VoterState@236117f, 3=org.apache.kafka.raft.CandidateState$VoterState@7ec7215f}, highWatermark=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])], electionTimeoutMs=1712) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:10:29,074] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4458, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@69295cc0, 2=org.apache.kafka.raft.CandidateState$VoterState@118d490f, 3=org.apache.kafka.raft.CandidateState$VoterState@23821fa8}, highWatermark=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])], electionTimeoutMs=1024) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4457, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@157db42e, 2=org.apache.kafka.raft.CandidateState$VoterState@236117f, 3=org.apache.kafka.raft.CandidateState$VoterState@7ec7215f}, highWatermark=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])], electionTimeoutMs=1712) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:10:29,210] INFO [RaftManager id=1] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), epoch=4458, epochStartOffset=352743, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4458, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@69295cc0, 2=org.apache.kafka.raft.CandidateState$VoterState@118d490f, 3=org.apache.kafka.raft.CandidateState$VoterState@23821fa8}, highWatermark=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])], electionTimeoutMs=1024) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:10:29,297] INFO [RaftManager id=1] Completed transition to Leader(localReplicaKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), epoch=4458, epochStartOffset=352743, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4458, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@69295cc0, 2=org.apache.kafka.raft.CandidateState$VoterState@118d490f, 3=org.apache.kafka.raft.CandidateState$VoterState@23821fa8}, highWatermark=Optional[LogOffsetMetadata(offset=352740, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186316)])], electionTimeoutMs=1024) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:10:29,381] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 13:10:29,393] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 13:10:29,394] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 13:10:29,444] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 13:10:29,450] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 13:10:29,450] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 13:10:29,501] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 13:10:29,503] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 13:10:29,503] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 13:10:29,554] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 13:10:29,557] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 13:10:29,558] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 13:10:29,607] INFO [RaftManager id=1] High watermark set to LogOffsetMetadata(offset=352744, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186577)]) for the first time for epoch 4458 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=352744, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186577)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=352744, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186577)])], lastFetchTimestamp=1740469229607, lastCaughtUpTimestamp=1740469229607, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=352739, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4186244)])], lastFetchTimestamp=1740469229501, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-25 13:10:29,608] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 13:15:14,807] INFO [RaftManager id=1] Attempting durable transition to Unattached(epoch=4459, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1643, highWatermark=Optional[LogOffsetMetadata(offset=353307, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4227113)])]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), epoch=4458, epochStartOffset=352743, highWatermark=Optional[LogOffsetMetadata(offset=353307, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4227113)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=353312, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4227412)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=353307, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4227113)])], lastFetchTimestamp=1740469514776, lastCaughtUpTimestamp=1740469512262, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=353306, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4227041)])], lastFetchTimestamp=1740469514165, lastCaughtUpTimestamp=1740469511759, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:15:14,839] INFO [RaftManager id=1] Completed transition to Unattached(epoch=4459, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1643, highWatermark=Optional[LogOffsetMetadata(offset=353307, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4227113)])]) from Leader(localReplicaKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), epoch=4458, epochStartOffset=352743, highWatermark=Optional[LogOffsetMetadata(offset=353307, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4227113)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=353312, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4227412)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=353307, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4227113)])], lastFetchTimestamp=1740469514776, lastCaughtUpTimestamp=1740469512262, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=353306, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4227041)])], lastFetchTimestamp=1740469514165, lastCaughtUpTimestamp=1740469511759, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:15:14,840] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4459, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4458, lastOffset=353306)])]) with epoch 4459 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 13:15:14,841] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4459, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4458, lastOffset=353307)])]) with epoch 4459 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 13:15:14,842] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(375674527). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 13:15:14,843] INFO [QuorumController id=1] failAll(NotControllerException): failing processBrokerHeartbeat(85185752). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 13:15:14,843] INFO [QuorumController id=1] failAll(NotControllerException): failing processBrokerHeartbeat(892938075). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 13:15:14,845] INFO [QuorumController id=1] failAll(NotControllerException): failing processBrokerHeartbeat(795519421). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 13:15:14,846] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 13:15:14,848] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(453952097). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 13:15:14,852] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(10510540). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 13:15:14,852] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(2095029372). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 13:15:14,852] INFO [QuorumController id=1] failAll(NotControllerException): failing writeNoOpRecord(100857115). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 13:15:14,888] INFO [RaftManager id=1] Attempting durable transition to Unattached(epoch=4460, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1562, highWatermark=Optional[LogOffsetMetadata(offset=353307, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4227113)])]) from Unattached(epoch=4459, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1643, highWatermark=Optional[LogOffsetMetadata(offset=353307, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4227113)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:15:14,946] INFO [RaftManager id=1] Completed transition to Unattached(epoch=4460, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1562, highWatermark=Optional[LogOffsetMetadata(offset=353307, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4227113)])]) from Unattached(epoch=4459, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1643, highWatermark=Optional[LogOffsetMetadata(offset=353307, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4227113)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:15:14,947] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4460, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4458, lastOffset=353307)])]) with epoch 4460 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 13:15:15,099] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=4460, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=353307, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4227113)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=4460, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1562, highWatermark=Optional[LogOffsetMetadata(offset=353307, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4227113)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:15:15,140] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=4460, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=353307, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4227113)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=4460, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1562, highWatermark=Optional[LogOffsetMetadata(offset=353307, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4227113)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:15:15,151] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 13:15:15,176] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 13:15:15,177] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 13:15:15,227] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 13:15:15,235] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Truncating to offset 353307 (kafka.log.UnifiedLog)
[2025-02-25 13:15:15,238] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 13:15:15,239] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 13:15:15,252] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Loading producer state till offset 353307 with message format version 2 (kafka.log.UnifiedLog$)
[2025-02-25 13:15:15,254] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Reloading from producer snapshot and rebuilding producer state from offset 353307 (kafka.log.UnifiedLog$)
[2025-02-25 13:15:15,256] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=349049, file=/tmp/kafka-logs/__cluster_metadata-0/00000000000000349049.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-25 13:15:15,291] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 13:15:15,294] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 353307 with 0 producer ids in 18 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-25 13:15:15,294] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Producer state recovery took 3ms for snapshot load and 35ms for segment recovery from offset 353307 (kafka.log.UnifiedLog$)
[2025-02-25 13:15:15,295] INFO [RaftManager id=1] Truncated to offset 353307 from Fetch response from leader 2 (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 13:19:35,810] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Incremented log start offset to 271367 due to snapshot generated (kafka.log.UnifiedLog)
[2025-02-25 13:19:35,853] INFO [MetadataLog partition=__cluster_metadata-0, nodeId=1] Marking snapshot OffsetAndEpoch(offset=264312, epoch=3949) for deletion because its timestamp (1739864927225) is now (1740469775809) older than the
retention (604800000) (kafka.raft.KafkaMetadataLog)
[2025-02-25 13:20:35,883] INFO Deleted snapshot files for snapshot OffsetAndEpoch(offset=264312, epoch=3949). (org.apache.kafka.snapshot.Snapshots)
[2025-02-25 13:25:14,756] INFO [RaftManager id=1] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-02-25 13:28:10,552] INFO [RaftManager id=1] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 13:28:10,553] INFO [RaftManager id=1] Attempting durable transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4461, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@639fd170, 2=org.apache.kafka.raft.CandidateState$VoterState@327c9b46, 3=org.apache.kafka.raft.CandidateState$VoterState@14f8d0ad}, highWatermark=Optional[LogOffsetMetadata(offset=354848, metadata=Optional.empty)], electionTimeoutMs=1763) from FollowerState(fetchTimeoutMs=2000, epoch=4460, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=354848, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:28:10,625] INFO [RaftManager id=1] Disconnecting from node 2 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-02-25 13:28:10,637] INFO [RaftManager id=1] Cancelled in-flight FETCH request with correlation id 60191 due to node 2 being disconnected (elapsed time since creation: 2003ms, elapsed time since send: 2002ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-02-25 13:28:10,675] INFO [RaftManager id=1] Completed transition to CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4461, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@639fd170, 2=org.apache.kafka.raft.CandidateState$VoterState@327c9b46, 3=org.apache.kafka.raft.CandidateState$VoterState@14f8d0ad}, highWatermark=Optional[LogOffsetMetadata(offset=354848, metadata=Optional.empty)], electionTimeoutMs=1763) from FollowerState(fetchTimeoutMs=2000, epoch=4460, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=354848, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:28:10,817] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 13:28:10,823] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4461, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4460, lastOffset=354849)])]) with epoch 4461 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 13:28:10,863] INFO [RaftManager id=1] Attempting durable transition to Unattached(epoch=4462, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1452, highWatermark=Optional[LogOffsetMetadata(offset=354848, metadata=Optional.empty)]) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4461, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@639fd170, 2=org.apache.kafka.raft.CandidateState$VoterState@327c9b46, 3=org.apache.kafka.raft.CandidateState$VoterState@14f8d0ad}, highWatermark=Optional[LogOffsetMetadata(offset=354848, metadata=Optional.empty)], electionTimeoutMs=1763) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:28:10,909] INFO [RaftManager id=1] Completed transition to Unattached(epoch=4462, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1452, highWatermark=Optional[LogOffsetMetadata(offset=354848, metadata=Optional.empty)]) from CandidateState(localId=1, localDirectoryId=mQes9A54bQCw7Vbw6Ptauw,epoch=4461, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@639fd170, 2=org.apache.kafka.raft.CandidateState$VoterState@327c9b46, 3=org.apache.kafka.raft.CandidateState$VoterState@14f8d0ad}, highWatermark=Optional[LogOffsetMetadata(offset=354848, metadata=Optional.empty)], electionTimeoutMs=1763) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:28:10,912] INFO [RaftManager id=1] Attempting durable transition to Unattached(epoch=4462, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1008, highWatermark=Optional[LogOffsetMetadata(offset=354848, metadata=Optional.empty)]) from Unattached(epoch=4462, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1452, highWatermark=Optional[LogOffsetMetadata(offset=354848, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:28:10,951] INFO [RaftManager id=1] Completed transition to Unattached(epoch=4462, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1008, highWatermark=Optional[LogOffsetMetadata(offset=354848, metadata=Optional.empty)]) from Unattached(epoch=4462, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1452, highWatermark=Optional[LogOffsetMetadata(offset=354848, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:28:10,951] INFO [RaftManager id=1] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=1, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4462, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4460, lastOffset=354849)])]) with epoch 4462 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 13:28:11,064] INFO [RaftManager id=1] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=4462, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=354848, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=4462, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1008, highWatermark=Optional[LogOffsetMetadata(offset=354848, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:28:11,097] INFO [RaftManager id=1] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=4462, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=354848, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=4462, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1008, highWatermark=Optional[LogOffsetMetadata(offset=354848, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 13:28:11,122] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 13:28:11,124] INFO [NodeToControllerChannelManager id=1 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 13:28:11,124] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 13:28:11,175] INFO [broker-1-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
