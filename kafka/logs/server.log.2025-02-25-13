[2025-02-25 14:33:49,297] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 14:33:49,300] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4463, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5b98c15e, 2=org.apache.kafka.raft.CandidateState$VoterState@7c1a864a, 3=org.apache.kafka.raft.CandidateState$VoterState@230febf3}, highWatermark=Optional[LogOffsetMetadata(offset=355504, metadata=Optional.empty)], electionTimeoutMs=1634) from FollowerState(fetchTimeoutMs=2000, epoch=4462, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=355504, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 14:33:49,349] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4463, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5b98c15e, 2=org.apache.kafka.raft.CandidateState$VoterState@7c1a864a, 3=org.apache.kafka.raft.CandidateState$VoterState@230febf3}, highWatermark=Optional[LogOffsetMetadata(offset=355504, metadata=Optional.empty)], electionTimeoutMs=1634) from FollowerState(fetchTimeoutMs=2000, epoch=4462, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=355504, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 14:33:49,350] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Incremented log start offset to 278440 due to snapshot generated (kafka.log.UnifiedLog)
[2025-02-25 14:33:49,351] INFO [MetadataLog partition=__cluster_metadata-0, nodeId=2] Marking snapshot OffsetAndEpoch(offset=271370, epoch=3999) for deletion because its timestamp (1739868529557) is now (1740474229350) older than the
retention (604800000) (kafka.raft.KafkaMetadataLog)
[2025-02-25 14:33:49,448] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4463, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4462, lastOffset=355505)])]) with epoch 4463 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 14:33:49,543] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 14:33:49,595] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=4463, epochStartOffset=355505, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4463, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5b98c15e, 2=org.apache.kafka.raft.CandidateState$VoterState@7c1a864a, 3=org.apache.kafka.raft.CandidateState$VoterState@230febf3}, highWatermark=Optional[LogOffsetMetadata(offset=355504, metadata=Optional.empty)], electionTimeoutMs=1634) (org.apache.kafka.raft.QuorumState)
[2025-02-25 14:33:49,673] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=4463, epochStartOffset=355505, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=4463, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5b98c15e, 2=org.apache.kafka.raft.CandidateState$VoterState@7c1a864a, 3=org.apache.kafka.raft.CandidateState$VoterState@230febf3}, highWatermark=Optional[LogOffsetMetadata(offset=355504, metadata=Optional.empty)], electionTimeoutMs=1634) (org.apache.kafka.raft.QuorumState)
[2025-02-25 14:33:49,770] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 14:33:49,784] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 14:33:49,786] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 14:33:49,788] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=4464, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1915, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=4463, epochStartOffset=355505, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=355506, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4385177)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 14:33:49,837] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 14:33:49,847] INFO [RaftManager id=2] Completed transition to Unattached(epoch=4464, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1915, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=4463, epochStartOffset=355505, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=355506, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=4385177)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 14:33:49,847] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4464, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4462, lastOffset=355505)])]) with epoch 4464 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 14:33:49,852] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 14:33:49,931] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=4464, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=4464, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1915, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 14:33:50,001] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=4464, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=4464, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1915, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 14:33:50,017] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Truncating to offset 355505 (kafka.log.UnifiedLog)
[2025-02-25 14:33:50,032] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Loading producer state till offset 355505 with message format version 2 (kafka.log.UnifiedLog$)
[2025-02-25 14:33:50,035] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Reloading from producer snapshot and rebuilding producer state from offset 355505 (kafka.log.UnifiedLog$)
[2025-02-25 14:33:50,035] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=354849, file=/tmp/kafka-logs-node2/__cluster_metadata-0/00000000000000354849.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-25 14:33:50,055] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 14:33:50,068] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 14:33:50,069] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 14:33:50,089] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 355505 with 0 producer ids in 48 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-25 14:33:50,089] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Producer state recovery took 5ms for snapshot load and 49ms for segment recovery from offset 355505 (kafka.log.UnifiedLog$)
[2025-02-25 14:33:50,090] INFO [RaftManager id=2] Truncated to offset 355505 from Fetch response from leader 1 (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 14:33:50,123] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 14:33:50,199] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=355506, metadata=Optional.empty)] for the first time for epoch 4464 (org.apache.kafka.raft.FollowerState)
[2025-02-25 14:34:33,508] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=4465, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1714, highWatermark=Optional[LogOffsetMetadata(offset=355588, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=4464, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=355588, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 14:34:33,656] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 14:34:33,682] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 14:34:33,755] INFO [RaftManager id=2] Completed transition to Unattached(epoch=4465, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1714, highWatermark=Optional[LogOffsetMetadata(offset=355588, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=4464, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=355588, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 14:34:33,834] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4465, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4464, lastOffset=355584)])]) with epoch 4465 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 14:34:33,880] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=4466, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1283, highWatermark=Optional[LogOffsetMetadata(offset=355588, metadata=Optional.empty)]) from Unattached(epoch=4465, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1714, highWatermark=Optional[LogOffsetMetadata(offset=355588, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 14:34:33,972] INFO [RaftManager id=2] Completed transition to Unattached(epoch=4466, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1283, highWatermark=Optional[LogOffsetMetadata(offset=355588, metadata=Optional.empty)]) from Unattached(epoch=4465, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1714, highWatermark=Optional[LogOffsetMetadata(offset=355588, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 14:34:33,973] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4466, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4464, lastOffset=355584)])]) with epoch 4466 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 14:34:33,977] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=4467, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1186, highWatermark=Optional[LogOffsetMetadata(offset=355588, metadata=Optional.empty)]) from Unattached(epoch=4466, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1283, highWatermark=Optional[LogOffsetMetadata(offset=355588, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 14:34:34,063] INFO [RaftManager id=2] Completed transition to Unattached(epoch=4467, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1186, highWatermark=Optional[LogOffsetMetadata(offset=355588, metadata=Optional.empty)]) from Unattached(epoch=4466, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1283, highWatermark=Optional[LogOffsetMetadata(offset=355588, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 14:34:34,096] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=4467, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1589, highWatermark=Optional[LogOffsetMetadata(offset=355588, metadata=Optional.empty)]) from Unattached(epoch=4467, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1186, highWatermark=Optional[LogOffsetMetadata(offset=355588, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 14:34:34,232] INFO [RaftManager id=2] Completed transition to Unattached(epoch=4467, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1589, highWatermark=Optional[LogOffsetMetadata(offset=355588, metadata=Optional.empty)]) from Unattached(epoch=4467, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1186, highWatermark=Optional[LogOffsetMetadata(offset=355588, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 14:34:34,232] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=4467, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=4464, lastOffset=355588)])]) with epoch 4467 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 14:34:34,278] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=4467, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=355588, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=4467, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1589, highWatermark=Optional[LogOffsetMetadata(offset=355588, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 14:34:34,363] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=4467, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=355588, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=4467, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1589, highWatermark=Optional[LogOffsetMetadata(offset=355588, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 14:34:34,381] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 14:34:49,368] INFO Deleted snapshot files for snapshot OffsetAndEpoch(offset=271370, epoch=3999). (org.apache.kafka.snapshot.Snapshots)
[2025-02-25 14:43:49,842] INFO [RaftManager id=2] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
