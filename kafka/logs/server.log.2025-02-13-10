[2025-02-13 11:11:46,721] WARN [SocketServer listenerType=BROKER, nodeId=2] Unexpected error from /172.25.10.83 (channelId=172.25.10.83:9093-172.25.10.83:34466-1); closing connection (org.apache.kafka.common.network.Selector)
org.apache.kafka.common.network.InvalidReceiveException: Invalid receive (size = -720899)
	at org.apache.kafka.common.network.NetworkReceive.readFrom(NetworkReceive.java:93)
	at org.apache.kafka.common.network.KafkaChannel.receive(KafkaChannel.java:462)
	at org.apache.kafka.common.network.KafkaChannel.read(KafkaChannel.java:412)
	at org.apache.kafka.common.network.Selector.attemptRead(Selector.java:694)
	at org.apache.kafka.common.network.Selector.pollSelectionKeys(Selector.java:596)
	at org.apache.kafka.common.network.Selector.poll(Selector.java:501)
	at kafka.network.Processor.poll(SocketServer.scala:1110)
	at kafka.network.Processor.run(SocketServer.scala:1014)
	at java.base/java.lang.Thread.run(Thread.java:840)
[2025-02-13 11:12:48,998] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=3310, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1971, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=3309, epochStartOffset=162983, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])], lastFetchTimestamp=1739425368959, lastCaughtUpTimestamp=1739425368959, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=165571, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=563817)])], lastFetchTimestamp=1739425367605, lastCaughtUpTimestamp=1739425364787, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:12:49,088] INFO [RaftManager id=2] Completed transition to Unattached(epoch=3310, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1971, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=3309, epochStartOffset=162983, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])], lastFetchTimestamp=1739425368959, lastCaughtUpTimestamp=1739425368959, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=165571, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=563817)])], lastFetchTimestamp=1739425367605, lastCaughtUpTimestamp=1739425364787, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:12:49,097] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3310, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3309, lastOffset=165571)])]) with epoch 3310 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-13 11:12:49,346] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=3311, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1623, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) from Unattached(epoch=3310, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1971, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:12:49,386] INFO [RaftManager id=2] Completed transition to Unattached(epoch=3311, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1623, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) from Unattached(epoch=3310, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1971, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:12:49,387] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3311, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3309, lastOffset=165571)])]) with epoch 3311 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-13 11:12:49,660] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=3312, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1309, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) from Unattached(epoch=3311, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1623, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:12:49,742] INFO [RaftManager id=2] Completed transition to Unattached(epoch=3312, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1309, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) from Unattached(epoch=3311, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1623, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:12:49,748] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3312, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3309, lastOffset=165571)])]) with epoch 3312 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-13 11:12:50,269] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=3313, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=700, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) from Unattached(epoch=3312, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1309, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:12:50,362] INFO [RaftManager id=2] Completed transition to Unattached(epoch=3313, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=700, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) from Unattached(epoch=3312, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1309, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:12:50,365] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3313, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3309, lastOffset=165571)])]) with epoch 3313 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-13 11:12:50,579] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=3313, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1588, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) from Unattached(epoch=3313, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=700, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:12:50,655] INFO [RaftManager id=2] Completed transition to Unattached(epoch=3313, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1588, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) from Unattached(epoch=3313, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=700, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:12:50,658] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3313, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3309, lastOffset=165580)])]) with epoch 3313 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-13 11:12:50,842] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-13 11:12:50,963] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=3314, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1204, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) from Unattached(epoch=3313, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1588, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:12:51,010] INFO [RaftManager id=2] Completed transition to Unattached(epoch=3314, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1204, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) from Unattached(epoch=3313, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1588, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:12:51,015] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3314, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3309, lastOffset=165571)])]) with epoch 3314 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-13 11:12:52,168] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3315, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@34e35558, 2=org.apache.kafka.raft.CandidateState$VoterState@5ca3cf4c, 3=org.apache.kafka.raft.CandidateState$VoterState@7ab13859}, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])], electionTimeoutMs=1751) from Unattached(epoch=3314, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1204, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:12:52,216] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3315, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@34e35558, 2=org.apache.kafka.raft.CandidateState$VoterState@5ca3cf4c, 3=org.apache.kafka.raft.CandidateState$VoterState@7ab13859}, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])], electionTimeoutMs=1751) from Unattached(epoch=3314, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1204, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:12:52,341] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=3315, epochStartOffset=165580, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3315, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@34e35558, 2=org.apache.kafka.raft.CandidateState$VoterState@5ca3cf4c, 3=org.apache.kafka.raft.CandidateState$VoterState@7ab13859}, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])], electionTimeoutMs=1751) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:12:52,367] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=3315, epochStartOffset=165580, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3315, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@34e35558, 2=org.apache.kafka.raft.CandidateState$VoterState@5ca3cf4c, 3=org.apache.kafka.raft.CandidateState$VoterState@7ab13859}, highWatermark=Optional[LogOffsetMetadata(offset=165580, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564343)])], electionTimeoutMs=1751) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:12:52,392] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 11:12:52,418] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-13 11:12:52,420] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 11:12:52,478] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 11:12:52,486] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-13 11:12:52,488] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 11:12:52,543] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 11:12:52,550] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-13 11:12:52,551] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 11:12:52,602] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 11:12:52,606] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=165581, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564449)]) for the first time for epoch 3315 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=165581, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564449)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=165581, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=564449)])], lastFetchTimestamp=1739425372606, lastCaughtUpTimestamp=1739425372606, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-13 11:12:52,616] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-13 11:12:52,618] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 11:12:52,674] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 11:31:10,805] INFO [SnapshotGenerator id=2] Creating new KRaft snapshot file snapshot 00000000000000167768-0000003315 because we have waited at least 60 minute(s). (org.apache.kafka.image.publisher.SnapshotGenerator)
[2025-02-13 11:31:12,047] INFO [SnapshotEmitter id=2] Successfully wrote snapshot 00000000000000167768-0000003315 (org.apache.kafka.image.publisher.SnapshotEmitter)
[2025-02-13 11:36:47,127] INFO [RaftManager id=2] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are java.util.stream.ReferencePipeline$3@558d9a92 (org.apache.kafka.raft.LeaderState)
[2025-02-13 11:36:47,167] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=3315, voters=[1, 2, 3], electionTimeoutMs=1455, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=3, directoryId=Optional.empty)]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=3315, epochStartOffset=165580, highWatermark=Optional[LogOffsetMetadata(offset=168426, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=768862)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=168426, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=768862)])], lastFetchTimestamp=1739426801770, lastCaughtUpTimestamp=1739426800695, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=168430, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=769089)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=168426, metadata=Optional[(segmentBaseOffset=157608,relativePositionInSegment=768862)])], lastFetchTimestamp=1739426802904, lastCaughtUpTimestamp=1739426800695, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:36:47,304] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1903997718). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 11:36:47,304] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1975349276). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 11:36:47,304] INFO [QuorumController id=2] failAll(NotControllerException): failing maybeFenceReplicas(1517716195). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 11:36:47,305] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(714342784). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 11:36:47,305] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1055192007). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 11:36:47,305] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(549935511). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 11:36:47,305] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1313384182). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 11:36:47,305] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(1155147454). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 11:36:47,306] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(1572441897). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 11:36:47,308] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1202224872). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 11:36:47,308] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1281101821). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 11:36:47,308] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1504067358). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 11:36:47,308] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1215771588). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 11:36:47,308] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1286363932). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 11:36:47,308] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(1612940947). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 11:36:47,309] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(135600966). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-13 11:36:47,331] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-13 11:36:47,375] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 11:36:47,398] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=3316, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1722, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=3315, voters=[1, 2, 3], electionTimeoutMs=1455, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=3, directoryId=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:36:47,445] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 11:36:47,535] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-13 11:36:47,536] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 11:36:47,577] INFO [RaftManager id=2] Completed transition to Unattached(epoch=3316, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1722, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=3315, voters=[1, 2, 3], electionTimeoutMs=1455, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=3, directoryId=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:36:47,586] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3316, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3315, lastOffset=168426)])]) with epoch 3316 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-13 11:36:47,593] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3316, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3315, lastOffset=168427)])]) with epoch 3316 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-13 11:36:47,655] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=3317, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1464, highWatermark=Optional.empty) from Unattached(epoch=3316, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1722, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:36:47,742] INFO [RaftManager id=2] Completed transition to Unattached(epoch=3317, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1464, highWatermark=Optional.empty) from Unattached(epoch=3316, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1722, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:36:47,743] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3317, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3315, lastOffset=168427)])]) with epoch 3317 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-13 11:36:47,992] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=3317, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=3317, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1464, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:36:48,026] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=3317, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=3317, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1464, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-13 11:36:48,094] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 11:36:48,107] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-13 11:36:48,107] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 11:36:48,157] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 11:36:48,179] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-13 11:36:48,179] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 11:36:48,230] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 11:36:48,242] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-13 11:36:48,242] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 11:36:48,285] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Truncating to offset 168427 (kafka.log.UnifiedLog)
[2025-02-13 11:36:48,293] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-13 11:36:48,305] INFO [BrokerLifecycleManager id=2] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-02-13 11:36:48,370] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Loading producer state till offset 168427 with message format version 2 (kafka.log.UnifiedLog$)
[2025-02-13 11:36:48,370] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Reloading from producer snapshot and rebuilding producer state from offset 168427 (kafka.log.UnifiedLog$)
[2025-02-13 11:36:48,371] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=160510, file=/tmp/kafka-logs-node2/__cluster_metadata-0/00000000000000160510.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-13 11:36:48,461] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 168427 with 0 producer ids in 37 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-13 11:36:48,462] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Producer state recovery took 13ms for snapshot load and 79ms for segment recovery from offset 168427 (kafka.log.UnifiedLog$)
[2025-02-13 11:36:48,462] INFO [RaftManager id=2] Truncated to offset 168427 from Fetch response from leader 1 (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-13 11:36:48,617] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=168428, metadata=Optional.empty)] for the first time for epoch 3317 (org.apache.kafka.raft.FollowerState)
