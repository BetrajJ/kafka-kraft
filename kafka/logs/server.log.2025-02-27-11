[2025-02-27 12:06:59,144] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-02-27 12:10:20,997] INFO [RaftManager id=3] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:10:20,998] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6195, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@53a8487d, 2=org.apache.kafka.raft.CandidateState$VoterState@4e67d6d9, 3=org.apache.kafka.raft.CandidateState$VoterState@2c167927}, highWatermark=Optional[LogOffsetMetadata(offset=473905, metadata=Optional.empty)], electionTimeoutMs=1475) from FollowerState(fetchTimeoutMs=2000, epoch=6194, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=473905, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:10:21,830] INFO [RaftManager id=3] Disconnecting from node 2 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-02-27 12:10:21,830] INFO [RaftManager id=3] Cancelled in-flight FETCH request with correlation id 40430 due to node 2 being disconnected (elapsed time since creation: 2009ms, elapsed time since send: 2002ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-02-27 12:10:22,622] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6195, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@53a8487d, 2=org.apache.kafka.raft.CandidateState$VoterState@4e67d6d9, 3=org.apache.kafka.raft.CandidateState$VoterState@2c167927}, highWatermark=Optional[LogOffsetMetadata(offset=473905, metadata=Optional.empty)], electionTimeoutMs=1475) from FollowerState(fetchTimeoutMs=2000, epoch=6194, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=473905, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:10:22,624] INFO [RaftManager id=3] Election has timed out, backing off for 100ms before becoming a candidate again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:10:22,724] INFO [RaftManager id=3] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:10:22,725] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6196, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7b575cac, 2=org.apache.kafka.raft.CandidateState$VoterState@6a2d081b, 3=org.apache.kafka.raft.CandidateState$VoterState@1a8cca99}, highWatermark=Optional[LogOffsetMetadata(offset=473905, metadata=Optional.empty)], electionTimeoutMs=1648) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6195, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@53a8487d, 2=org.apache.kafka.raft.CandidateState$VoterState@4e67d6d9, 3=org.apache.kafka.raft.CandidateState$VoterState@2c167927}, highWatermark=Optional[LogOffsetMetadata(offset=473905, metadata=Optional.empty)], electionTimeoutMs=1475) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:10:22,755] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6196, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7b575cac, 2=org.apache.kafka.raft.CandidateState$VoterState@6a2d081b, 3=org.apache.kafka.raft.CandidateState$VoterState@1a8cca99}, highWatermark=Optional[LogOffsetMetadata(offset=473905, metadata=Optional.empty)], electionTimeoutMs=1648) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6195, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@53a8487d, 2=org.apache.kafka.raft.CandidateState$VoterState@4e67d6d9, 3=org.apache.kafka.raft.CandidateState$VoterState@2c167927}, highWatermark=Optional[LogOffsetMetadata(offset=473905, metadata=Optional.empty)], electionTimeoutMs=1475) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:10:22,850] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6196, epochStartOffset=473906, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6196, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7b575cac, 2=org.apache.kafka.raft.CandidateState$VoterState@6a2d081b, 3=org.apache.kafka.raft.CandidateState$VoterState@1a8cca99}, highWatermark=Optional[LogOffsetMetadata(offset=473905, metadata=Optional.empty)], electionTimeoutMs=1648) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:10:22,874] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6196, epochStartOffset=473906, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6196, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7b575cac, 2=org.apache.kafka.raft.CandidateState$VoterState@6a2d081b, 3=org.apache.kafka.raft.CandidateState$VoterState@1a8cca99}, highWatermark=Optional[LogOffsetMetadata(offset=473905, metadata=Optional.empty)], electionTimeoutMs=1648) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:10:23,007] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-27 12:10:23,007] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-27 12:10:23,022] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-27 12:10:23,023] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-27 12:10:23,073] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-27 12:10:23,080] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-27 12:10:23,081] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-27 12:10:23,094] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=473907, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12856949)]) for the first time for epoch 6196 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=473907, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12856949)])], lastFetchTimestamp=1740638423093, lastCaughtUpTimestamp=1740638423093, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=473907, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12856949)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)] (org.apache.kafka.raft.LeaderState)
[2025-02-27 12:10:23,134] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-27 12:20:24,910] INFO [RaftManager id=3] Disconnecting from node 2 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-02-27 12:20:25,064] INFO [RaftManager id=3] Cancelled in-flight BEGIN_QUORUM_EPOCH request with correlation id 41618 due to node 2 being disconnected (elapsed time since creation: 2029ms, elapsed time since send: 2027ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-02-27 12:20:26,264] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6197, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1700, highWatermark=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6196, epochStartOffset=473906, highWatermark=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])], lastFetchTimestamp=1740639025967, lastCaughtUpTimestamp=1740639025967, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=475100, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942418)])], lastFetchTimestamp=1740639022893, lastCaughtUpTimestamp=1740639022543, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:20:26,377] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6197, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1700, highWatermark=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6196, epochStartOffset=473906, highWatermark=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])], lastFetchTimestamp=1740639025967, lastCaughtUpTimestamp=1740639025967, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=475100, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942418)])], lastFetchTimestamp=1740639022893, lastCaughtUpTimestamp=1740639022543, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:20:26,383] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6197, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6196, lastOffset=475100)])]) with epoch 6197 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:20:26,390] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(995653043). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-27 12:20:26,510] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-27 12:20:26,606] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6198, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1343, highWatermark=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])]) from Unattached(epoch=6197, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1700, highWatermark=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:20:26,639] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6198, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1343, highWatermark=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])]) from Unattached(epoch=6197, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1700, highWatermark=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:20:26,639] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6198, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6196, lastOffset=475100)])]) with epoch 6198 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:20:26,891] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6199, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1059, highWatermark=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])]) from Unattached(epoch=6198, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1343, highWatermark=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:20:26,924] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6199, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1059, highWatermark=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])]) from Unattached(epoch=6198, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1343, highWatermark=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:20:26,924] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6199, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6196, lastOffset=475100)])]) with epoch 6199 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:20:27,330] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6200, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=619, highWatermark=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])]) from Unattached(epoch=6199, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1059, highWatermark=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:20:27,362] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6200, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=619, highWatermark=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])]) from Unattached(epoch=6199, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1059, highWatermark=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:20:27,362] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6200, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6196, lastOffset=475100)])]) with epoch 6200 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:20:27,964] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6201, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@40d93f43, 2=org.apache.kafka.raft.CandidateState$VoterState@37269a76, 3=org.apache.kafka.raft.CandidateState$VoterState@4f21b254}, highWatermark=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])], electionTimeoutMs=1938) from Unattached(epoch=6200, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=619, highWatermark=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:20:28,016] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6201, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@40d93f43, 2=org.apache.kafka.raft.CandidateState$VoterState@37269a76, 3=org.apache.kafka.raft.CandidateState$VoterState@4f21b254}, highWatermark=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])], electionTimeoutMs=1938) from Unattached(epoch=6200, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=619, highWatermark=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:20:28,244] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6201, epochStartOffset=475107, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6201, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@40d93f43, 2=org.apache.kafka.raft.CandidateState$VoterState@37269a76, 3=org.apache.kafka.raft.CandidateState$VoterState@4f21b254}, highWatermark=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])], electionTimeoutMs=1938) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:20:28,322] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6201, epochStartOffset=475107, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6201, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@40d93f43, 2=org.apache.kafka.raft.CandidateState$VoterState@37269a76, 3=org.apache.kafka.raft.CandidateState$VoterState@4f21b254}, highWatermark=Optional[LogOffsetMetadata(offset=475107, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942922)])], electionTimeoutMs=1938) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:20:28,403] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-27 12:20:28,530] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-27 12:20:28,530] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-27 12:20:28,627] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-27 12:20:28,633] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-27 12:20:28,634] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-27 12:20:28,691] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-27 12:20:28,692] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-27 12:20:28,693] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-27 12:20:28,696] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=475108, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12943028)]) for the first time for epoch 6201 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=475108, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12943028)])], lastFetchTimestamp=1740639028696, lastCaughtUpTimestamp=1740639028696, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=475108, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12943028)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=475100, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12942418)])], lastFetchTimestamp=1740639028557, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-27 12:20:28,744] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-27 12:25:01,202] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6202, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1278, highWatermark=Optional[LogOffsetMetadata(offset=475645, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12981631)])]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6201, epochStartOffset=475107, highWatermark=Optional[LogOffsetMetadata(offset=475645, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12981631)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=475644, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12981559)])], lastFetchTimestamp=1740639298578, lastCaughtUpTimestamp=1740639298246, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=475645, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12981631)])], lastFetchTimestamp=1740639301024, lastCaughtUpTimestamp=1740639298578, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=475650, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12981930)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:25:01,277] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6202, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1278, highWatermark=Optional[LogOffsetMetadata(offset=475645, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12981631)])]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6201, epochStartOffset=475107, highWatermark=Optional[LogOffsetMetadata(offset=475645, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12981631)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=475644, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12981559)])], lastFetchTimestamp=1740639298578, lastCaughtUpTimestamp=1740639298246, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=475645, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12981631)])], lastFetchTimestamp=1740639301024, lastCaughtUpTimestamp=1740639298578, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=475650, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12981930)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:25:01,278] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6202, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6201, lastOffset=475645)])]) with epoch 6202 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:25:01,304] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(757836050). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-27 12:25:01,304] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(266503852). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-27 12:25:01,304] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(524730823). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-27 12:25:01,304] INFO [QuorumController id=3] failAll(NotControllerException): failing processBrokerHeartbeat(374307650). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-27 12:25:01,305] INFO [QuorumController id=3] failAll(NotControllerException): failing processBrokerHeartbeat(1725707168). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-27 12:25:01,306] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(2106592817). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-27 12:25:01,306] INFO [QuorumController id=3] failAll(NotControllerException): failing processBrokerHeartbeat(1425121469). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-27 12:25:01,306] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(965297162). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-27 12:25:01,306] INFO [QuorumController id=3] failAll(NotControllerException): failing maybeFenceReplicas(1045377448). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-27 12:25:01,311] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-27 12:25:01,323] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6202, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6201, lastOffset=475645)])]) with epoch 6202 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:25:01,490] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6203, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=990, highWatermark=Optional[LogOffsetMetadata(offset=475645, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12981631)])]) from Unattached(epoch=6202, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1278, highWatermark=Optional[LogOffsetMetadata(offset=475645, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12981631)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:25:01,523] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6203, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=990, highWatermark=Optional[LogOffsetMetadata(offset=475645, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12981631)])]) from Unattached(epoch=6202, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1278, highWatermark=Optional[LogOffsetMetadata(offset=475645, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12981631)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:25:01,523] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6203, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6201, lastOffset=475645)])]) with epoch 6203 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:25:01,523] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6203, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6201, lastOffset=475645)])]) with epoch 6203 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:25:01,559] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6204, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=921, highWatermark=Optional[LogOffsetMetadata(offset=475645, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12981631)])]) from Unattached(epoch=6203, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=990, highWatermark=Optional[LogOffsetMetadata(offset=475645, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12981631)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:25:01,594] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6204, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=921, highWatermark=Optional[LogOffsetMetadata(offset=475645, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12981631)])]) from Unattached(epoch=6203, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=990, highWatermark=Optional[LogOffsetMetadata(offset=475645, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12981631)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:25:01,595] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6204, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6201, lastOffset=475645)])]) with epoch 6204 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:25:01,732] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=6204, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=475645, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12981631)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=6204, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=921, highWatermark=Optional[LogOffsetMetadata(offset=475645, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12981631)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:25:01,779] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=6204, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=475645, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12981631)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=6204, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=921, highWatermark=Optional[LogOffsetMetadata(offset=475645, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=12981631)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:25:01,821] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-27 12:25:01,823] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-27 12:25:01,824] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-27 12:25:01,838] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Truncating to offset 475645 (kafka.log.UnifiedLog)
[2025-02-27 12:25:01,863] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Loading producer state till offset 475645 with message format version 2 (kafka.log.UnifiedLog$)
[2025-02-27 12:25:01,864] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Reloading from producer snapshot and rebuilding producer state from offset 475645 (kafka.log.UnifiedLog$)
[2025-02-27 12:25:01,866] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=472312, file=/tmp/kafka-logs-node3/__cluster_metadata-0/00000000000000472312.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-27 12:25:01,874] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-27 12:25:01,953] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 475645 with 0 producer ids in 11 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-27 12:25:01,954] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Producer state recovery took 13ms for snapshot load and 77ms for segment recovery from offset 475645 (kafka.log.UnifiedLog$)
[2025-02-27 12:25:01,954] INFO [RaftManager id=3] Truncated to offset 475645 from Fetch response from leader 1 (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:27:22,197] INFO [RaftManager id=3] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:27:22,197] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6205, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@496fa279, 2=org.apache.kafka.raft.CandidateState$VoterState@7d2c28e0, 3=org.apache.kafka.raft.CandidateState$VoterState@3253bede}, highWatermark=Optional[LogOffsetMetadata(offset=475917, metadata=Optional.empty)], electionTimeoutMs=1467) from FollowerState(fetchTimeoutMs=2000, epoch=6204, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=475917, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:27:22,198] INFO [RaftManager id=3] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-02-27 12:27:22,198] INFO [RaftManager id=3] Cancelled in-flight FETCH request with correlation id 42433 due to node 1 being disconnected (elapsed time since creation: 2668ms, elapsed time since send: 2668ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-02-27 12:27:22,247] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6205, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@496fa279, 2=org.apache.kafka.raft.CandidateState$VoterState@7d2c28e0, 3=org.apache.kafka.raft.CandidateState$VoterState@3253bede}, highWatermark=Optional[LogOffsetMetadata(offset=475917, metadata=Optional.empty)], electionTimeoutMs=1467) from FollowerState(fetchTimeoutMs=2000, epoch=6204, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=475917, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:27:22,248] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6205, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6204, lastOffset=475919)])]) with epoch 6205 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:27:22,485] INFO [RaftManager id=3] Insufficient remaining votes to become leader (rejected by [1, 2]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:27:22,485] INFO [RaftManager id=3] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:27:22,485] INFO [RaftManager id=3] Attempting durable transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6206, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3bf52d80, 2=org.apache.kafka.raft.CandidateState$VoterState@f3d2ced, 3=org.apache.kafka.raft.CandidateState$VoterState@13ca6ec2}, highWatermark=Optional[LogOffsetMetadata(offset=475917, metadata=Optional.empty)], electionTimeoutMs=1087) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6205, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@496fa279, 2=org.apache.kafka.raft.CandidateState$VoterState@7d2c28e0, 3=org.apache.kafka.raft.CandidateState$VoterState@3253bede}, highWatermark=Optional[LogOffsetMetadata(offset=475917, metadata=Optional.empty)], electionTimeoutMs=1467) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:27:22,531] INFO [RaftManager id=3] Completed transition to CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6206, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3bf52d80, 2=org.apache.kafka.raft.CandidateState$VoterState@f3d2ced, 3=org.apache.kafka.raft.CandidateState$VoterState@13ca6ec2}, highWatermark=Optional[LogOffsetMetadata(offset=475917, metadata=Optional.empty)], electionTimeoutMs=1087) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6205, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@496fa279, 2=org.apache.kafka.raft.CandidateState$VoterState@7d2c28e0, 3=org.apache.kafka.raft.CandidateState$VoterState@3253bede}, highWatermark=Optional[LogOffsetMetadata(offset=475917, metadata=Optional.empty)], electionTimeoutMs=1467) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:27:22,633] INFO [RaftManager id=3] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6206, epochStartOffset=475919, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6206, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3bf52d80, 2=org.apache.kafka.raft.CandidateState$VoterState@f3d2ced, 3=org.apache.kafka.raft.CandidateState$VoterState@13ca6ec2}, highWatermark=Optional[LogOffsetMetadata(offset=475917, metadata=Optional.empty)], electionTimeoutMs=1087) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:27:22,662] INFO [RaftManager id=3] Completed transition to Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6206, epochStartOffset=475919, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) from CandidateState(localId=3, localDirectoryId=B_s3M5qvrILHbTrqu_tnLg,epoch=6206, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3bf52d80, 2=org.apache.kafka.raft.CandidateState$VoterState@f3d2ced, 3=org.apache.kafka.raft.CandidateState$VoterState@13ca6ec2}, highWatermark=Optional[LogOffsetMetadata(offset=475917, metadata=Optional.empty)], electionTimeoutMs=1087) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:27:22,881] INFO [RaftManager id=3] High watermark set to LogOffsetMetadata(offset=475920, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=13001316)]) for the first time for epoch 6206 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=475920, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=13001316)])], lastFetchTimestamp=1740639442881, lastCaughtUpTimestamp=1740639442881, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=475920, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=13001316)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-27 12:27:24,402] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-27 12:27:24,403] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-27 12:29:29,539] INFO [RaftManager id=3] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are java.util.stream.ReferencePipeline$3@6df7665e (org.apache.kafka.raft.LeaderState)
[2025-02-27 12:29:29,580] INFO [RaftManager id=3] Completed transition to ResignedState(localId=3, epoch=6206, voters=[1, 2, 3], electionTimeoutMs=1529, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=2, directoryId=Optional.empty)]) from Leader(localReplicaKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), epoch=6206, epochStartOffset=475919, highWatermark=Optional[LogOffsetMetadata(offset=476165, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=13018895)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=476165, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=13018895)])], lastFetchTimestamp=1740639566491, lastCaughtUpTimestamp=1740639566491, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=476165, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=13018895)])], lastFetchTimestamp=1740639566491, lastCaughtUpTimestamp=1740639566491, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=476166, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=13018967)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:29:29,583] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6207, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1692, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=6206, voters=[1, 2, 3], electionTimeoutMs=1529, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=2, directoryId=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:29:29,627] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6207, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1692, highWatermark=Optional.empty) from ResignedState(localId=3, epoch=6206, voters=[1, 2, 3], electionTimeoutMs=1529, unackedVoters=[1, 2], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=2, directoryId=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:29:29,629] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6207, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6206, lastOffset=476165)])]) with epoch 6207 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:29:29,629] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(33749485). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-27 12:29:29,629] INFO [QuorumController id=3] failAll(NotControllerException): failing writeNoOpRecord(249490637). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-27 12:29:29,629] INFO [QuorumController id=3] failAll(NotControllerException): failing processBrokerHeartbeat(1084145375). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-27 12:29:29,629] INFO [QuorumController id=3] failAll(NotControllerException): failing processBrokerHeartbeat(286786205). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-27 12:29:29,629] INFO [QuorumController id=3] failAll(NotControllerException): failing processBrokerHeartbeat(79711426). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-27 12:29:29,630] INFO [NodeToControllerChannelManager id=3 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-27 12:29:29,631] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6207, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6206, lastOffset=476165)])]) with epoch 6207 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:29:29,664] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6208, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1611, highWatermark=Optional.empty) from Unattached(epoch=6207, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1692, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:29:29,754] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6208, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1611, highWatermark=Optional.empty) from Unattached(epoch=6207, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1692, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:29:29,755] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6208, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6206, lastOffset=476165)])]) with epoch 6208 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:29:29,755] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6208, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6206, lastOffset=476165)])]) with epoch 6208 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:29:30,130] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6209, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1146, highWatermark=Optional.empty) from Unattached(epoch=6208, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1611, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:29:30,247] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6209, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1146, highWatermark=Optional.empty) from Unattached(epoch=6208, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1611, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:29:30,247] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6209, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6206, lastOffset=476165)])]) with epoch 6209 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:29:30,247] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6209, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6206, lastOffset=476165)])]) with epoch 6209 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:29:30,574] INFO [RaftManager id=3] Attempting durable transition to Unattached(epoch=6210, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=701, highWatermark=Optional.empty) from Unattached(epoch=6209, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1146, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:29:30,659] INFO [RaftManager id=3] Completed transition to Unattached(epoch=6210, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=701, highWatermark=Optional.empty) from Unattached(epoch=6209, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1146, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:29:30,660] INFO [RaftManager id=3] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=3, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=6210, candidateId=2, candidateDirectoryId=4SvYonARtmIsmjtA1FOevg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=6206, lastOffset=476165)])]) with epoch 6210 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:29:30,889] INFO [RaftManager id=3] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=6210, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=6210, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=701, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:29:30,926] INFO [RaftManager id=3] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=6210, leader=2, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19093}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=6210, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=701, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-27 12:29:30,938] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Truncating to offset 476165 (kafka.log.UnifiedLog)
[2025-02-27 12:29:30,939] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Loading producer state till offset 476165 with message format version 2 (kafka.log.UnifiedLog$)
[2025-02-27 12:29:30,939] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Reloading from producer snapshot and rebuilding producer state from offset 476165 (kafka.log.UnifiedLog$)
[2025-02-27 12:29:30,939] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=475645, file=/tmp/kafka-logs-node3/__cluster_metadata-0/00000000000000475645.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-27 12:29:30,955] INFO [broker-3-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-27 12:29:30,971] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 476165 with 0 producer ids in 31 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-27 12:29:30,972] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node3] Producer state recovery took 1ms for snapshot load and 32ms for segment recovery from offset 476165 (kafka.log.UnifiedLog$)
[2025-02-27 12:29:30,972] INFO [RaftManager id=3] Truncated to offset 476165 from Fetch response from leader 2 (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-27 12:29:31,624] INFO [RaftManager id=3] High watermark set to Optional[LogOffsetMetadata(offset=476166, metadata=Optional.empty)] for the first time for epoch 6210 (org.apache.kafka.raft.FollowerState)
[2025-02-27 12:29:58,397] INFO [SnapshotGenerator id=3] Creating new KRaft snapshot file snapshot 00000000000000476219-0000006210 because we have waited at least 60 minute(s). (org.apache.kafka.image.publisher.SnapshotGenerator)
[2025-02-27 12:29:58,989] INFO [SnapshotEmitter id=3] Successfully wrote snapshot 00000000000000476219-0000006210 (org.apache.kafka.image.publisher.SnapshotEmitter)
[2025-02-27 12:39:26,937] INFO [RaftManager id=3] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
