[2025-03-05 13:02:42,395] INFO [SnapshotGenerator id=2] Creating new KRaft snapshot file snapshot 00000000000000662475-0000010439 because we have waited at least 60 minute(s). (org.apache.kafka.image.publisher.SnapshotGenerator)
[2025-03-05 13:02:42,500] INFO [SnapshotEmitter id=2] Successfully wrote snapshot 00000000000000662475-0000010439 (org.apache.kafka.image.publisher.SnapshotEmitter)
[2025-03-05 13:14:05,527] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Disconnecting from node 2 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-03-05 13:14:05,583] INFO [RaftManager id=2] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are java.util.stream.ReferencePipeline$3@6aae5583 (org.apache.kafka.raft.LeaderState)
[2025-03-05 13:14:05,861] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 29271 due to node 2 being disconnected (elapsed time since creation: 5939ms, elapsed time since send: 5939ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-03-05 13:14:05,884] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-03-05 13:14:05,889] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=10439, voters=[1, 2, 3], electionTimeoutMs=1959, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=3, directoryId=Optional.empty)]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=10439, epochStartOffset=660465, highWatermark=Optional[LogOffsetMetadata(offset=663817, metadata=Optional[(segmentBaseOffset=573793,relativePositionInSegment=6454438)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=663817, metadata=Optional[(segmentBaseOffset=573793,relativePositionInSegment=6454438)])], lastFetchTimestamp=1741160639585, lastCaughtUpTimestamp=1741160638613, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=663818, metadata=Optional[(segmentBaseOffset=573793,relativePositionInSegment=6454510)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=663817, metadata=Optional[(segmentBaseOffset=573793,relativePositionInSegment=6454438)])], lastFetchTimestamp=1741160639585, lastCaughtUpTimestamp=1741160638555, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:14:05,904] INFO [BrokerLifecycleManager id=2] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-03-05 13:14:06,047] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=10441, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1487, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=10439, voters=[1, 2, 3], electionTimeoutMs=1959, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=3, directoryId=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:14:06,113] INFO [RaftManager id=2] Completed transition to Unattached(epoch=10441, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1487, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=10439, voters=[1, 2, 3], electionTimeoutMs=1959, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=3, directoryId=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:14:06,123] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=10441, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1567, highWatermark=Optional.empty) from Unattached(epoch=10441, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1487, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:14:06,154] INFO [RaftManager id=2] Completed transition to Unattached(epoch=10441, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1567, highWatermark=Optional.empty) from Unattached(epoch=10441, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1487, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:14:06,161] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=10441, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=10439, lastOffset=663818)])]) with epoch 10441 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-03-05 13:14:06,164] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(241899139). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-03-05 13:14:06,164] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1828939371). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-03-05 13:14:06,164] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(947664049). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-03-05 13:14:06,165] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(354554187). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-03-05 13:14:06,165] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(1135333986). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-03-05 13:14:06,165] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(904774722). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-03-05 13:14:06,165] INFO [QuorumController id=2] failAll(NotControllerException): failing maybeFenceReplicas(1819129842). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-03-05 13:14:06,171] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(1765821309). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-03-05 13:14:06,171] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(1961213173). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-03-05 13:14:06,175] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=10441, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=10439, lastOffset=663818)])]) with epoch 10441 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-03-05 13:14:06,194] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-03-05 13:14:06,303] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=10441, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=10441, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1567, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:14:06,360] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=10441, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=10441, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1567, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:14:06,396] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-03-05 13:14:06,428] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=663819, metadata=Optional.empty)] for the first time for epoch 10441 (org.apache.kafka.raft.FollowerState)
[2025-03-05 13:24:06,256] INFO [RaftManager id=2] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-03-05 13:35:21,869] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=10442, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1937, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=10441, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:35:21,951] INFO [RaftManager id=2] Completed transition to Unattached(epoch=10442, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1937, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) from FollowerState(fetchTimeoutMs=2000, epoch=10441, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:35:21,952] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=10442, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=10441, lastOffset=666359)])]) with epoch 10442 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-03-05 13:35:22,033] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=10443, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1773, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) from Unattached(epoch=10442, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1937, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:35:22,110] INFO [RaftManager id=2] Completed transition to Unattached(epoch=10443, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1773, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) from Unattached(epoch=10442, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1937, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:35:22,111] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=10443, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=10441, lastOffset=666359)])]) with epoch 10443 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-03-05 13:35:22,396] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=10444, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1410, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) from Unattached(epoch=10443, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1773, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:35:22,478] INFO [RaftManager id=2] Completed transition to Unattached(epoch=10444, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1410, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) from Unattached(epoch=10443, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1773, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:35:22,479] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=10444, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=10441, lastOffset=666359)])]) with epoch 10444 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-03-05 13:35:22,643] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=10445, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1164, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) from Unattached(epoch=10444, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1410, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:35:22,762] INFO [RaftManager id=2] Completed transition to Unattached(epoch=10445, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1164, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) from Unattached(epoch=10444, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1410, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:35:22,762] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=10445, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=10441, lastOffset=666359)])]) with epoch 10445 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-03-05 13:35:23,315] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=10446, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=492, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) from Unattached(epoch=10445, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1164, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:35:23,394] INFO [RaftManager id=2] Completed transition to Unattached(epoch=10446, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=492, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) from Unattached(epoch=10445, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1164, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:35:23,394] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=10446, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=10441, lastOffset=666359)])]) with epoch 10446 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-03-05 13:35:23,484] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=10447, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=323, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) from Unattached(epoch=10446, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=492, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:35:23,526] INFO [RaftManager id=2] Completed transition to Unattached(epoch=10447, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=323, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) from Unattached(epoch=10446, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=492, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:35:23,526] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=10447, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1145, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) from Unattached(epoch=10447, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=323, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:35:23,584] INFO [RaftManager id=2] Completed transition to Unattached(epoch=10447, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1145, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) from Unattached(epoch=10447, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=323, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:35:23,584] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=10447, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=10441, lastOffset=666365)])]) with epoch 10447 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-03-05 13:35:23,776] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-03-05 13:35:23,825] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=10447, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=10447, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1145, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:35:23,878] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=10447, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=10447, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1145, highWatermark=Optional[LogOffsetMetadata(offset=666361, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:35:23,978] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-03-05 13:35:24,175] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-03-05 13:35:24,175] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-03-05 13:35:24,315] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-03-05 13:35:24,319] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-03-05 13:35:24,320] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-03-05 13:35:24,375] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-03-05 13:35:24,379] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-03-05 13:35:24,379] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-03-05 13:35:24,429] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-03-05 13:40:13,676] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-03-05 13:40:14,454] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=10448, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7d32e6b2, 2=org.apache.kafka.raft.CandidateState$VoterState@33c6dad9, 3=org.apache.kafka.raft.CandidateState$VoterState@725816bf}, highWatermark=Optional[LogOffsetMetadata(offset=666938, metadata=Optional.empty)], electionTimeoutMs=1672) from FollowerState(fetchTimeoutMs=2000, epoch=10447, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=666938, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:40:14,667] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=10448, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7d32e6b2, 2=org.apache.kafka.raft.CandidateState$VoterState@33c6dad9, 3=org.apache.kafka.raft.CandidateState$VoterState@725816bf}, highWatermark=Optional[LogOffsetMetadata(offset=666938, metadata=Optional.empty)], electionTimeoutMs=1672) from FollowerState(fetchTimeoutMs=2000, epoch=10447, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=666938, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:40:14,673] INFO [RaftManager id=2] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-03-05 13:40:14,673] INFO [RaftManager id=2] Cancelled in-flight FETCH request with correlation id 94151 due to node 1 being disconnected (elapsed time since creation: 2003ms, elapsed time since send: 2002ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-03-05 13:40:14,807] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=10448, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=10447, lastOffset=666939)])]) with epoch 10448 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-03-05 13:40:15,192] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=10449, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=560, highWatermark=Optional[LogOffsetMetadata(offset=666938, metadata=Optional.empty)]) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=10448, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7d32e6b2, 2=org.apache.kafka.raft.CandidateState$VoterState@33c6dad9, 3=org.apache.kafka.raft.CandidateState$VoterState@725816bf}, highWatermark=Optional[LogOffsetMetadata(offset=666938, metadata=Optional.empty)], electionTimeoutMs=1672) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:40:15,197] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-03-05 13:40:15,597] INFO [RaftManager id=2] Completed transition to Unattached(epoch=10449, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=560, highWatermark=Optional[LogOffsetMetadata(offset=666938, metadata=Optional.empty)]) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=10448, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7d32e6b2, 2=org.apache.kafka.raft.CandidateState$VoterState@33c6dad9, 3=org.apache.kafka.raft.CandidateState$VoterState@725816bf}, highWatermark=Optional[LogOffsetMetadata(offset=666938, metadata=Optional.empty)], electionTimeoutMs=1672) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:40:15,597] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=10449, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1182, highWatermark=Optional[LogOffsetMetadata(offset=666938, metadata=Optional.empty)]) from Unattached(epoch=10449, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=560, highWatermark=Optional[LogOffsetMetadata(offset=666938, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:40:15,690] INFO [RaftManager id=2] Completed transition to Unattached(epoch=10449, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1182, highWatermark=Optional[LogOffsetMetadata(offset=666938, metadata=Optional.empty)]) from Unattached(epoch=10449, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=560, highWatermark=Optional[LogOffsetMetadata(offset=666938, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:40:15,691] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=10449, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=10447, lastOffset=666939)])]) with epoch 10449 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-03-05 13:40:15,990] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=10449, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=666938, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=10449, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1182, highWatermark=Optional[LogOffsetMetadata(offset=666938, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:40:16,038] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=10449, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=666938, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=10449, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1182, highWatermark=Optional[LogOffsetMetadata(offset=666938, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:40:16,102] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-03-05 13:40:16,105] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-03-05 13:40:16,105] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-03-05 13:40:16,156] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-03-05 13:50:15,236] INFO [RaftManager id=2] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-03-05 13:54:29,749] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-03-05 13:54:29,760] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=10450, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1eba764e, 2=org.apache.kafka.raft.CandidateState$VoterState@98f374f, 3=org.apache.kafka.raft.CandidateState$VoterState@5d966cac}, highWatermark=Optional[LogOffsetMetadata(offset=668639, metadata=Optional.empty)], electionTimeoutMs=1813) from FollowerState(fetchTimeoutMs=2000, epoch=10449, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=668639, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:54:29,842] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=10450, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1eba764e, 2=org.apache.kafka.raft.CandidateState$VoterState@98f374f, 3=org.apache.kafka.raft.CandidateState$VoterState@5d966cac}, highWatermark=Optional[LogOffsetMetadata(offset=668639, metadata=Optional.empty)], electionTimeoutMs=1813) from FollowerState(fetchTimeoutMs=2000, epoch=10449, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=668639, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:54:29,862] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=10450, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=10449, lastOffset=668640)])]) with epoch 10450 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-03-05 13:54:29,870] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-03-05 13:54:29,870] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-03-05 13:54:29,871] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=10451, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@23aa814d, 2=org.apache.kafka.raft.CandidateState$VoterState@6eef8b70, 3=org.apache.kafka.raft.CandidateState$VoterState@1eaafcad}, highWatermark=Optional[LogOffsetMetadata(offset=668639, metadata=Optional.empty)], electionTimeoutMs=1613) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=10450, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1eba764e, 2=org.apache.kafka.raft.CandidateState$VoterState@98f374f, 3=org.apache.kafka.raft.CandidateState$VoterState@5d966cac}, highWatermark=Optional[LogOffsetMetadata(offset=668639, metadata=Optional.empty)], electionTimeoutMs=1813) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:54:29,882] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-03-05 13:54:29,891] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=10451, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@23aa814d, 2=org.apache.kafka.raft.CandidateState$VoterState@6eef8b70, 3=org.apache.kafka.raft.CandidateState$VoterState@1eaafcad}, highWatermark=Optional[LogOffsetMetadata(offset=668639, metadata=Optional.empty)], electionTimeoutMs=1613) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=10450, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1eba764e, 2=org.apache.kafka.raft.CandidateState$VoterState@98f374f, 3=org.apache.kafka.raft.CandidateState$VoterState@5d966cac}, highWatermark=Optional[LogOffsetMetadata(offset=668639, metadata=Optional.empty)], electionTimeoutMs=1813) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:54:29,960] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=10451, epochStartOffset=668640, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=10451, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@23aa814d, 2=org.apache.kafka.raft.CandidateState$VoterState@6eef8b70, 3=org.apache.kafka.raft.CandidateState$VoterState@1eaafcad}, highWatermark=Optional[LogOffsetMetadata(offset=668639, metadata=Optional.empty)], electionTimeoutMs=1613) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:54:29,990] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=10451, epochStartOffset=668640, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=10451, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@23aa814d, 2=org.apache.kafka.raft.CandidateState$VoterState@6eef8b70, 3=org.apache.kafka.raft.CandidateState$VoterState@1eaafcad}, highWatermark=Optional[LogOffsetMetadata(offset=668639, metadata=Optional.empty)], electionTimeoutMs=1613) (org.apache.kafka.raft.QuorumState)
[2025-03-05 13:54:30,083] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-03-05 13:54:30,113] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-03-05 13:54:30,113] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-03-05 13:54:30,119] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=668641, metadata=Optional[(segmentBaseOffset=573793,relativePositionInSegment=6801475)]) for the first time for epoch 10451 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=668641, metadata=Optional[(segmentBaseOffset=573793,relativePositionInSegment=6801475)])], lastFetchTimestamp=1741163070112, lastCaughtUpTimestamp=1741163070112, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=668641, metadata=Optional[(segmentBaseOffset=573793,relativePositionInSegment=6801475)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-03-05 13:54:30,166] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-03-05 13:57:26,024] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Incremented log start offset to 440654 due to snapshot generated (kafka.log.UnifiedLog)
[2025-03-05 13:57:26,058] INFO [MetadataLog partition=__cluster_metadata-0, nodeId=2] Marking snapshot OffsetAndEpoch(offset=428208, epoch=6008) for deletion because its timestamp (1740558406207) is now (1741163245994) older than the
retention (604800000) (kafka.raft.KafkaMetadataLog)
[2025-03-05 13:58:26,107] INFO Deleted snapshot files for snapshot OffsetAndEpoch(offset=428208, epoch=6008). (org.apache.kafka.snapshot.Snapshots)
