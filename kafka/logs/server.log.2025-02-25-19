[2025-02-25 22:04:48,835] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:04:48,837] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5783, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@18b47f75, 2=org.apache.kafka.raft.CandidateState$VoterState@6c82fef0, 3=org.apache.kafka.raft.CandidateState$VoterState@45612619}, highWatermark=Optional[LogOffsetMetadata(offset=394146, metadata=Optional.empty)], electionTimeoutMs=1613) from FollowerState(fetchTimeoutMs=2000, epoch=5782, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=394146, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:04:48,911] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5783, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@18b47f75, 2=org.apache.kafka.raft.CandidateState$VoterState@6c82fef0, 3=org.apache.kafka.raft.CandidateState$VoterState@45612619}, highWatermark=Optional[LogOffsetMetadata(offset=394146, metadata=Optional.empty)], electionTimeoutMs=1613) from FollowerState(fetchTimeoutMs=2000, epoch=5782, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=394146, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:04:48,988] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5783, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5782, lastOffset=394147)])]) with epoch 5783 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:04:49,014] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:04:49,115] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=5783, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=394146, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5783, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@18b47f75, 2=org.apache.kafka.raft.CandidateState$VoterState@6c82fef0, 3=org.apache.kafka.raft.CandidateState$VoterState@45612619}, highWatermark=Optional[LogOffsetMetadata(offset=394146, metadata=Optional.empty)], electionTimeoutMs=1613) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:04:49,163] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=5783, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=394146, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5783, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@18b47f75, 2=org.apache.kafka.raft.CandidateState$VoterState@6c82fef0, 3=org.apache.kafka.raft.CandidateState$VoterState@45612619}, highWatermark=Optional[LogOffsetMetadata(offset=394146, metadata=Optional.empty)], electionTimeoutMs=1613) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:04:50,416] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:04:50,417] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:14:07,637] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:08,746] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5784, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1ff5b733, 2=org.apache.kafka.raft.CandidateState$VoterState@349d265e, 3=org.apache.kafka.raft.CandidateState$VoterState@275ebab4}, highWatermark=Optional[LogOffsetMetadata(offset=395254, metadata=Optional.empty)], electionTimeoutMs=1928) from FollowerState(fetchTimeoutMs=2000, epoch=5783, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=395254, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:09,717] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5784, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1ff5b733, 2=org.apache.kafka.raft.CandidateState$VoterState@349d265e, 3=org.apache.kafka.raft.CandidateState$VoterState@275ebab4}, highWatermark=Optional[LogOffsetMetadata(offset=395254, metadata=Optional.empty)], electionTimeoutMs=1928) from FollowerState(fetchTimeoutMs=2000, epoch=5783, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=395254, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:09,799] INFO [RaftManager id=2] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:14:09,829] INFO [RaftManager id=2] Cancelled in-flight FETCH request with correlation id 3253 due to node 3 being disconnected (elapsed time since creation: 2002ms, elapsed time since send: 2002ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:14:10,013] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5784, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5783, lastOffset=395255)])]) with epoch 5784 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:10,087] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:10,088] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:10,088] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5785, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@9f145ab, 2=org.apache.kafka.raft.CandidateState$VoterState@3b8f2789, 3=org.apache.kafka.raft.CandidateState$VoterState@66fd5970}, highWatermark=Optional[LogOffsetMetadata(offset=395254, metadata=Optional.empty)], electionTimeoutMs=1725) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5784, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1ff5b733, 2=org.apache.kafka.raft.CandidateState$VoterState@349d265e, 3=org.apache.kafka.raft.CandidateState$VoterState@275ebab4}, highWatermark=Optional[LogOffsetMetadata(offset=395254, metadata=Optional.empty)], electionTimeoutMs=1928) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:10,110] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5785, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@9f145ab, 2=org.apache.kafka.raft.CandidateState$VoterState@3b8f2789, 3=org.apache.kafka.raft.CandidateState$VoterState@66fd5970}, highWatermark=Optional[LogOffsetMetadata(offset=395254, metadata=Optional.empty)], electionTimeoutMs=1725) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5784, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1ff5b733, 2=org.apache.kafka.raft.CandidateState$VoterState@349d265e, 3=org.apache.kafka.raft.CandidateState$VoterState@275ebab4}, highWatermark=Optional[LogOffsetMetadata(offset=395254, metadata=Optional.empty)], electionTimeoutMs=1928) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:10,163] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:10,164] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5785, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5783, lastOffset=395255)])]) with epoch 5785 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:10,171] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:14:10,263] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:10,263] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5786, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3424d401, 2=org.apache.kafka.raft.CandidateState$VoterState@377b0333, 3=org.apache.kafka.raft.CandidateState$VoterState@758ad93a}, highWatermark=Optional[LogOffsetMetadata(offset=395254, metadata=Optional.empty)], electionTimeoutMs=1647) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5785, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@9f145ab, 2=org.apache.kafka.raft.CandidateState$VoterState@3b8f2789, 3=org.apache.kafka.raft.CandidateState$VoterState@66fd5970}, highWatermark=Optional[LogOffsetMetadata(offset=395254, metadata=Optional.empty)], electionTimeoutMs=1725) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:10,299] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5786, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3424d401, 2=org.apache.kafka.raft.CandidateState$VoterState@377b0333, 3=org.apache.kafka.raft.CandidateState$VoterState@758ad93a}, highWatermark=Optional[LogOffsetMetadata(offset=395254, metadata=Optional.empty)], electionTimeoutMs=1647) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5785, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@9f145ab, 2=org.apache.kafka.raft.CandidateState$VoterState@3b8f2789, 3=org.apache.kafka.raft.CandidateState$VoterState@66fd5970}, highWatermark=Optional[LogOffsetMetadata(offset=395254, metadata=Optional.empty)], electionTimeoutMs=1725) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:10,347] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5786, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5783, lastOffset=395255)])]) with epoch 5786 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:10,387] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:10,790] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:10,798] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5787, retries=4, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@79b03822, 2=org.apache.kafka.raft.CandidateState$VoterState@6ba66fc9, 3=org.apache.kafka.raft.CandidateState$VoterState@42b8b15}, highWatermark=Optional[LogOffsetMetadata(offset=395254, metadata=Optional.empty)], electionTimeoutMs=1043) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5786, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3424d401, 2=org.apache.kafka.raft.CandidateState$VoterState@377b0333, 3=org.apache.kafka.raft.CandidateState$VoterState@758ad93a}, highWatermark=Optional[LogOffsetMetadata(offset=395254, metadata=Optional.empty)], electionTimeoutMs=1647) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:10,843] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5787, retries=4, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@79b03822, 2=org.apache.kafka.raft.CandidateState$VoterState@6ba66fc9, 3=org.apache.kafka.raft.CandidateState$VoterState@42b8b15}, highWatermark=Optional[LogOffsetMetadata(offset=395254, metadata=Optional.empty)], electionTimeoutMs=1043) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5786, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3424d401, 2=org.apache.kafka.raft.CandidateState$VoterState@377b0333, 3=org.apache.kafka.raft.CandidateState$VoterState@758ad93a}, highWatermark=Optional[LogOffsetMetadata(offset=395254, metadata=Optional.empty)], electionTimeoutMs=1647) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:11,207] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5787, epochStartOffset=395255, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5787, retries=4, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@79b03822, 2=org.apache.kafka.raft.CandidateState$VoterState@6ba66fc9, 3=org.apache.kafka.raft.CandidateState$VoterState@42b8b15}, highWatermark=Optional[LogOffsetMetadata(offset=395254, metadata=Optional.empty)], electionTimeoutMs=1043) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:11,229] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5787, epochStartOffset=395255, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5787, retries=4, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@79b03822, 2=org.apache.kafka.raft.CandidateState$VoterState@6ba66fc9, 3=org.apache.kafka.raft.CandidateState$VoterState@42b8b15}, highWatermark=Optional[LogOffsetMetadata(offset=395254, metadata=Optional.empty)], electionTimeoutMs=1043) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:11,280] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:14:11,490] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:14:11,491] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:14:11,542] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:14:11,568] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:14:11,571] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:14:11,626] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:14:11,653] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:14:11,653] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:14:11,703] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:14:11,707] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:14:11,707] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:14:11,758] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:14:11,771] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:14:11,771] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:14:11,823] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:14:11,862] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:14:11,868] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:14:11,878] INFO [BrokerLifecycleManager id=2] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-02-25 22:14:11,966] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=5788, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1241, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5787, epochStartOffset=395255, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=395256, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7234577)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:11,993] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:14:11,994] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:14:12,009] INFO [RaftManager id=2] Completed transition to Unattached(epoch=5788, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1241, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5787, epochStartOffset=395255, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=395256, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7234577)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:12,010] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5788, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5783, lastOffset=395258)])]) with epoch 5788 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:12,014] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=5788, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=5788, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1241, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:12,054] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=5788, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=5788, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1241, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:12,146] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:14:12,182] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Truncating to offset 395255 (kafka.log.UnifiedLog)
[2025-02-25 22:14:12,213] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Loading producer state till offset 395255 with message format version 2 (kafka.log.UnifiedLog$)
[2025-02-25 22:14:12,214] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Reloading from producer snapshot and rebuilding producer state from offset 395255 (kafka.log.UnifiedLog$)
[2025-02-25 22:14:12,214] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=391921, file=/tmp/kafka-logs-node2/__cluster_metadata-0/00000000000000391921.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-25 22:14:12,403] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 395255 with 0 producer ids in 31 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-25 22:14:12,404] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Producer state recovery took 78ms for snapshot load and 112ms for segment recovery from offset 395255 (kafka.log.UnifiedLog$)
[2025-02-25 22:14:12,405] INFO [RaftManager id=2] Truncated to offset 395255 from Fetch response from leader 3 (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:12,523] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=395259, metadata=Optional.empty)] for the first time for epoch 5788 (org.apache.kafka.raft.FollowerState)
[2025-02-25 22:14:16,068] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:16,068] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5789, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5ecd3eb2, 2=org.apache.kafka.raft.CandidateState$VoterState@537d5d2a, 3=org.apache.kafka.raft.CandidateState$VoterState@6207a9e6}, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)], electionTimeoutMs=1357) from FollowerState(fetchTimeoutMs=2000, epoch=5788, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:16,220] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5789, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5ecd3eb2, 2=org.apache.kafka.raft.CandidateState$VoterState@537d5d2a, 3=org.apache.kafka.raft.CandidateState$VoterState@6207a9e6}, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)], electionTimeoutMs=1357) from FollowerState(fetchTimeoutMs=2000, epoch=5788, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:16,442] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:16,494] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:16,506] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5790, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@38e322d, 2=org.apache.kafka.raft.CandidateState$VoterState@3481b440, 3=org.apache.kafka.raft.CandidateState$VoterState@d2c3bf7}, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)], electionTimeoutMs=1908) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5789, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5ecd3eb2, 2=org.apache.kafka.raft.CandidateState$VoterState@537d5d2a, 3=org.apache.kafka.raft.CandidateState$VoterState@6207a9e6}, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)], electionTimeoutMs=1357) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:16,539] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5790, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@38e322d, 2=org.apache.kafka.raft.CandidateState$VoterState@3481b440, 3=org.apache.kafka.raft.CandidateState$VoterState@d2c3bf7}, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)], electionTimeoutMs=1908) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5789, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5ecd3eb2, 2=org.apache.kafka.raft.CandidateState$VoterState@537d5d2a, 3=org.apache.kafka.raft.CandidateState$VoterState@6207a9e6}, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)], electionTimeoutMs=1357) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:16,635] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:16,936] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:16,936] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5791, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@52bbfb2d, 2=org.apache.kafka.raft.CandidateState$VoterState@2056b40d, 3=org.apache.kafka.raft.CandidateState$VoterState@19cc37f3}, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)], electionTimeoutMs=1402) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5790, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@38e322d, 2=org.apache.kafka.raft.CandidateState$VoterState@3481b440, 3=org.apache.kafka.raft.CandidateState$VoterState@d2c3bf7}, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)], electionTimeoutMs=1908) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:17,118] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5791, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@52bbfb2d, 2=org.apache.kafka.raft.CandidateState$VoterState@2056b40d, 3=org.apache.kafka.raft.CandidateState$VoterState@19cc37f3}, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)], electionTimeoutMs=1402) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5790, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@38e322d, 2=org.apache.kafka.raft.CandidateState$VoterState@3481b440, 3=org.apache.kafka.raft.CandidateState$VoterState@d2c3bf7}, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)], electionTimeoutMs=1908) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:17,238] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:17,338] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:17,343] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5792, retries=4, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@75d344be, 2=org.apache.kafka.raft.CandidateState$VoterState@783cabba, 3=org.apache.kafka.raft.CandidateState$VoterState@6ddf8e6c}, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)], electionTimeoutMs=1493) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5791, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@52bbfb2d, 2=org.apache.kafka.raft.CandidateState$VoterState@2056b40d, 3=org.apache.kafka.raft.CandidateState$VoterState@19cc37f3}, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)], electionTimeoutMs=1402) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:17,388] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5792, retries=4, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@75d344be, 2=org.apache.kafka.raft.CandidateState$VoterState@783cabba, 3=org.apache.kafka.raft.CandidateState$VoterState@6ddf8e6c}, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)], electionTimeoutMs=1493) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5791, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@52bbfb2d, 2=org.apache.kafka.raft.CandidateState$VoterState@2056b40d, 3=org.apache.kafka.raft.CandidateState$VoterState@19cc37f3}, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)], electionTimeoutMs=1402) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:17,475] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:18,086] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:14:18,189] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=5793, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=645, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)]) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5792, retries=4, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@75d344be, 2=org.apache.kafka.raft.CandidateState$VoterState@783cabba, 3=org.apache.kafka.raft.CandidateState$VoterState@6ddf8e6c}, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)], electionTimeoutMs=1493) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:18,246] INFO [RaftManager id=2] Completed transition to Unattached(epoch=5793, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=645, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)]) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5792, retries=4, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@75d344be, 2=org.apache.kafka.raft.CandidateState$VoterState@783cabba, 3=org.apache.kafka.raft.CandidateState$VoterState@6ddf8e6c}, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)], electionTimeoutMs=1493) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:18,246] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=5793, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1173, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)]) from Unattached(epoch=5793, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=645, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:18,440] INFO [RaftManager id=2] Completed transition to Unattached(epoch=5793, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1173, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)]) from Unattached(epoch=5793, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=645, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:18,441] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5793, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5788, lastOffset=395267)])]) with epoch 5793 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:18,447] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=5793, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=5793, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1173, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:18,515] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=5793, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=5793, votedKey=ReplicaKey(id=3, directoryId=Optional[B_s3M5qvrILHbTrqu_tnLg]), voters=[1, 2, 3], electionTimeoutMs=1173, highWatermark=Optional[LogOffsetMetadata(offset=395262, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:18,586] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:14:56,305] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:56,305] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5794, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@38e6fe9d, 2=org.apache.kafka.raft.CandidateState$VoterState@53359e01, 3=org.apache.kafka.raft.CandidateState$VoterState@42d49314}, highWatermark=Optional[LogOffsetMetadata(offset=395338, metadata=Optional.empty)], electionTimeoutMs=1594) from FollowerState(fetchTimeoutMs=2000, epoch=5793, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=395338, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:56,439] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5794, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@38e6fe9d, 2=org.apache.kafka.raft.CandidateState$VoterState@53359e01, 3=org.apache.kafka.raft.CandidateState$VoterState@42d49314}, highWatermark=Optional[LogOffsetMetadata(offset=395338, metadata=Optional.empty)], electionTimeoutMs=1594) from FollowerState(fetchTimeoutMs=2000, epoch=5793, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=395338, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:56,471] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5794, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5793, lastOffset=395339)])]) with epoch 5794 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:56,494] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:56,495] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:14:56,594] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:56,595] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5795, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@26aa2437, 2=org.apache.kafka.raft.CandidateState$VoterState@29372469, 3=org.apache.kafka.raft.CandidateState$VoterState@560d62d8}, highWatermark=Optional[LogOffsetMetadata(offset=395338, metadata=Optional.empty)], electionTimeoutMs=1328) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5794, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@38e6fe9d, 2=org.apache.kafka.raft.CandidateState$VoterState@53359e01, 3=org.apache.kafka.raft.CandidateState$VoterState@42d49314}, highWatermark=Optional[LogOffsetMetadata(offset=395338, metadata=Optional.empty)], electionTimeoutMs=1594) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:56,618] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5795, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@26aa2437, 2=org.apache.kafka.raft.CandidateState$VoterState@29372469, 3=org.apache.kafka.raft.CandidateState$VoterState@560d62d8}, highWatermark=Optional[LogOffsetMetadata(offset=395338, metadata=Optional.empty)], electionTimeoutMs=1328) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5794, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@38e6fe9d, 2=org.apache.kafka.raft.CandidateState$VoterState@53359e01, 3=org.apache.kafka.raft.CandidateState$VoterState@42d49314}, highWatermark=Optional[LogOffsetMetadata(offset=395338, metadata=Optional.empty)], electionTimeoutMs=1594) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:56,620] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5795, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5793, lastOffset=395339)])]) with epoch 5795 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:56,668] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:56,669] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:14:56,669] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5796, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3027173e, 2=org.apache.kafka.raft.CandidateState$VoterState@47db0691, 3=org.apache.kafka.raft.CandidateState$VoterState@57df766f}, highWatermark=Optional[LogOffsetMetadata(offset=395338, metadata=Optional.empty)], electionTimeoutMs=1590) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5795, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@26aa2437, 2=org.apache.kafka.raft.CandidateState$VoterState@29372469, 3=org.apache.kafka.raft.CandidateState$VoterState@560d62d8}, highWatermark=Optional[LogOffsetMetadata(offset=395338, metadata=Optional.empty)], electionTimeoutMs=1328) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:56,705] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5796, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3027173e, 2=org.apache.kafka.raft.CandidateState$VoterState@47db0691, 3=org.apache.kafka.raft.CandidateState$VoterState@57df766f}, highWatermark=Optional[LogOffsetMetadata(offset=395338, metadata=Optional.empty)], electionTimeoutMs=1590) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5795, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@26aa2437, 2=org.apache.kafka.raft.CandidateState$VoterState@29372469, 3=org.apache.kafka.raft.CandidateState$VoterState@560d62d8}, highWatermark=Optional[LogOffsetMetadata(offset=395338, metadata=Optional.empty)], electionTimeoutMs=1328) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:56,778] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5796, epochStartOffset=395339, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5796, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3027173e, 2=org.apache.kafka.raft.CandidateState$VoterState@47db0691, 3=org.apache.kafka.raft.CandidateState$VoterState@57df766f}, highWatermark=Optional[LogOffsetMetadata(offset=395338, metadata=Optional.empty)], electionTimeoutMs=1590) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:56,803] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5796, epochStartOffset=395339, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5796, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3027173e, 2=org.apache.kafka.raft.CandidateState$VoterState@47db0691, 3=org.apache.kafka.raft.CandidateState$VoterState@57df766f}, highWatermark=Optional[LogOffsetMetadata(offset=395338, metadata=Optional.empty)], electionTimeoutMs=1590) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:14:56,898] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:14:56,913] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:14:56,915] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:14:56,966] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:14:56,970] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:14:56,971] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:14:57,010] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=395340, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7240510)]) for the first time for epoch 5796 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=395340, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7240510)])], lastFetchTimestamp=1740501897009, lastCaughtUpTimestamp=1740501897009, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=395340, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7240510)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-25 22:14:57,021] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:14:57,029] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:14:57,034] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:14:57,087] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:15:04,851] INFO [RaftManager id=2] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:15:04,852] INFO [RaftManager id=2] Cancelled in-flight BEGIN_QUORUM_EPOCH request with correlation id 3370 due to node 3 being disconnected (elapsed time since creation: 2007ms, elapsed time since send: 2004ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:15:07,026] INFO [RaftManager id=2] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are java.util.stream.ReferencePipeline$3@1693f4a5 (org.apache.kafka.raft.LeaderState)
[2025-02-25 22:15:07,076] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=5796, voters=[1, 2, 3], electionTimeoutMs=1967, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=3, directoryId=Optional.empty)]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5796, epochStartOffset=395339, highWatermark=Optional[LogOffsetMetadata(offset=395351, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7241302)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=395351, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7241302)])], lastFetchTimestamp=1740501903157, lastCaughtUpTimestamp=1740501902727, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=395352, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7241374)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=395351, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7241302)])], lastFetchTimestamp=1740501903157, lastCaughtUpTimestamp=1740501902727, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:15:07,123] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=5797, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1087, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=5796, voters=[1, 2, 3], electionTimeoutMs=1967, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=3, directoryId=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:15:07,177] INFO [RaftManager id=2] Completed transition to Unattached(epoch=5797, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1087, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=5796, voters=[1, 2, 3], electionTimeoutMs=1967, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=3, directoryId=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:15:07,177] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=5797, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1464, highWatermark=Optional.empty) from Unattached(epoch=5797, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1087, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:15:07,181] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1853804216). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:15:07,181] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(236262119). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:15:07,181] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(326241342). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:15:07,181] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1904920816). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:15:07,181] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(1771688823). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:15:07,181] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1337812617). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:15:07,181] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1278050492). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:15:07,181] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1799822465). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:15:07,182] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1281521909). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:15:07,182] INFO [QuorumController id=2] failAll(NotControllerException): failing maybeFenceReplicas(1750062814). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:15:07,182] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1221034763). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:15:07,182] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:15:07,204] INFO [RaftManager id=2] Completed transition to Unattached(epoch=5797, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1464, highWatermark=Optional.empty) from Unattached(epoch=5797, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1087, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:15:07,205] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5797, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5796, lastOffset=395352)])]) with epoch 5797 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:15:07,276] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5797, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5796, lastOffset=395352)])]) with epoch 5797 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:15:07,368] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=5797, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=5797, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1464, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:15:07,415] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=5797, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=5797, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1464, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:15:07,485] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:15:07,490] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:15:07,490] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:15:07,543] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:15:07,561] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:15:07,562] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:15:07,612] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:15:07,621] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:15:07,621] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:15:07,671] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:15:07,674] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:15:07,675] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:15:07,726] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:15:07,726] INFO [BrokerLifecycleManager id=2] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-02-25 22:15:09,432] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:15:09,852] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:15:09,613] INFO [RaftManager id=2] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:15:09,854] INFO [RaftManager id=2] Cancelled in-flight FETCH request with correlation id 3375 due to node 1 being disconnected (elapsed time since creation: 2003ms, elapsed time since send: 2003ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:15:09,535] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:15:09,854] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5798, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1f6e1ef3, 2=org.apache.kafka.raft.CandidateState$VoterState@1b7d433f, 3=org.apache.kafka.raft.CandidateState$VoterState@79a56ed}, highWatermark=Optional.empty, electionTimeoutMs=1559) from FollowerState(fetchTimeoutMs=2000, epoch=5797, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:15:09,904] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:15:10,541] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5798, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1f6e1ef3, 2=org.apache.kafka.raft.CandidateState$VoterState@1b7d433f, 3=org.apache.kafka.raft.CandidateState$VoterState@79a56ed}, highWatermark=Optional.empty, electionTimeoutMs=1559) from FollowerState(fetchTimeoutMs=2000, epoch=5797, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:15:10,541] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5798, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5797, lastOffset=395353)])]) with epoch 5798 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:15:11,022] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5798, epochStartOffset=395353, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5798, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1f6e1ef3, 2=org.apache.kafka.raft.CandidateState$VoterState@1b7d433f, 3=org.apache.kafka.raft.CandidateState$VoterState@79a56ed}, highWatermark=Optional.empty, electionTimeoutMs=1559) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:15:11,096] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5798, epochStartOffset=395353, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5798, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1f6e1ef3, 2=org.apache.kafka.raft.CandidateState$VoterState@1b7d433f, 3=org.apache.kafka.raft.CandidateState$VoterState@79a56ed}, highWatermark=Optional.empty, electionTimeoutMs=1559) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:15:11,287] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=5799, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1846, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5798, epochStartOffset=395353, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=395354, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7241586)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:15:11,344] WARN [BrokerLifecycleManager id=2] Broker 2 sent a heartbeat request but received error REQUEST_TIMED_OUT. (kafka.server.BrokerLifecycleManager)
[2025-02-25 22:15:11,359] INFO [RaftManager id=2] Completed transition to Unattached(epoch=5799, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1846, highWatermark=Optional.empty) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5798, epochStartOffset=395353, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=395354, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7241586)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:15:11,360] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5799, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5797, lastOffset=395353)])]) with epoch 5799 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:15:11,515] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=5799, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=5799, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1846, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:15:11,592] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=5799, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=5799, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1846, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:15:11,594] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Truncating to offset 395353 (kafka.log.UnifiedLog)
[2025-02-25 22:15:11,598] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Loading producer state till offset 395353 with message format version 2 (kafka.log.UnifiedLog$)
[2025-02-25 22:15:11,598] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Reloading from producer snapshot and rebuilding producer state from offset 395353 (kafka.log.UnifiedLog$)
[2025-02-25 22:15:11,599] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=395255, file=/tmp/kafka-logs-node2/__cluster_metadata-0/00000000000000395255.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-25 22:15:11,600] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:15:11,600] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:15:11,606] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:15:11,606] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:15:11,657] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:15:11,662] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:15:11,662] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:15:11,671] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 395353 with 0 producer ids in 68 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-25 22:15:11,671] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Producer state recovery took 4ms for snapshot load and 69ms for segment recovery from offset 395353 (kafka.log.UnifiedLog$)
[2025-02-25 22:15:11,671] INFO [RaftManager id=2] Truncated to offset 395353 from Fetch response from leader 3 (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:15:11,714] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:15:12,321] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=395354, metadata=Optional.empty)] for the first time for epoch 5799 (org.apache.kafka.raft.FollowerState)
[2025-02-25 22:16:55,398] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:16:55,408] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5800, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1aad0062, 2=org.apache.kafka.raft.CandidateState$VoterState@2f170a43, 3=org.apache.kafka.raft.CandidateState$VoterState@6cb303c5}, highWatermark=Optional[LogOffsetMetadata(offset=395554, metadata=Optional.empty)], electionTimeoutMs=1541) from FollowerState(fetchTimeoutMs=2000, epoch=5799, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=395554, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:16:56,254] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5800, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1aad0062, 2=org.apache.kafka.raft.CandidateState$VoterState@2f170a43, 3=org.apache.kafka.raft.CandidateState$VoterState@6cb303c5}, highWatermark=Optional[LogOffsetMetadata(offset=395554, metadata=Optional.empty)], electionTimeoutMs=1541) from FollowerState(fetchTimeoutMs=2000, epoch=5799, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=395554, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:16:56,254] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5800, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5799, lastOffset=395555)])]) with epoch 5800 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:16:56,949] INFO [RaftManager id=2] Election has timed out, backing off for 0ms before becoming a candidate again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:16:56,949] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:16:56,949] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5801, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@241f8890, 2=org.apache.kafka.raft.CandidateState$VoterState@56c33261, 3=org.apache.kafka.raft.CandidateState$VoterState@41916fe8}, highWatermark=Optional[LogOffsetMetadata(offset=395554, metadata=Optional.empty)], electionTimeoutMs=1418) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5800, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1aad0062, 2=org.apache.kafka.raft.CandidateState$VoterState@2f170a43, 3=org.apache.kafka.raft.CandidateState$VoterState@6cb303c5}, highWatermark=Optional[LogOffsetMetadata(offset=395554, metadata=Optional.empty)], electionTimeoutMs=1541) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:16:57,422] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:16:57,436] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5801, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@241f8890, 2=org.apache.kafka.raft.CandidateState$VoterState@56c33261, 3=org.apache.kafka.raft.CandidateState$VoterState@41916fe8}, highWatermark=Optional[LogOffsetMetadata(offset=395554, metadata=Optional.empty)], electionTimeoutMs=1418) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5800, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@1aad0062, 2=org.apache.kafka.raft.CandidateState$VoterState@2f170a43, 3=org.apache.kafka.raft.CandidateState$VoterState@6cb303c5}, highWatermark=Optional[LogOffsetMetadata(offset=395554, metadata=Optional.empty)], electionTimeoutMs=1541) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:16:57,457] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5801, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5799, lastOffset=395555)])]) with epoch 5801 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:16:57,524] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:16:57,525] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:16:57,525] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5802, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3548e134, 2=org.apache.kafka.raft.CandidateState$VoterState@6dcbb405, 3=org.apache.kafka.raft.CandidateState$VoterState@22d4c3e7}, highWatermark=Optional[LogOffsetMetadata(offset=395554, metadata=Optional.empty)], electionTimeoutMs=1865) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5801, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@241f8890, 2=org.apache.kafka.raft.CandidateState$VoterState@56c33261, 3=org.apache.kafka.raft.CandidateState$VoterState@41916fe8}, highWatermark=Optional[LogOffsetMetadata(offset=395554, metadata=Optional.empty)], electionTimeoutMs=1418) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:16:57,570] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5802, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3548e134, 2=org.apache.kafka.raft.CandidateState$VoterState@6dcbb405, 3=org.apache.kafka.raft.CandidateState$VoterState@22d4c3e7}, highWatermark=Optional[LogOffsetMetadata(offset=395554, metadata=Optional.empty)], electionTimeoutMs=1865) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5801, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@241f8890, 2=org.apache.kafka.raft.CandidateState$VoterState@56c33261, 3=org.apache.kafka.raft.CandidateState$VoterState@41916fe8}, highWatermark=Optional[LogOffsetMetadata(offset=395554, metadata=Optional.empty)], electionTimeoutMs=1418) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:16:57,731] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5802, epochStartOffset=395555, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5802, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3548e134, 2=org.apache.kafka.raft.CandidateState$VoterState@6dcbb405, 3=org.apache.kafka.raft.CandidateState$VoterState@22d4c3e7}, highWatermark=Optional[LogOffsetMetadata(offset=395554, metadata=Optional.empty)], electionTimeoutMs=1865) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:16:57,771] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5802, epochStartOffset=395555, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5802, retries=3, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@3548e134, 2=org.apache.kafka.raft.CandidateState$VoterState@6dcbb405, 3=org.apache.kafka.raft.CandidateState$VoterState@22d4c3e7}, highWatermark=Optional[LogOffsetMetadata(offset=395554, metadata=Optional.empty)], electionTimeoutMs=1865) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:16:57,823] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:16:57,835] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:16:57,837] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:16:57,902] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:16:57,906] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:16:57,907] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:16:57,956] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:16:57,958] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:16:57,958] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:16:57,985] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=395556, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7256103)]) for the first time for epoch 5802 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=395556, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7256103)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=395556, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7256103)])], lastFetchTimestamp=1740502017984, lastCaughtUpTimestamp=1740502017984, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=395555, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7255997)])], lastFetchTimestamp=1740502017953, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-25 22:16:58,012] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:41:25,038] INFO [NodeToControllerChannelManager id=2 name=forwarding] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:41:25,043] INFO [broker-2-to-controller-forwarding-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:41:35,516] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=5803, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1522, highWatermark=Optional[LogOffsetMetadata(offset=398491, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7467219)])]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5802, epochStartOffset=395555, highWatermark=Optional[LogOffsetMetadata(offset=398491, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7467219)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=398491, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7467219)])], lastFetchTimestamp=1740503492874, lastCaughtUpTimestamp=1740503492404, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=398496, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7467396)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=398491, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7467219)])], lastFetchTimestamp=1740503492874, lastCaughtUpTimestamp=1740503492413, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:41:35,626] INFO [RaftManager id=2] Completed transition to Unattached(epoch=5803, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1522, highWatermark=Optional[LogOffsetMetadata(offset=398491, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7467219)])]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5802, epochStartOffset=395555, highWatermark=Optional[LogOffsetMetadata(offset=398491, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7467219)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=398491, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7467219)])], lastFetchTimestamp=1740503492874, lastCaughtUpTimestamp=1740503492404, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=398496, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7467396)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=398491, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7467219)])], lastFetchTimestamp=1740503492874, lastCaughtUpTimestamp=1740503492413, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:41:35,629] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5803, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5802, lastOffset=398492)])]) with epoch 5803 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:41:35,629] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5803, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5802, lastOffset=398492)])]) with epoch 5803 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:41:35,637] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1425858089). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:41:35,641] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1029720793). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:41:35,641] INFO [QuorumController id=2] failAll(NotControllerException): failing maybeFenceReplicas(267552237). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:41:35,642] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(940825422). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:41:35,642] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(179066867). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:41:35,642] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(891675389). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:41:35,642] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(786678873). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:41:35,642] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(135050080). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:41:35,642] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(1618443869). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:41:35,646] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:41:35,791] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=5804, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1224, highWatermark=Optional[LogOffsetMetadata(offset=398491, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7467219)])]) from Unattached(epoch=5803, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1522, highWatermark=Optional[LogOffsetMetadata(offset=398491, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7467219)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:41:35,828] INFO [RaftManager id=2] Completed transition to Unattached(epoch=5804, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1224, highWatermark=Optional[LogOffsetMetadata(offset=398491, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7467219)])]) from Unattached(epoch=5803, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1522, highWatermark=Optional[LogOffsetMetadata(offset=398491, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7467219)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:41:35,829] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5804, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5802, lastOffset=398492)])]) with epoch 5804 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:41:35,829] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5804, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5802, lastOffset=398492)])]) with epoch 5804 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:41:35,859] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=5805, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1157, highWatermark=Optional[LogOffsetMetadata(offset=398491, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7467219)])]) from Unattached(epoch=5804, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1224, highWatermark=Optional[LogOffsetMetadata(offset=398491, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7467219)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:41:35,901] INFO [RaftManager id=2] Completed transition to Unattached(epoch=5805, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1157, highWatermark=Optional[LogOffsetMetadata(offset=398491, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7467219)])]) from Unattached(epoch=5804, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1224, highWatermark=Optional[LogOffsetMetadata(offset=398491, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7467219)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:41:35,901] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5805, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5802, lastOffset=398492)])]) with epoch 5805 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:41:36,058] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=5805, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=398491, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7467219)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=5805, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1157, highWatermark=Optional[LogOffsetMetadata(offset=398491, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7467219)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:41:36,089] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=5805, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=398491, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7467219)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=5805, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1157, highWatermark=Optional[LogOffsetMetadata(offset=398491, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7467219)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:41:36,092] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:41:36,113] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:41:36,113] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:41:36,129] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Truncating to offset 398492 (kafka.log.UnifiedLog)
[2025-02-25 22:41:36,163] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Loading producer state till offset 398492 with message format version 2 (kafka.log.UnifiedLog$)
[2025-02-25 22:41:36,164] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Reloading from producer snapshot and rebuilding producer state from offset 398492 (kafka.log.UnifiedLog$)
[2025-02-25 22:41:36,164] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=395353, file=/tmp/kafka-logs-node2/__cluster_metadata-0/00000000000000395353.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-25 22:41:36,168] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:41:36,178] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:41:36,180] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:41:36,230] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:41:36,271] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 398492 with 0 producer ids in 15 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-25 22:41:36,272] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Producer state recovery took 44ms for snapshot load and 64ms for segment recovery from offset 398492 (kafka.log.UnifiedLog$)
[2025-02-25 22:41:36,273] INFO [RaftManager id=2] Truncated to offset 398492 from Fetch response from leader 3 (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:42:06,343] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:42:06,406] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5806, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@42e7c8d1, 2=org.apache.kafka.raft.CandidateState$VoterState@2037dc04, 3=org.apache.kafka.raft.CandidateState$VoterState@a884d4}, highWatermark=Optional[LogOffsetMetadata(offset=398545, metadata=Optional.empty)], electionTimeoutMs=1590) from FollowerState(fetchTimeoutMs=2000, epoch=5805, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=398545, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:42:06,490] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:42:06,490] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:42:06,518] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5806, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@42e7c8d1, 2=org.apache.kafka.raft.CandidateState$VoterState@2037dc04, 3=org.apache.kafka.raft.CandidateState$VoterState@a884d4}, highWatermark=Optional[LogOffsetMetadata(offset=398545, metadata=Optional.empty)], electionTimeoutMs=1590) from FollowerState(fetchTimeoutMs=2000, epoch=5805, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=398545, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:42:06,528] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5806, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5805, lastOffset=398546)])]) with epoch 5806 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:42:06,627] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:42:06,726] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:42:06,726] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5807, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5f71d5fb, 2=org.apache.kafka.raft.CandidateState$VoterState@23ac3f84, 3=org.apache.kafka.raft.CandidateState$VoterState@3d651009}, highWatermark=Optional[LogOffsetMetadata(offset=398545, metadata=Optional.empty)], electionTimeoutMs=1766) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5806, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@42e7c8d1, 2=org.apache.kafka.raft.CandidateState$VoterState@2037dc04, 3=org.apache.kafka.raft.CandidateState$VoterState@a884d4}, highWatermark=Optional[LogOffsetMetadata(offset=398545, metadata=Optional.empty)], electionTimeoutMs=1590) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:42:06,795] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5807, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5f71d5fb, 2=org.apache.kafka.raft.CandidateState$VoterState@23ac3f84, 3=org.apache.kafka.raft.CandidateState$VoterState@3d651009}, highWatermark=Optional[LogOffsetMetadata(offset=398545, metadata=Optional.empty)], electionTimeoutMs=1766) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5806, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@42e7c8d1, 2=org.apache.kafka.raft.CandidateState$VoterState@2037dc04, 3=org.apache.kafka.raft.CandidateState$VoterState@a884d4}, highWatermark=Optional[LogOffsetMetadata(offset=398545, metadata=Optional.empty)], electionTimeoutMs=1590) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:42:06,815] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5807, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5805, lastOffset=398546)])]) with epoch 5807 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:42:06,915] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:42:06,972] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=5808, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1520, highWatermark=Optional[LogOffsetMetadata(offset=398545, metadata=Optional.empty)]) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5807, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5f71d5fb, 2=org.apache.kafka.raft.CandidateState$VoterState@23ac3f84, 3=org.apache.kafka.raft.CandidateState$VoterState@3d651009}, highWatermark=Optional[LogOffsetMetadata(offset=398545, metadata=Optional.empty)], electionTimeoutMs=1766) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:42:07,028] INFO [RaftManager id=2] Completed transition to Unattached(epoch=5808, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1520, highWatermark=Optional[LogOffsetMetadata(offset=398545, metadata=Optional.empty)]) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5807, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@5f71d5fb, 2=org.apache.kafka.raft.CandidateState$VoterState@23ac3f84, 3=org.apache.kafka.raft.CandidateState$VoterState@3d651009}, highWatermark=Optional[LogOffsetMetadata(offset=398545, metadata=Optional.empty)], electionTimeoutMs=1766) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:42:07,029] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=5808, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1918, highWatermark=Optional[LogOffsetMetadata(offset=398545, metadata=Optional.empty)]) from Unattached(epoch=5808, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1520, highWatermark=Optional[LogOffsetMetadata(offset=398545, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:42:07,066] INFO [RaftManager id=2] Completed transition to Unattached(epoch=5808, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1918, highWatermark=Optional[LogOffsetMetadata(offset=398545, metadata=Optional.empty)]) from Unattached(epoch=5808, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1520, highWatermark=Optional[LogOffsetMetadata(offset=398545, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:42:07,066] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5808, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5805, lastOffset=398546)])]) with epoch 5808 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:42:07,259] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=5808, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=398545, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=5808, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1918, highWatermark=Optional[LogOffsetMetadata(offset=398545, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:42:07,343] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=5808, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=398545, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=5808, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1918, highWatermark=Optional[LogOffsetMetadata(offset=398545, metadata=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:42:07,358] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:42:07,365] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:42:07,365] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:42:07,416] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:42:07,423] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:42:07,424] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:42:07,477] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:47:03,760] INFO [SnapshotGenerator id=2] Creating new KRaft snapshot file snapshot 00000000000000399136-0000005808 because we have waited at least 60 minute(s). (org.apache.kafka.image.publisher.SnapshotGenerator)
[2025-02-25 22:47:04,104] INFO [SnapshotEmitter id=2] Successfully wrote snapshot 00000000000000399136-0000005808 (org.apache.kafka.image.publisher.SnapshotEmitter)
[2025-02-25 22:51:08,681] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:51:08,838] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5809, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@533fce7d, 2=org.apache.kafka.raft.CandidateState$VoterState@37bef80e, 3=org.apache.kafka.raft.CandidateState$VoterState@7c10bb20}, highWatermark=Optional[LogOffsetMetadata(offset=399619, metadata=Optional.empty)], electionTimeoutMs=1336) from FollowerState(fetchTimeoutMs=2000, epoch=5808, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=399619, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:51:08,949] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5809, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@533fce7d, 2=org.apache.kafka.raft.CandidateState$VoterState@37bef80e, 3=org.apache.kafka.raft.CandidateState$VoterState@7c10bb20}, highWatermark=Optional[LogOffsetMetadata(offset=399619, metadata=Optional.empty)], electionTimeoutMs=1336) from FollowerState(fetchTimeoutMs=2000, epoch=5808, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=399619, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:51:09,067] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5809, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5808, lastOffset=399620)])]) with epoch 5809 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:51:09,232] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:51:09,255] INFO [RaftManager id=2] Insufficient remaining votes to become leader (rejected by [1, 3]). We will backoff before retrying election again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:51:09,255] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:51:09,255] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5810, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@79000158, 2=org.apache.kafka.raft.CandidateState$VoterState@54616423, 3=org.apache.kafka.raft.CandidateState$VoterState@145f9829}, highWatermark=Optional[LogOffsetMetadata(offset=399619, metadata=Optional.empty)], electionTimeoutMs=1167) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5809, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@533fce7d, 2=org.apache.kafka.raft.CandidateState$VoterState@37bef80e, 3=org.apache.kafka.raft.CandidateState$VoterState@7c10bb20}, highWatermark=Optional[LogOffsetMetadata(offset=399619, metadata=Optional.empty)], electionTimeoutMs=1336) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:51:09,281] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5810, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@79000158, 2=org.apache.kafka.raft.CandidateState$VoterState@54616423, 3=org.apache.kafka.raft.CandidateState$VoterState@145f9829}, highWatermark=Optional[LogOffsetMetadata(offset=399619, metadata=Optional.empty)], electionTimeoutMs=1167) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5809, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@533fce7d, 2=org.apache.kafka.raft.CandidateState$VoterState@37bef80e, 3=org.apache.kafka.raft.CandidateState$VoterState@7c10bb20}, highWatermark=Optional[LogOffsetMetadata(offset=399619, metadata=Optional.empty)], electionTimeoutMs=1336) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:51:09,383] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5810, epochStartOffset=399620, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5810, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@79000158, 2=org.apache.kafka.raft.CandidateState$VoterState@54616423, 3=org.apache.kafka.raft.CandidateState$VoterState@145f9829}, highWatermark=Optional[LogOffsetMetadata(offset=399619, metadata=Optional.empty)], electionTimeoutMs=1167) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:51:09,428] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5810, epochStartOffset=399620, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5810, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@79000158, 2=org.apache.kafka.raft.CandidateState$VoterState@54616423, 3=org.apache.kafka.raft.CandidateState$VoterState@145f9829}, highWatermark=Optional[LogOffsetMetadata(offset=399619, metadata=Optional.empty)], electionTimeoutMs=1167) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:51:09,450] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:51:09,564] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:51:09,564] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:51:09,616] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:51:09,682] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=399621, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7548640)]) for the first time for epoch 5810 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=399621, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7548640)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=399621, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7548640)])], lastFetchTimestamp=1740504069682, lastCaughtUpTimestamp=1740504069682, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-25 22:51:25,337] INFO [NodeToControllerChannelManager id=2 name=forwarding] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:53:31,610] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=5811, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1401, highWatermark=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5810, epochStartOffset=399620, highWatermark=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])], lastFetchTimestamp=1740504211605, lastCaughtUpTimestamp=1740504209247, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=399903, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568822)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])], lastFetchTimestamp=1740504211574, lastCaughtUpTimestamp=1740504209246, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:53:31,747] INFO [RaftManager id=2] Completed transition to Unattached(epoch=5811, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1401, highWatermark=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5810, epochStartOffset=399620, highWatermark=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])], lastFetchTimestamp=1740504211605, lastCaughtUpTimestamp=1740504209247, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=399903, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568822)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])], lastFetchTimestamp=1740504211574, lastCaughtUpTimestamp=1740504209246, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:53:31,748] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5811, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5810, lastOffset=399898)])]) with epoch 5811 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:53:31,749] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5811, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5810, lastOffset=399898)])]) with epoch 5811 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:53:31,764] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1871106950). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:53:31,765] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1193559548). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:53:31,765] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(895261149). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:53:31,774] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(452193679). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:53:31,775] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1135613876). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:53:31,775] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:53:31,779] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(652128667). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:53:31,780] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(2006800108). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:53:31,907] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=5812, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1102, highWatermark=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])]) from Unattached(epoch=5811, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1401, highWatermark=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:53:32,024] INFO [RaftManager id=2] Completed transition to Unattached(epoch=5812, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1102, highWatermark=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])]) from Unattached(epoch=5811, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1401, highWatermark=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:53:32,028] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5812, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5810, lastOffset=399898)])]) with epoch 5812 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:53:32,031] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5812, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5810, lastOffset=399898)])]) with epoch 5812 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:53:32,306] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=5813, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=704, highWatermark=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])]) from Unattached(epoch=5812, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1102, highWatermark=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:53:32,343] INFO [RaftManager id=2] Completed transition to Unattached(epoch=5813, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=704, highWatermark=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])]) from Unattached(epoch=5812, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1102, highWatermark=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:53:32,344] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5813, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5810, lastOffset=399898)])]) with epoch 5813 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:53:32,422] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5813, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5810, lastOffset=399898)])]) with epoch 5813 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:53:32,635] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=5814, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=374, highWatermark=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])]) from Unattached(epoch=5813, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=704, highWatermark=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:53:32,693] INFO [RaftManager id=2] Completed transition to Unattached(epoch=5814, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=374, highWatermark=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])]) from Unattached(epoch=5813, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=704, highWatermark=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:53:32,695] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5814, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5810, lastOffset=399898)])]) with epoch 5814 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:53:32,697] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5814, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5810, lastOffset=399898)])]) with epoch 5814 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:53:33,009] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5815, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@ea76cf2, 2=org.apache.kafka.raft.CandidateState$VoterState@13bcf7bd, 3=org.apache.kafka.raft.CandidateState$VoterState@62f0f039}, highWatermark=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])], electionTimeoutMs=1834) from Unattached(epoch=5814, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=374, highWatermark=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:53:33,041] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5815, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@ea76cf2, 2=org.apache.kafka.raft.CandidateState$VoterState@13bcf7bd, 3=org.apache.kafka.raft.CandidateState$VoterState@62f0f039}, highWatermark=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])], electionTimeoutMs=1834) from Unattached(epoch=5814, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=374, highWatermark=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:53:33,158] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5815, epochStartOffset=399903, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5815, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@ea76cf2, 2=org.apache.kafka.raft.CandidateState$VoterState@13bcf7bd, 3=org.apache.kafka.raft.CandidateState$VoterState@62f0f039}, highWatermark=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])], electionTimeoutMs=1834) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:53:33,271] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5815, epochStartOffset=399903, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5815, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@ea76cf2, 2=org.apache.kafka.raft.CandidateState$VoterState@13bcf7bd, 3=org.apache.kafka.raft.CandidateState$VoterState@62f0f039}, highWatermark=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])], electionTimeoutMs=1834) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:53:33,290] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:53:33,318] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:53:33,322] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:53:33,372] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:53:33,378] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:53:33,379] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:53:33,430] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:53:33,433] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:53:33,434] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:53:33,484] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:53:33,488] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:53:33,489] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:53:33,515] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=399904, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568928)]) for the first time for epoch 5815 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=399904, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568928)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=399904, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568928)])], lastFetchTimestamp=1740504213514, lastCaughtUpTimestamp=1740504213514, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=399898, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7568584)])], lastFetchTimestamp=1740504213471, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-25 22:53:33,540] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:54:03,659] INFO [RaftManager id=2] Did not receive fetch request from the majority of the voters within 3000ms. Current fetched voters are [], and voters are java.util.stream.ReferencePipeline$3@16f96f93 (org.apache.kafka.raft.LeaderState)
[2025-02-25 22:54:04,378] INFO [RaftManager id=2] Completed transition to ResignedState(localId=2, epoch=5815, voters=[1, 2, 3], electionTimeoutMs=1614, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=3, directoryId=Optional.empty)]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5815, epochStartOffset=399903, highWatermark=Optional[LogOffsetMetadata(offset=399957, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7572744)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=399957, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7572744)])], lastFetchTimestamp=1740504240636, lastCaughtUpTimestamp=1740504240237, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=399958, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7572816)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=399957, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7572744)])], lastFetchTimestamp=1740504240636, lastCaughtUpTimestamp=1740504240186, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:54:04,383] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=5816, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1023, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=5815, voters=[1, 2, 3], electionTimeoutMs=1614, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=3, directoryId=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:54:04,412] INFO [RaftManager id=2] Completed transition to Unattached(epoch=5816, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1023, highWatermark=Optional.empty) from ResignedState(localId=2, epoch=5815, voters=[1, 2, 3], electionTimeoutMs=1614, unackedVoters=[1, 3], preferredSuccessors=[ReplicaKey(id=1, directoryId=Optional.empty), ReplicaKey(id=3, directoryId=Optional.empty)]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:54:04,412] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=5816, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1816, highWatermark=Optional.empty) from Unattached(epoch=5816, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1023, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:54:04,417] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1005624864). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:54:04,418] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(1576300796). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:54:04,418] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(601149026). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:54:04,420] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(286949325). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:54:04,420] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(774173264). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:54:04,420] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(1353254136). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:54:04,420] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1426814801). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:54:04,420] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(397250090). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:54:04,420] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:54:04,420] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(512903421). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:54:04,421] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(100929811). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:54:04,421] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(146493309). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:54:04,458] INFO [RaftManager id=2] Completed transition to Unattached(epoch=5816, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1816, highWatermark=Optional.empty) from Unattached(epoch=5816, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1023, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:54:04,458] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5816, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5815, lastOffset=399958)])]) with epoch 5816 is granted (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:54:04,600] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=5816, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=5816, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1816, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:54:04,636] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=5816, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional.empty, fetchingSnapshot=Optional.empty) from Unattached(epoch=5816, votedKey=ReplicaKey(id=1, directoryId=Optional[mQes9A54bQCw7Vbw6Ptauw]), voters=[1, 2, 3], electionTimeoutMs=1816, highWatermark=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:54:04,735] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:54:04,742] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:54:04,743] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:54:04,768] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5816, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5815, lastOffset=399958)])]) with epoch 5816 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:54:04,794] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:54:05,296] INFO [RaftManager id=2] High watermark set to Optional[LogOffsetMetadata(offset=399959, metadata=Optional.empty)] for the first time for epoch 5816 (org.apache.kafka.raft.FollowerState)
[2025-02-25 22:55:03,195] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:55:03,196] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5817, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@60ecc4ce, 2=org.apache.kafka.raft.CandidateState$VoterState@45447d8f, 3=org.apache.kafka.raft.CandidateState$VoterState@2a3d1c3c}, highWatermark=Optional[LogOffsetMetadata(offset=400066, metadata=Optional.empty)], electionTimeoutMs=1014) from FollowerState(fetchTimeoutMs=2000, epoch=5816, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=400066, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:55:04,882] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:55:05,296] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 2141 due to node 1 being disconnected (elapsed time since creation: 4512ms, elapsed time since send: 4512ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:55:05,297] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:55:05,449] INFO [BrokerLifecycleManager id=2] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-02-25 22:55:05,477] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5817, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@60ecc4ce, 2=org.apache.kafka.raft.CandidateState$VoterState@45447d8f, 3=org.apache.kafka.raft.CandidateState$VoterState@2a3d1c3c}, highWatermark=Optional[LogOffsetMetadata(offset=400066, metadata=Optional.empty)], electionTimeoutMs=1014) from FollowerState(fetchTimeoutMs=2000, epoch=5816, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=400066, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:55:05,477] INFO [RaftManager id=2] Election has timed out, backing off for 100ms before becoming a candidate again (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:55:05,675] INFO [RaftManager id=2] Re-elect as candidate after election backoff has completed (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:55:05,676] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5818, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7acfb2d9, 2=org.apache.kafka.raft.CandidateState$VoterState@7c83d3fa, 3=org.apache.kafka.raft.CandidateState$VoterState@1a4d71e0}, highWatermark=Optional[LogOffsetMetadata(offset=400066, metadata=Optional.empty)], electionTimeoutMs=1276) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5817, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@60ecc4ce, 2=org.apache.kafka.raft.CandidateState$VoterState@45447d8f, 3=org.apache.kafka.raft.CandidateState$VoterState@2a3d1c3c}, highWatermark=Optional[LogOffsetMetadata(offset=400066, metadata=Optional.empty)], electionTimeoutMs=1014) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:55:05,680] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:55:05,723] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5818, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7acfb2d9, 2=org.apache.kafka.raft.CandidateState$VoterState@7c83d3fa, 3=org.apache.kafka.raft.CandidateState$VoterState@1a4d71e0}, highWatermark=Optional[LogOffsetMetadata(offset=400066, metadata=Optional.empty)], electionTimeoutMs=1276) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5817, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@60ecc4ce, 2=org.apache.kafka.raft.CandidateState$VoterState@45447d8f, 3=org.apache.kafka.raft.CandidateState$VoterState@2a3d1c3c}, highWatermark=Optional[LogOffsetMetadata(offset=400066, metadata=Optional.empty)], electionTimeoutMs=1014) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:55:05,897] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5818, epochStartOffset=400067, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5818, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7acfb2d9, 2=org.apache.kafka.raft.CandidateState$VoterState@7c83d3fa, 3=org.apache.kafka.raft.CandidateState$VoterState@1a4d71e0}, highWatermark=Optional[LogOffsetMetadata(offset=400066, metadata=Optional.empty)], electionTimeoutMs=1276) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:55:05,928] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5818, epochStartOffset=400067, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=5818, retries=2, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@7acfb2d9, 2=org.apache.kafka.raft.CandidateState$VoterState@7c83d3fa, 3=org.apache.kafka.raft.CandidateState$VoterState@1a4d71e0}, highWatermark=Optional[LogOffsetMetadata(offset=400066, metadata=Optional.empty)], electionTimeoutMs=1276) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:55:05,984] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:55:05,988] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:55:05,989] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:55:06,039] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:55:06,042] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:55:06,043] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:55:06,092] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:55:06,094] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:55:06,094] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:55:06,144] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:55:06,147] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:55:06,147] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:55:06,154] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=400068, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7580743)]) for the first time for epoch 5818 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=400068, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7580743)])], lastFetchTimestamp=1740504306154, lastCaughtUpTimestamp=1740504306154, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=400068, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7580743)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true)] (org.apache.kafka.raft.LeaderState)
[2025-02-25 22:55:06,197] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:56:30,846] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=5819, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1171, highWatermark=Optional[LogOffsetMetadata(offset=400230, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7592407)])]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5818, epochStartOffset=400067, highWatermark=Optional[LogOffsetMetadata(offset=400230, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7592407)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=400230, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7592407)])], lastFetchTimestamp=1740504388175, lastCaughtUpTimestamp=1740504387740, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=400236, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7592656)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=400230, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7592407)])], lastFetchTimestamp=1740504388175, lastCaughtUpTimestamp=1740504387725, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:56:30,906] INFO [RaftManager id=2] Completed transition to Unattached(epoch=5819, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1171, highWatermark=Optional[LogOffsetMetadata(offset=400230, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7592407)])]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=5818, epochStartOffset=400067, highWatermark=Optional[LogOffsetMetadata(offset=400230, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7592407)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=400230, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7592407)])], lastFetchTimestamp=1740504388175, lastCaughtUpTimestamp=1740504387740, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=400236, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7592656)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=400230, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7592407)])], lastFetchTimestamp=1740504388175, lastCaughtUpTimestamp=1740504387725, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:56:30,910] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5819, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5818, lastOffset=400231)])]) with epoch 5819 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:56:30,912] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5819, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5818, lastOffset=400231)])]) with epoch 5819 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:56:30,917] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1790791802). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:56:30,918] INFO [QuorumController id=2] failAll(NotControllerException): failing maybeFenceReplicas(573349942). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:56:30,919] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1789622461). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:56:30,919] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(2127229025). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:56:30,919] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(2121552194). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:56:30,919] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(958292906). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:56:30,919] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(138517156). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:56:30,920] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(564210229). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:56:30,920] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(2105770242). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:56:30,920] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(927645227). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-25 22:56:30,921] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:56:30,987] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=5820, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1030, highWatermark=Optional[LogOffsetMetadata(offset=400230, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7592407)])]) from Unattached(epoch=5819, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1171, highWatermark=Optional[LogOffsetMetadata(offset=400230, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7592407)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:56:31,094] INFO [RaftManager id=2] Completed transition to Unattached(epoch=5820, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1030, highWatermark=Optional[LogOffsetMetadata(offset=400230, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7592407)])]) from Unattached(epoch=5819, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1171, highWatermark=Optional[LogOffsetMetadata(offset=400230, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7592407)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:56:31,095] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=5820, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=5818, lastOffset=400231)])]) with epoch 5820 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-25 22:56:31,334] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=5820, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=400230, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7592407)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=5820, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1030, highWatermark=Optional[LogOffsetMetadata(offset=400230, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7592407)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:56:31,417] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=5820, leader=3, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19094}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=400230, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7592407)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=5820, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1030, highWatermark=Optional[LogOffsetMetadata(offset=400230, metadata=Optional[(segmentBaseOffset=294441,relativePositionInSegment=7592407)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-25 22:56:31,425] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:56:31,512] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:56:31,513] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:56:31,519] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Truncating to offset 400231 (kafka.log.UnifiedLog)
[2025-02-25 22:56:31,564] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:56:31,587] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-02-25 22:56:31,588] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:56:31,633] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Loading producer state till offset 400231 with message format version 2 (kafka.log.UnifiedLog$)
[2025-02-25 22:56:31,634] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Reloading from producer snapshot and rebuilding producer state from offset 400231 (kafka.log.UnifiedLog$)
[2025-02-25 22:56:31,635] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=398492, file=/tmp/kafka-logs-node2/__cluster_metadata-0/00000000000000398492.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-25 22:56:31,638] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 192.168.1.5:19094 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-25 22:56:31,675] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 400231 with 0 producer ids in 20 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-25 22:56:31,675] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Producer state recovery took 5ms for snapshot load and 36ms for segment recovery from offset 400231 (kafka.log.UnifiedLog$)
[2025-02-25 22:56:31,675] INFO [RaftManager id=2] Truncated to offset 400231 from Fetch response from leader 3 (org.apache.kafka.raft.KafkaRaftClient)
