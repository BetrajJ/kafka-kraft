[2025-02-12 12:36:13,656] INFO [RaftManager id=2] Become candidate due to fetch timeout (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-12 12:36:13,664] INFO [RaftManager id=2] Attempting durable transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3219, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@2d6d9966, 2=org.apache.kafka.raft.CandidateState$VoterState@6449a93c, 3=org.apache.kafka.raft.CandidateState$VoterState@12e17f54}, highWatermark=Optional[LogOffsetMetadata(offset=125877, metadata=Optional.empty)], electionTimeoutMs=1384) from FollowerState(fetchTimeoutMs=2000, epoch=3218, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=125877, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-12 12:36:13,684] INFO [RaftManager id=2] Completed transition to CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3219, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@2d6d9966, 2=org.apache.kafka.raft.CandidateState$VoterState@6449a93c, 3=org.apache.kafka.raft.CandidateState$VoterState@12e17f54}, highWatermark=Optional[LogOffsetMetadata(offset=125877, metadata=Optional.empty)], electionTimeoutMs=1384) from FollowerState(fetchTimeoutMs=2000, epoch=3218, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=125877, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-02-12 12:36:13,754] INFO [RaftManager id=2] Attempting durable transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=3219, epochStartOffset=125878, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3219, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@2d6d9966, 2=org.apache.kafka.raft.CandidateState$VoterState@6449a93c, 3=org.apache.kafka.raft.CandidateState$VoterState@12e17f54}, highWatermark=Optional[LogOffsetMetadata(offset=125877, metadata=Optional.empty)], electionTimeoutMs=1384) (org.apache.kafka.raft.QuorumState)
[2025-02-12 12:36:13,795] INFO [RaftManager id=2] Completed transition to Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=3219, epochStartOffset=125878, highWatermark=Optional.empty, voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)}) from CandidateState(localId=2, localDirectoryId=4SvYonARtmIsmjtA1FOevg,epoch=3219, retries=1, voteStates={1=org.apache.kafka.raft.CandidateState$VoterState@2d6d9966, 2=org.apache.kafka.raft.CandidateState$VoterState@6449a93c, 3=org.apache.kafka.raft.CandidateState$VoterState@12e17f54}, highWatermark=Optional[LogOffsetMetadata(offset=125877, metadata=Optional.empty)], electionTimeoutMs=1384) (org.apache.kafka.raft.QuorumState)
[2025-02-12 12:36:14,046] INFO [RaftManager id=2] High watermark set to LogOffsetMetadata(offset=125879, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=8956403)]) for the first time for epoch 3219 based on indexOfHw 1 and voters [ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=125879, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=8956403)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=125879, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=8956403)])], lastFetchTimestamp=1739343974045, lastCaughtUpTimestamp=1739343974045, hasAcknowledgedLeader=true), ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional.empty, lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=false)] (org.apache.kafka.raft.LeaderState)
[2025-02-12 12:36:14,849] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-12 12:36:14,850] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-12 12:51:23,768] INFO [SnapshotGenerator id=2] Creating new KRaft snapshot file snapshot 00000000000000127690-0000003219 because we have waited at least 60 minute(s). (org.apache.kafka.image.publisher.SnapshotGenerator)
[2025-02-12 12:51:23,922] INFO [SnapshotEmitter id=2] Successfully wrote snapshot 00000000000000127690-0000003219 (org.apache.kafka.image.publisher.SnapshotEmitter)
[2025-02-12 12:54:46,787] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=3220, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1370, highWatermark=Optional[LogOffsetMetadata(offset=128090, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9115290)])]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=3219, epochStartOffset=125878, highWatermark=Optional[LogOffsetMetadata(offset=128090, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9115290)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=128090, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9115290)])], lastFetchTimestamp=1739345086635, lastCaughtUpTimestamp=1739345084496, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=128094, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9115456)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=128090, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9115290)])], lastFetchTimestamp=1739345086716, lastCaughtUpTimestamp=1739345084495, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-12 12:54:46,878] INFO [RaftManager id=2] Completed transition to Unattached(epoch=3220, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1370, highWatermark=Optional[LogOffsetMetadata(offset=128090, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9115290)])]) from Leader(localReplicaKey=ReplicaKey(id=2, directoryId=Optional[4SvYonARtmIsmjtA1FOevg]), epoch=3219, epochStartOffset=125878, highWatermark=Optional[LogOffsetMetadata(offset=128090, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9115290)])], voterStates={1=ReplicaState(replicaKey=ReplicaKey(id=1, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=128090, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9115290)])], lastFetchTimestamp=1739345086635, lastCaughtUpTimestamp=1739345084496, hasAcknowledgedLeader=true), 2=ReplicaState(replicaKey=ReplicaKey(id=2, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=128094, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9115456)])], lastFetchTimestamp=-1, lastCaughtUpTimestamp=-1, hasAcknowledgedLeader=true), 3=ReplicaState(replicaKey=ReplicaKey(id=3, directoryId=Optional.empty), endOffset=Optional[LogOffsetMetadata(offset=128090, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9115290)])], lastFetchTimestamp=1739345086716, lastCaughtUpTimestamp=1739345084495, hasAcknowledgedLeader=true)}) (org.apache.kafka.raft.QuorumState)
[2025-02-12 12:54:46,889] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3220, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3219, lastOffset=128090)])]) with epoch 3220 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-12 12:54:46,890] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1041073834). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-12 12:54:46,890] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1784109544). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-12 12:54:46,890] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(640843823). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-12 12:54:46,890] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(1400289870). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-12 12:54:46,890] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(18636380). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-12 12:54:46,890] INFO [QuorumController id=2] failAll(NotControllerException): failing processBrokerHeartbeat(1372905358). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-12 12:54:46,890] INFO [QuorumController id=2] failAll(NotControllerException): failing writeNoOpRecord(1674911331). (org.apache.kafka.deferred.DeferredEventQueue)
[2025-02-12 12:54:46,891] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-02-12 12:54:46,926] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3220, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3219, lastOffset=128090)])]) with epoch 3220 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-12 12:54:47,045] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=3221, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1111, highWatermark=Optional[LogOffsetMetadata(offset=128090, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9115290)])]) from Unattached(epoch=3220, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1370, highWatermark=Optional[LogOffsetMetadata(offset=128090, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9115290)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-12 12:54:47,069] INFO [RaftManager id=2] Completed transition to Unattached(epoch=3221, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1111, highWatermark=Optional[LogOffsetMetadata(offset=128090, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9115290)])]) from Unattached(epoch=3220, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1370, highWatermark=Optional[LogOffsetMetadata(offset=128090, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9115290)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-12 12:54:47,069] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3221, candidateId=3, candidateDirectoryId=B_s3M5qvrILHbTrqu_tnLg, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3219, lastOffset=128090)])]) with epoch 3221 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-12 12:54:47,076] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3221, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3219, lastOffset=128090)])]) with epoch 3221 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-12 12:54:47,098] INFO [RaftManager id=2] Attempting durable transition to Unattached(epoch=3222, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1058, highWatermark=Optional[LogOffsetMetadata(offset=128090, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9115290)])]) from Unattached(epoch=3221, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1111, highWatermark=Optional[LogOffsetMetadata(offset=128090, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9115290)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-12 12:54:47,140] INFO [RaftManager id=2] Completed transition to Unattached(epoch=3222, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1058, highWatermark=Optional[LogOffsetMetadata(offset=128090, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9115290)])]) from Unattached(epoch=3221, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1111, highWatermark=Optional[LogOffsetMetadata(offset=128090, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9115290)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-12 12:54:47,141] INFO [RaftManager id=2] Vote request VoteRequestData(clusterId='IAwvuCRtQFikmbSEMsgQFw', voterId=2, topics=[TopicData(topicName='__cluster_metadata', partitions=[PartitionData(partitionIndex=0, candidateEpoch=3222, candidateId=1, candidateDirectoryId=mQes9A54bQCw7Vbw6Ptauw, voterDirectoryId=AAAAAAAAAAAAAAAAAAAAAA, lastOffsetEpoch=3219, lastOffset=128090)])]) with epoch 3222 is rejected (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-12 12:54:47,317] INFO [RaftManager id=2] Attempting durable transition to FollowerState(fetchTimeoutMs=2000, epoch=3222, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=128090, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9115290)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=3222, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1058, highWatermark=Optional[LogOffsetMetadata(offset=128090, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9115290)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-12 12:54:47,350] INFO [RaftManager id=2] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=3222, leader=1, leaderEndpoints=Endpoints(endpoints={ListenerName(CONTROLLER)=vbox/<unresolved>:19092}), voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=128090, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9115290)])], fetchingSnapshot=Optional.empty) from Unattached(epoch=3222, votedKey=null, voters=[1, 2, 3], electionTimeoutMs=1058, highWatermark=Optional[LogOffsetMetadata(offset=128090, metadata=Optional[(segmentBaseOffset=0,relativePositionInSegment=9115290)])]) (org.apache.kafka.raft.QuorumState)
[2025-02-12 12:54:47,382] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Truncating to offset 128090 (kafka.log.UnifiedLog)
[2025-02-12 12:54:47,396] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-12 12:54:47,408] INFO [NodeToControllerChannelManager id=2 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-02-12 12:54:47,408] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-02-12 12:54:47,416] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Loading producer state till offset 128090 with message format version 2 (kafka.log.UnifiedLog$)
[2025-02-12 12:54:47,416] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Reloading from producer snapshot and rebuilding producer state from offset 128090 (kafka.log.UnifiedLog$)
[2025-02-12 12:54:47,416] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=123988, file=/tmp/kafka-logs-node2/__cluster_metadata-0/00000000000000123988.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-12 12:54:47,441] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 128090 with 0 producer ids in 8 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-02-12 12:54:47,441] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs-node2] Producer state recovery took 8ms for snapshot load and 17ms for segment recovery from offset 128090 (kafka.log.UnifiedLog$)
[2025-02-12 12:54:47,441] INFO [RaftManager id=2] Truncated to offset 128090 from Fetch response from leader 1 (org.apache.kafka.raft.KafkaRaftClient)
[2025-02-12 12:54:47,459] INFO [broker-2-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node 172.25.10.83:19092 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
